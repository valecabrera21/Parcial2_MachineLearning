
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Default Probability Prediction &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'edabanco';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to your Jupyter Book" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Default Probability Prediction</a></li>




</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fedabanco.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/edabanco.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Default Probability Prediction</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Default Probability Prediction</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias">Librerías</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sobre-los-datos">Sobre los datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sobre-las-variables">Sobre las variables</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#presencia-de-datos-faltantes">Presencia de datos faltantes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diccionario-de-variables">Diccionario de variables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-univariado">Análisis univariado</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-bivariado">Análisis bivariado</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#target-y-d-63"><code class="docutils literal notranslate"><span class="pre">target</span></code> y <code class="docutils literal notranslate"><span class="pre">D_63</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#target-y-b-38"><code class="docutils literal notranslate"><span class="pre">target</span></code> y <code class="docutils literal notranslate"><span class="pre">B_38</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#target-y-d-92"><code class="docutils literal notranslate"><span class="pre">target</span></code> y <code class="docutils literal notranslate"><span class="pre">D_92</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seleccion-de-variables-numericas-para-correlacion">Selección de variables numéricas para correlación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-43-y-r-3"><code class="docutils literal notranslate"><span class="pre">D_43</span></code> y <code class="docutils literal notranslate"><span class="pre">R_3</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-55-y-r-19"><code class="docutils literal notranslate"><span class="pre">D_55</span></code> y <code class="docutils literal notranslate"><span class="pre">R_19</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#p-2-p-3-y-p-4"><code class="docutils literal notranslate"><span class="pre">P_2</span></code>, <code class="docutils literal notranslate"><span class="pre">P_3</span></code> y <code class="docutils literal notranslate"><span class="pre">P_4</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#p-2-y-p-3"><code class="docutils literal notranslate"><span class="pre">P_2</span></code> y <code class="docutils literal notranslate"><span class="pre">P_3</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-de-riesgo">Variables de riesgo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#r-8-y-r-5"><code class="docutils literal notranslate"><span class="pre">R_8</span></code> y <code class="docutils literal notranslate"><span class="pre">R_5</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#r-4-y-r-2"><code class="docutils literal notranslate"><span class="pre">R_4</span></code> y <code class="docutils literal notranslate"><span class="pre">R_2</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#r-5-y-r-4"><code class="docutils literal notranslate"><span class="pre">R_5</span></code> y <code class="docutils literal notranslate"><span class="pre">R_4</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#tratamientos-de-datos-faltantes-y-multicolinealidad">Tratamientos de datos faltantes y multicolinealidad</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos">Modelos</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#que-es-adasyn">¿Qué es ADASYN?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-sin-adasyn">Modelos sin ADASYN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#knn">KNN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificacion-bayesiana">Clasificación bayesiana</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-logistica-con-penalizacion-l1">Regresión logística con penalización L1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-logistica-con-penalizacion-l2">Regresión logística con penalización L2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion">Comparación</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-con-adasyn">Modelos con ADASYN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">KNN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Clasificación bayesiana</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Regresión logística con penalización L1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Regresión logística con penalización L2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Comparación</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-adasyn-o-sin-adasyn">Comparación: ADASYN o sin ADASYN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-adasyn-con-hiperparametrizacion-bayessearchcv-y-gridsearchcv-con-pipelines">Modelos ADASYN con hiperparametrización: BayesSearchCV y gridsearchCV con pipelines</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hiperparametrizacion-con-gridsearchcv">Hiperparametrización con GridsearchCV</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">KNN</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Clasificación bayesiana</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-logisitca-con-penalizacion-l1">Regresión logísitca con penalización L1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Regresión logística con penalización L2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Comparación</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hiperparametrizacion-con-bayessearchcv">Hiperparametrización con BayesSearchCV</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">KNN</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Clasificación bayesiana</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Regresión logísitca con penalización L1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-logisitca-con-penalizacion-l2">Regresión logísitca con penalización L2</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-entre-gridsearchcv-y-bayessearchcv">Comparación entre GridsearchCV y BayesSearchCV</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-final">Modelo final</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="default-probability-prediction">
<h1>Default Probability Prediction<a class="headerlink" href="#default-probability-prediction" title="Link to this heading">#</a></h1>
<section id="librerias">
<h2>Librerías<a class="headerlink" href="#librerias" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">missingno</span> <span class="k">as</span> <span class="nn">msno</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">funcionesauxiliares</span> <span class="k">as</span> <span class="nn">fa</span>

<span class="kn">from</span> <span class="nn">sklearn.experimental</span> <span class="kn">import</span> <span class="n">enable_iterative_imputer</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">IterativeImputer</span>

<span class="kn">import</span> <span class="nn">dask.dataframe</span> <span class="k">as</span> <span class="nn">dd</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="sobre-los-datos">
<h2>Sobre los datos<a class="headerlink" href="#sobre-los-datos" title="Link to this heading">#</a></h2>
<p>Este ejercicio busca mejorar la predicción de impago de crédito (default), clave para gestionar el riesgo en préstamos al consumidor y optimizar las decisiones de los prestamistas. Aunque existen modelos actuales,
se pretende crear uno más eficiente mediante técnicas de machine learning y un conjunto de datos a escala industrial, que incluye datos de comportamiento y perfiles anonimizados de clientes. Si es exitoso, el modelo
mejorará la experiencia del cliente, facilitando la aprobación de tarjetas de crédito, y ofrecerá oportunidades de premios, entrevistas y posibles nuevas carreras.</p>
<p>El objetivo de este proyecto es predecir la probabilidad de que un cliente no pague el saldo de su tarjeta de crédito en el futuro, basado en su perfil mensual. La variable objetivo es binaria y se calcula observando
una ventana de rendimiento de 18 meses posterior a la última fecha de estado de cuenta. Si el cliente no paga el saldo adeudado dentro de los 120 días posteriores a su última fecha de estado de cuenta, se considera un
evento de impago (default). El conjunto de datos contiene características agregadas del perfil de cada cliente en cada fecha de estado de cuenta.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;train_data.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;train_labels.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5531451, 190)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_labels</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(458913, 2)
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">train_data</span></code> contiene 190 variables y 5531451 de registros, <code class="docutils literal notranslate"><span class="pre">train_labels</span></code> contiene solo dos variables y 458913 registros, estas variables representan una id de usuario y el valor de la variable objetivo. En <code class="docutils literal notranslate"><span class="pre">train_data</span></code> existen varios registros asociados a un mismo id de usuario.</p>
</section>
<section id="sobre-las-variables">
<h2>Sobre las variables<a class="headerlink" href="#sobre-las-variables" title="Link to this heading">#</a></h2>
<p>Dentro de este dataset se pueden encontrar tres tipos de variables: categóricas, enteros y flotantes. En el caso de las variables <em>categóricas</em>, estás corresponden a: <code class="docutils literal notranslate"><span class="pre">customer_ID</span></code>, <code class="docutils literal notranslate"><span class="pre">S_2</span></code>, <code class="docutils literal notranslate"><span class="pre">D_63</span></code>, <code class="docutils literal notranslate"><span class="pre">D_64</span></code>. Las flotantes o decimales representan un 97,4% (185 variables) del dataset y por último, solo se encuentra una variable de tipo entero llamada <code class="docutils literal notranslate"><span class="pre">B_31</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tipos de variables presentes en el dataset</span>
<span class="n">train_data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([dtype(&#39;O&#39;), dtype(&#39;float64&#39;), dtype(&#39;int64&#39;)], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># solo variables de tipo objeto o categóricas</span>
<span class="n">train_data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span> <span class="o">=</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_ID</th>
      <th>S_2</th>
      <th>D_63</th>
      <th>D_64</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-03-09</td>
      <td>CR</td>
      <td>O</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-04-07</td>
      <td>CR</td>
      <td>O</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-05-28</td>
      <td>CR</td>
      <td>O</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-06-13</td>
      <td>CR</td>
      <td>O</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-07-16</td>
      <td>CR</td>
      <td>O</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5531446</th>
      <td>fffff1d38b785cef84adeace64f8f83db3a0c31e8d92ea...</td>
      <td>2017-11-05</td>
      <td>CL</td>
      <td>O</td>
    </tr>
    <tr>
      <th>5531447</th>
      <td>fffff1d38b785cef84adeace64f8f83db3a0c31e8d92ea...</td>
      <td>2017-12-23</td>
      <td>CL</td>
      <td>O</td>
    </tr>
    <tr>
      <th>5531448</th>
      <td>fffff1d38b785cef84adeace64f8f83db3a0c31e8d92ea...</td>
      <td>2018-01-06</td>
      <td>CL</td>
      <td>O</td>
    </tr>
    <tr>
      <th>5531449</th>
      <td>fffff1d38b785cef84adeace64f8f83db3a0c31e8d92ea...</td>
      <td>2018-02-06</td>
      <td>CL</td>
      <td>O</td>
    </tr>
    <tr>
      <th>5531450</th>
      <td>fffff1d38b785cef84adeace64f8f83db3a0c31e8d92ea...</td>
      <td>2018-03-14</td>
      <td>CL</td>
      <td>O</td>
    </tr>
  </tbody>
</table>
<p>5531451 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solo variables de tipo flotante</span>
<span class="n">train_data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span> <span class="o">=</span> <span class="s1">&#39;float64&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>P_2</th>
      <th>D_39</th>
      <th>B_1</th>
      <th>B_2</th>
      <th>R_1</th>
      <th>S_3</th>
      <th>D_41</th>
      <th>B_3</th>
      <th>D_42</th>
      <th>D_43</th>
      <th>...</th>
      <th>D_136</th>
      <th>D_137</th>
      <th>D_138</th>
      <th>D_139</th>
      <th>D_140</th>
      <th>D_141</th>
      <th>D_142</th>
      <th>D_143</th>
      <th>D_144</th>
      <th>D_145</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.938469</td>
      <td>0.001733</td>
      <td>0.008724</td>
      <td>1.006838</td>
      <td>0.009228</td>
      <td>0.124035</td>
      <td>0.008771</td>
      <td>0.004709</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.002427</td>
      <td>0.003706</td>
      <td>0.003818</td>
      <td>NaN</td>
      <td>0.000569</td>
      <td>0.000610</td>
      <td>0.002674</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.936665</td>
      <td>0.005775</td>
      <td>0.004923</td>
      <td>1.000653</td>
      <td>0.006151</td>
      <td>0.126750</td>
      <td>0.000798</td>
      <td>0.002714</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.003954</td>
      <td>0.003167</td>
      <td>0.005032</td>
      <td>NaN</td>
      <td>0.009576</td>
      <td>0.005492</td>
      <td>0.009217</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.954180</td>
      <td>0.091505</td>
      <td>0.021655</td>
      <td>1.009672</td>
      <td>0.006815</td>
      <td>0.123977</td>
      <td>0.007598</td>
      <td>0.009423</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.003269</td>
      <td>0.007329</td>
      <td>0.000427</td>
      <td>NaN</td>
      <td>0.003429</td>
      <td>0.006986</td>
      <td>0.002603</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.960384</td>
      <td>0.002455</td>
      <td>0.013683</td>
      <td>1.002700</td>
      <td>0.001373</td>
      <td>0.117169</td>
      <td>0.000685</td>
      <td>0.005531</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.006117</td>
      <td>0.004516</td>
      <td>0.003200</td>
      <td>NaN</td>
      <td>0.008419</td>
      <td>0.006527</td>
      <td>0.009600</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.947248</td>
      <td>0.002483</td>
      <td>0.015193</td>
      <td>1.000727</td>
      <td>0.007605</td>
      <td>0.117325</td>
      <td>0.004653</td>
      <td>0.009312</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.003671</td>
      <td>0.004946</td>
      <td>0.008889</td>
      <td>NaN</td>
      <td>0.001670</td>
      <td>0.008126</td>
      <td>0.009827</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5531446</th>
      <td>0.979332</td>
      <td>0.416013</td>
      <td>0.020818</td>
      <td>0.828199</td>
      <td>0.003487</td>
      <td>0.090743</td>
      <td>0.005340</td>
      <td>0.025139</td>
      <td>NaN</td>
      <td>0.014225</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.006838</td>
      <td>0.003680</td>
      <td>0.000457</td>
      <td>NaN</td>
      <td>0.000905</td>
      <td>0.001498</td>
      <td>0.002774</td>
    </tr>
    <tr>
      <th>5531447</th>
      <td>0.984907</td>
      <td>0.296536</td>
      <td>0.007209</td>
      <td>0.812610</td>
      <td>0.005904</td>
      <td>0.079886</td>
      <td>0.002243</td>
      <td>0.023691</td>
      <td>NaN</td>
      <td>0.009467</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.003310</td>
      <td>0.007097</td>
      <td>0.007857</td>
      <td>NaN</td>
      <td>0.002777</td>
      <td>0.008225</td>
      <td>0.008856</td>
    </tr>
    <tr>
      <th>5531448</th>
      <td>0.983019</td>
      <td>0.443984</td>
      <td>0.013151</td>
      <td>0.815422</td>
      <td>0.003457</td>
      <td>0.100503</td>
      <td>0.002111</td>
      <td>0.012343</td>
      <td>NaN</td>
      <td>0.006591</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.009955</td>
      <td>0.009994</td>
      <td>0.001088</td>
      <td>NaN</td>
      <td>0.005693</td>
      <td>0.006773</td>
      <td>0.005566</td>
    </tr>
    <tr>
      <th>5531449</th>
      <td>0.969861</td>
      <td>0.442553</td>
      <td>0.009855</td>
      <td>1.003541</td>
      <td>0.005117</td>
      <td>0.101802</td>
      <td>0.009930</td>
      <td>0.008578</td>
      <td>NaN</td>
      <td>0.014235</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.005541</td>
      <td>0.006564</td>
      <td>0.009883</td>
      <td>NaN</td>
      <td>0.008123</td>
      <td>0.001168</td>
      <td>0.003983</td>
    </tr>
    <tr>
      <th>5531450</th>
      <td>0.982175</td>
      <td>0.002474</td>
      <td>0.000077</td>
      <td>0.992880</td>
      <td>0.000809</td>
      <td>0.119165</td>
      <td>0.003287</td>
      <td>0.014092</td>
      <td>NaN</td>
      <td>0.013455</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.007316</td>
      <td>0.002888</td>
      <td>0.006207</td>
      <td>NaN</td>
      <td>0.005110</td>
      <td>0.003184</td>
      <td>0.001914</td>
    </tr>
  </tbody>
</table>
<p>5531451 rows × 185 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># solo variables de tipo entero</span>
<span class="n">train_data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span> <span class="o">=</span> <span class="s1">&#39;int64&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B_31</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>5531446</th>
      <td>1</td>
    </tr>
    <tr>
      <th>5531447</th>
      <td>1</td>
    </tr>
    <tr>
      <th>5531448</th>
      <td>1</td>
    </tr>
    <tr>
      <th>5531449</th>
      <td>1</td>
    </tr>
    <tr>
      <th>5531450</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5531451 rows × 1 columns</p>
</div></div></div>
</div>
<p>Sin embargo, se especificó que también [‘B_30’, ‘B_38’, ‘D_114’, ‘D_116’, ‘D_117’, ‘D_120’, ‘D_126’, ‘D_66’, ‘D_68’] son categóricas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B_30&#39;</span><span class="p">,</span> <span class="s1">&#39;B_38&#39;</span><span class="p">,</span> <span class="s1">&#39;D_114&#39;</span><span class="p">,</span> <span class="s1">&#39;D_116&#39;</span><span class="p">,</span> <span class="s1">&#39;D_117&#39;</span><span class="p">,</span> <span class="s1">&#39;D_120&#39;</span><span class="p">,</span> <span class="s1">&#39;D_126&#39;</span><span class="p">,</span> <span class="s1">&#39;D_66&#39;</span><span class="p">,</span> <span class="s1">&#39;D_68&#39;</span><span class="p">]</span>

<span class="c1"># Convertir [&#39;B_30&#39;, &#39;B_38&#39;, &#39;D_114&#39;, &#39;D_116&#39;, &#39;D_117&#39;, &#39;D_120&#39;, &#39;D_126&#39;, &#39;D_66&#39;, &#39;D_68&#39;] a categóricas</span>
<span class="n">train_data</span><span class="p">[</span><span class="n">temp</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="n">temp</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">train_data</span><span class="p">[</span><span class="n">temp</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="n">temp</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span> <span class="o">=</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_ID</th>
      <th>S_2</th>
      <th>D_63</th>
      <th>D_64</th>
      <th>D_66</th>
      <th>D_68</th>
      <th>B_30</th>
      <th>B_38</th>
      <th>D_114</th>
      <th>D_116</th>
      <th>D_117</th>
      <th>D_120</th>
      <th>D_126</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-03-09</td>
      <td>CR</td>
      <td>O</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-04-07</td>
      <td>CR</td>
      <td>O</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-05-28</td>
      <td>CR</td>
      <td>O</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-06-13</td>
      <td>CR</td>
      <td>O</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-07-16</td>
      <td>CR</td>
      <td>O</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5531446</th>
      <td>fffff1d38b785cef84adeace64f8f83db3a0c31e8d92ea...</td>
      <td>2017-11-05</td>
      <td>CL</td>
      <td>O</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5531447</th>
      <td>fffff1d38b785cef84adeace64f8f83db3a0c31e8d92ea...</td>
      <td>2017-12-23</td>
      <td>CL</td>
      <td>O</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5531448</th>
      <td>fffff1d38b785cef84adeace64f8f83db3a0c31e8d92ea...</td>
      <td>2018-01-06</td>
      <td>CL</td>
      <td>O</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5531449</th>
      <td>fffff1d38b785cef84adeace64f8f83db3a0c31e8d92ea...</td>
      <td>2018-02-06</td>
      <td>CL</td>
      <td>O</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5531450</th>
      <td>fffff1d38b785cef84adeace64f8f83db3a0c31e8d92ea...</td>
      <td>2018-03-14</td>
      <td>CL</td>
      <td>O</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>5531451 rows × 13 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="p">[</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;0000099d6bd597052cdcda90ffabf56573fe9d7c79be5fbac11a8ed792feb62a&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_ID</th>
      <th>S_2</th>
      <th>P_2</th>
      <th>D_39</th>
      <th>B_1</th>
      <th>B_2</th>
      <th>R_1</th>
      <th>S_3</th>
      <th>D_41</th>
      <th>B_3</th>
      <th>...</th>
      <th>D_136</th>
      <th>D_137</th>
      <th>D_138</th>
      <th>D_139</th>
      <th>D_140</th>
      <th>D_141</th>
      <th>D_142</th>
      <th>D_143</th>
      <th>D_144</th>
      <th>D_145</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-03-09</td>
      <td>0.938469</td>
      <td>0.001733</td>
      <td>0.008724</td>
      <td>1.006838</td>
      <td>0.009228</td>
      <td>0.124035</td>
      <td>0.008771</td>
      <td>0.004709</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.002427</td>
      <td>0.003706</td>
      <td>0.003818</td>
      <td>NaN</td>
      <td>0.000569</td>
      <td>0.000610</td>
      <td>0.002674</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-04-07</td>
      <td>0.936665</td>
      <td>0.005775</td>
      <td>0.004923</td>
      <td>1.000653</td>
      <td>0.006151</td>
      <td>0.126750</td>
      <td>0.000798</td>
      <td>0.002714</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.003954</td>
      <td>0.003167</td>
      <td>0.005032</td>
      <td>NaN</td>
      <td>0.009576</td>
      <td>0.005492</td>
      <td>0.009217</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-05-28</td>
      <td>0.954180</td>
      <td>0.091505</td>
      <td>0.021655</td>
      <td>1.009672</td>
      <td>0.006815</td>
      <td>0.123977</td>
      <td>0.007598</td>
      <td>0.009423</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.003269</td>
      <td>0.007329</td>
      <td>0.000427</td>
      <td>NaN</td>
      <td>0.003429</td>
      <td>0.006986</td>
      <td>0.002603</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-06-13</td>
      <td>0.960384</td>
      <td>0.002455</td>
      <td>0.013683</td>
      <td>1.002700</td>
      <td>0.001373</td>
      <td>0.117169</td>
      <td>0.000685</td>
      <td>0.005531</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.006117</td>
      <td>0.004516</td>
      <td>0.003200</td>
      <td>NaN</td>
      <td>0.008419</td>
      <td>0.006527</td>
      <td>0.009600</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-07-16</td>
      <td>0.947248</td>
      <td>0.002483</td>
      <td>0.015193</td>
      <td>1.000727</td>
      <td>0.007605</td>
      <td>0.117325</td>
      <td>0.004653</td>
      <td>0.009312</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.003671</td>
      <td>0.004946</td>
      <td>0.008889</td>
      <td>NaN</td>
      <td>0.001670</td>
      <td>0.008126</td>
      <td>0.009827</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-08-04</td>
      <td>0.945964</td>
      <td>0.001746</td>
      <td>0.007863</td>
      <td>1.005006</td>
      <td>0.004220</td>
      <td>0.110946</td>
      <td>0.009857</td>
      <td>0.009866</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.001924</td>
      <td>0.008598</td>
      <td>0.004529</td>
      <td>NaN</td>
      <td>0.000674</td>
      <td>0.002223</td>
      <td>0.002884</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-09-18</td>
      <td>0.940705</td>
      <td>0.002183</td>
      <td>0.018859</td>
      <td>1.008024</td>
      <td>0.004509</td>
      <td>0.103329</td>
      <td>0.006603</td>
      <td>0.000783</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.001336</td>
      <td>0.004361</td>
      <td>0.009387</td>
      <td>NaN</td>
      <td>0.007727</td>
      <td>0.007661</td>
      <td>0.002225</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-10-08</td>
      <td>0.914767</td>
      <td>0.003029</td>
      <td>0.014324</td>
      <td>1.000242</td>
      <td>0.000263</td>
      <td>0.108115</td>
      <td>0.009527</td>
      <td>0.007836</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.002397</td>
      <td>0.008452</td>
      <td>0.005553</td>
      <td>NaN</td>
      <td>0.001831</td>
      <td>0.009616</td>
      <td>0.007385</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-11-20</td>
      <td>0.950845</td>
      <td>0.009896</td>
      <td>0.016888</td>
      <td>1.003995</td>
      <td>0.001789</td>
      <td>0.102792</td>
      <td>0.002519</td>
      <td>0.009817</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.009742</td>
      <td>0.003968</td>
      <td>0.007945</td>
      <td>NaN</td>
      <td>0.008722</td>
      <td>0.004369</td>
      <td>0.000995</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-12-04</td>
      <td>0.868580</td>
      <td>0.001082</td>
      <td>0.001930</td>
      <td>1.007504</td>
      <td>0.001772</td>
      <td>0.100470</td>
      <td>0.004626</td>
      <td>0.006073</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.003611</td>
      <td>0.009607</td>
      <td>0.007266</td>
      <td>NaN</td>
      <td>0.008763</td>
      <td>0.004753</td>
      <td>0.009068</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2018-01-11</td>
      <td>0.909811</td>
      <td>0.005715</td>
      <td>0.002829</td>
      <td>1.004798</td>
      <td>0.008175</td>
      <td>0.098882</td>
      <td>0.001853</td>
      <td>0.003238</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000427</td>
      <td>0.004594</td>
      <td>0.003613</td>
      <td>NaN</td>
      <td>0.007568</td>
      <td>0.003004</td>
      <td>0.006362</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2018-02-21</td>
      <td>0.937349</td>
      <td>0.002425</td>
      <td>0.019837</td>
      <td>1.008307</td>
      <td>0.000607</td>
      <td>0.102985</td>
      <td>0.006174</td>
      <td>0.007454</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.001563</td>
      <td>0.001976</td>
      <td>0.002569</td>
      <td>NaN</td>
      <td>0.001098</td>
      <td>0.006346</td>
      <td>0.004204</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2018-03-13</td>
      <td>0.934745</td>
      <td>0.009119</td>
      <td>0.009382</td>
      <td>1.007647</td>
      <td>0.006104</td>
      <td>0.135021</td>
      <td>0.001604</td>
      <td>0.007174</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.007186</td>
      <td>0.004234</td>
      <td>0.005086</td>
      <td>NaN</td>
      <td>0.005810</td>
      <td>0.002970</td>
      <td>0.008533</td>
    </tr>
  </tbody>
</table>
<p>13 rows × 190 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="p">[</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;00000fd6641609c6ece5454664794f0340ad84dddce9a267a310b5ae68e9d8e5&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_ID</th>
      <th>S_2</th>
      <th>P_2</th>
      <th>D_39</th>
      <th>B_1</th>
      <th>B_2</th>
      <th>R_1</th>
      <th>S_3</th>
      <th>D_41</th>
      <th>B_3</th>
      <th>...</th>
      <th>D_136</th>
      <th>D_137</th>
      <th>D_138</th>
      <th>D_139</th>
      <th>D_140</th>
      <th>D_141</th>
      <th>D_142</th>
      <th>D_143</th>
      <th>D_144</th>
      <th>D_145</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13</th>
      <td>00000fd6641609c6ece5454664794f0340ad84dddce9a2...</td>
      <td>2017-03-01</td>
      <td>0.929122</td>
      <td>0.382790</td>
      <td>0.025782</td>
      <td>1.002647</td>
      <td>0.005515</td>
      <td>0.089799</td>
      <td>0.001479</td>
      <td>0.005830</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.003776</td>
      <td>0.001808</td>
      <td>0.008200</td>
      <td>NaN</td>
      <td>0.001061</td>
      <td>0.000027</td>
      <td>0.002629</td>
    </tr>
    <tr>
      <th>14</th>
      <td>00000fd6641609c6ece5454664794f0340ad84dddce9a2...</td>
      <td>2017-04-16</td>
      <td>0.918431</td>
      <td>0.002224</td>
      <td>0.006806</td>
      <td>1.008186</td>
      <td>0.003287</td>
      <td>0.095966</td>
      <td>0.007831</td>
      <td>0.000861</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.004046</td>
      <td>0.008288</td>
      <td>0.001375</td>
      <td>NaN</td>
      <td>0.009999</td>
      <td>0.002669</td>
      <td>0.006912</td>
    </tr>
    <tr>
      <th>15</th>
      <td>00000fd6641609c6ece5454664794f0340ad84dddce9a2...</td>
      <td>2017-05-07</td>
      <td>0.922563</td>
      <td>0.567403</td>
      <td>0.033713</td>
      <td>1.007497</td>
      <td>0.005594</td>
      <td>0.094655</td>
      <td>0.003162</td>
      <td>0.010466</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.007742</td>
      <td>0.002693</td>
      <td>0.009851</td>
      <td>NaN</td>
      <td>0.000996</td>
      <td>0.003254</td>
      <td>0.004469</td>
    </tr>
    <tr>
      <th>16</th>
      <td>00000fd6641609c6ece5454664794f0340ad84dddce9a2...</td>
      <td>2017-06-25</td>
      <td>0.919253</td>
      <td>0.213193</td>
      <td>0.031170</td>
      <td>1.008534</td>
      <td>0.008996</td>
      <td>0.099089</td>
      <td>0.009513</td>
      <td>0.005360</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.002502</td>
      <td>0.003399</td>
      <td>0.004284</td>
      <td>NaN</td>
      <td>0.002642</td>
      <td>0.004325</td>
      <td>0.006308</td>
    </tr>
    <tr>
      <th>17</th>
      <td>00000fd6641609c6ece5454664794f0340ad84dddce9a2...</td>
      <td>2017-07-30</td>
      <td>0.901860</td>
      <td>0.325467</td>
      <td>0.109644</td>
      <td>1.005098</td>
      <td>0.008041</td>
      <td>0.108526</td>
      <td>0.000732</td>
      <td>0.005484</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000275</td>
      <td>0.007992</td>
      <td>0.006918</td>
      <td>NaN</td>
      <td>0.009869</td>
      <td>0.002979</td>
      <td>0.005527</td>
    </tr>
    <tr>
      <th>18</th>
      <td>00000fd6641609c6ece5454664794f0340ad84dddce9a2...</td>
      <td>2017-08-19</td>
      <td>0.910458</td>
      <td>0.032285</td>
      <td>0.008208</td>
      <td>1.000814</td>
      <td>0.007448</td>
      <td>0.120456</td>
      <td>0.005400</td>
      <td>0.003697</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.007618</td>
      <td>0.004485</td>
      <td>0.006807</td>
      <td>NaN</td>
      <td>0.007862</td>
      <td>0.009127</td>
      <td>0.009390</td>
    </tr>
    <tr>
      <th>19</th>
      <td>00000fd6641609c6ece5454664794f0340ad84dddce9a2...</td>
      <td>2017-09-15</td>
      <td>0.904814</td>
      <td>0.004155</td>
      <td>0.011295</td>
      <td>1.006846</td>
      <td>0.007054</td>
      <td>0.122431</td>
      <td>0.007793</td>
      <td>0.005417</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000850</td>
      <td>0.008136</td>
      <td>0.006667</td>
      <td>NaN</td>
      <td>0.000411</td>
      <td>0.006197</td>
      <td>0.000796</td>
    </tr>
    <tr>
      <th>20</th>
      <td>00000fd6641609c6ece5454664794f0340ad84dddce9a2...</td>
      <td>2017-10-20</td>
      <td>0.916234</td>
      <td>0.038577</td>
      <td>0.011442</td>
      <td>1.008145</td>
      <td>0.006165</td>
      <td>0.123016</td>
      <td>0.007951</td>
      <td>0.012861</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.009322</td>
      <td>0.006410</td>
      <td>0.009879</td>
      <td>NaN</td>
      <td>0.007611</td>
      <td>0.001233</td>
      <td>0.002165</td>
    </tr>
    <tr>
      <th>21</th>
      <td>00000fd6641609c6ece5454664794f0340ad84dddce9a2...</td>
      <td>2017-11-24</td>
      <td>0.873512</td>
      <td>0.003067</td>
      <td>0.008903</td>
      <td>1.004783</td>
      <td>0.001023</td>
      <td>0.119332</td>
      <td>0.004865</td>
      <td>0.001811</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.002242</td>
      <td>0.007860</td>
      <td>0.008730</td>
      <td>NaN</td>
      <td>0.002120</td>
      <td>0.009568</td>
      <td>0.003408</td>
    </tr>
    <tr>
      <th>22</th>
      <td>00000fd6641609c6ece5454664794f0340ad84dddce9a2...</td>
      <td>2017-12-29</td>
      <td>0.861109</td>
      <td>0.302357</td>
      <td>0.006711</td>
      <td>0.819772</td>
      <td>0.007966</td>
      <td>0.139138</td>
      <td>0.000728</td>
      <td>0.005235</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.008488</td>
      <td>0.009377</td>
      <td>0.000191</td>
      <td>NaN</td>
      <td>0.004603</td>
      <td>0.003133</td>
      <td>0.007844</td>
    </tr>
    <tr>
      <th>23</th>
      <td>00000fd6641609c6ece5454664794f0340ad84dddce9a2...</td>
      <td>2018-01-26</td>
      <td>0.880925</td>
      <td>0.211731</td>
      <td>0.010583</td>
      <td>1.002313</td>
      <td>0.005955</td>
      <td>0.130116</td>
      <td>0.003628</td>
      <td>0.002802</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.007274</td>
      <td>0.008972</td>
      <td>0.002497</td>
      <td>NaN</td>
      <td>0.003979</td>
      <td>0.006627</td>
      <td>0.002178</td>
    </tr>
    <tr>
      <th>24</th>
      <td>00000fd6641609c6ece5454664794f0340ad84dddce9a2...</td>
      <td>2018-02-06</td>
      <td>0.878856</td>
      <td>0.536290</td>
      <td>0.034558</td>
      <td>1.005419</td>
      <td>0.007248</td>
      <td>0.159486</td>
      <td>0.006274</td>
      <td>0.008733</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.006658</td>
      <td>0.004627</td>
      <td>0.004820</td>
      <td>NaN</td>
      <td>0.008272</td>
      <td>0.002528</td>
      <td>0.003584</td>
    </tr>
    <tr>
      <th>25</th>
      <td>00000fd6641609c6ece5454664794f0340ad84dddce9a2...</td>
      <td>2018-03-25</td>
      <td>0.880519</td>
      <td>0.178126</td>
      <td>0.034684</td>
      <td>1.004028</td>
      <td>0.006911</td>
      <td>0.165509</td>
      <td>0.005552</td>
      <td>0.005068</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.002980</td>
      <td>0.007479</td>
      <td>0.007870</td>
      <td>NaN</td>
      <td>0.003284</td>
      <td>0.003169</td>
      <td>0.008514</td>
    </tr>
  </tbody>
</table>
<p>13 rows × 190 columns</p>
</div></div></div>
</div>
<section id="presencia-de-datos-faltantes">
<h3>Presencia de datos faltantes<a class="headerlink" href="#presencia-de-datos-faltantes" title="Link to this heading">#</a></h3>
<p>Primero revisemos el porcentaje de datos faltantes por cada una de las variables, esto con uso de la función <code class="docutils literal notranslate"><span class="pre">missing_per</span></code> ubicado en <code class="docutils literal notranslate"><span class="pre">funcionesauxiliares.py</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_per</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fa</span><span class="o">.</span><span class="n">missing_per</span><span class="p">(</span><span class="n">train_data</span><span class="p">))</span>
<span class="n">show</span> <span class="o">=</span> <span class="n">missing_per</span><span class="p">[</span><span class="n">missing_per</span> <span class="o">&gt;</span> <span class="mi">40</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">show</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>D_42</th>
      <td>85.694278</td>
    </tr>
    <tr>
      <th>D_49</th>
      <td>90.137597</td>
    </tr>
    <tr>
      <th>D_50</th>
      <td>56.809723</td>
    </tr>
    <tr>
      <th>D_53</th>
      <td>73.842921</td>
    </tr>
    <tr>
      <th>D_56</th>
      <td>54.071581</td>
    </tr>
    <tr>
      <th>S_9</th>
      <td>53.035686</td>
    </tr>
    <tr>
      <th>B_17</th>
      <td>56.722874</td>
    </tr>
    <tr>
      <th>D_66</th>
      <td>88.730733</td>
    </tr>
    <tr>
      <th>D_73</th>
      <td>98.990211</td>
    </tr>
    <tr>
      <th>D_76</th>
      <td>88.746226</td>
    </tr>
    <tr>
      <th>D_77</th>
      <td>45.447605</td>
    </tr>
    <tr>
      <th>R_9</th>
      <td>94.349891</td>
    </tr>
    <tr>
      <th>D_82</th>
      <td>73.373406</td>
    </tr>
    <tr>
      <th>B_29</th>
      <td>93.104594</td>
    </tr>
    <tr>
      <th>D_87</th>
      <td>99.930127</td>
    </tr>
    <tr>
      <th>D_88</th>
      <td>99.891457</td>
    </tr>
    <tr>
      <th>D_105</th>
      <td>54.622756</td>
    </tr>
    <tr>
      <th>D_106</th>
      <td>90.213255</td>
    </tr>
    <tr>
      <th>R_26</th>
      <td>88.984717</td>
    </tr>
    <tr>
      <th>D_108</th>
      <td>99.476846</td>
    </tr>
    <tr>
      <th>D_110</th>
      <td>99.433530</td>
    </tr>
    <tr>
      <th>D_111</th>
      <td>99.433530</td>
    </tr>
    <tr>
      <th>B_39</th>
      <td>99.391986</td>
    </tr>
    <tr>
      <th>B_42</th>
      <td>98.707789</td>
    </tr>
    <tr>
      <th>D_132</th>
      <td>90.191055</td>
    </tr>
    <tr>
      <th>D_134</th>
      <td>96.480146</td>
    </tr>
    <tr>
      <th>D_135</th>
      <td>96.480146</td>
    </tr>
    <tr>
      <th>D_136</th>
      <td>96.480146</td>
    </tr>
    <tr>
      <th>D_137</th>
      <td>96.480146</td>
    </tr>
    <tr>
      <th>D_138</th>
      <td>96.480146</td>
    </tr>
    <tr>
      <th>D_142</th>
      <td>82.926577</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_per</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fa</span><span class="o">.</span><span class="n">missing_per</span><span class="p">(</span><span class="n">train_data</span><span class="p">))</span>
<span class="n">show</span> <span class="o">=</span> <span class="n">missing_per</span><span class="p">[</span><span class="n">missing_per</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="nb">len</span><span class="p">(</span><span class="n">show</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>122
</pre></div>
</div>
</div>
</div>
<p>Existen 31 variables de 190 las cuales cuentan con un porcentaje de datos faltantes mayor al 40%. Y en 122 variables, de las 190, se observan datos faltantes. Más adelante se verá qué tratamiento se le da a estas.</p>
</section>
<section id="diccionario-de-variables">
<h3>Diccionario de variables<a class="headerlink" href="#diccionario-de-variables" title="Link to this heading">#</a></h3>
<p>Las 190 variables están clasificadas con una letra y un número de la siguiente manera:</p>
<ul class="simple">
<li><p>D_*: variables delincuenciales</p></li>
<li><p>S_*: variables de gastos</p></li>
<li><p>P_*: variables de pagos</p></li>
<li><p>B_*: variables de balance</p></li>
<li><p>R_*: variables de riesgo</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">train_data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;D_&#39;</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Variables delincuenciales: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">temp</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">temp</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">train_data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;S_&#39;</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Variables de gastos: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">temp</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">temp</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">train_data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;P_&#39;</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Variables de pagos: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">temp</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">temp</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">train_data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;B_&#39;</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Variables de balance: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">temp</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">temp</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">train_data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;R_&#39;</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Variables de riesgo: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">temp</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variables delincuenciales: 96 - [&#39;D_39&#39;, &#39;D_41&#39;, &#39;D_42&#39;, &#39;D_43&#39;, &#39;D_44&#39;, &#39;D_45&#39;, &#39;D_46&#39;, &#39;D_47&#39;, &#39;D_48&#39;, &#39;D_49&#39;, &#39;D_50&#39;, &#39;D_51&#39;, &#39;D_52&#39;, &#39;D_53&#39;, &#39;D_54&#39;, &#39;D_55&#39;, &#39;D_56&#39;, &#39;D_58&#39;, &#39;D_59&#39;, &#39;D_60&#39;, &#39;D_61&#39;, &#39;D_62&#39;, &#39;D_63&#39;, &#39;D_64&#39;, &#39;D_65&#39;, &#39;D_66&#39;, &#39;D_68&#39;, &#39;D_69&#39;, &#39;D_70&#39;, &#39;D_71&#39;, &#39;D_72&#39;, &#39;D_73&#39;, &#39;D_74&#39;, &#39;D_75&#39;, &#39;D_76&#39;, &#39;D_77&#39;, &#39;D_78&#39;, &#39;D_79&#39;, &#39;D_80&#39;, &#39;D_81&#39;, &#39;D_82&#39;, &#39;D_83&#39;, &#39;D_84&#39;, &#39;D_86&#39;, &#39;D_87&#39;, &#39;D_88&#39;, &#39;D_89&#39;, &#39;D_91&#39;, &#39;D_92&#39;, &#39;D_93&#39;, &#39;D_94&#39;, &#39;D_96&#39;, &#39;D_102&#39;, &#39;D_103&#39;, &#39;D_104&#39;, &#39;D_105&#39;, &#39;D_106&#39;, &#39;D_107&#39;, &#39;D_108&#39;, &#39;D_109&#39;, &#39;D_110&#39;, &#39;D_111&#39;, &#39;D_112&#39;, &#39;D_113&#39;, &#39;D_114&#39;, &#39;D_115&#39;, &#39;D_116&#39;, &#39;D_117&#39;, &#39;D_118&#39;, &#39;D_119&#39;, &#39;D_120&#39;, &#39;D_121&#39;, &#39;D_122&#39;, &#39;D_123&#39;, &#39;D_124&#39;, &#39;D_125&#39;, &#39;D_126&#39;, &#39;D_127&#39;, &#39;D_128&#39;, &#39;D_129&#39;, &#39;D_130&#39;, &#39;D_131&#39;, &#39;D_132&#39;, &#39;D_133&#39;, &#39;D_134&#39;, &#39;D_135&#39;, &#39;D_136&#39;, &#39;D_137&#39;, &#39;D_138&#39;, &#39;D_139&#39;, &#39;D_140&#39;, &#39;D_141&#39;, &#39;D_142&#39;, &#39;D_143&#39;, &#39;D_144&#39;, &#39;D_145&#39;]
Variables de gastos: 22 - [&#39;S_2&#39;, &#39;S_3&#39;, &#39;S_5&#39;, &#39;S_6&#39;, &#39;S_7&#39;, &#39;S_8&#39;, &#39;S_9&#39;, &#39;S_11&#39;, &#39;S_12&#39;, &#39;S_13&#39;, &#39;S_15&#39;, &#39;S_16&#39;, &#39;S_17&#39;, &#39;S_18&#39;, &#39;S_19&#39;, &#39;S_20&#39;, &#39;S_22&#39;, &#39;S_23&#39;, &#39;S_24&#39;, &#39;S_25&#39;, &#39;S_26&#39;, &#39;S_27&#39;]
Variables de pagos: 3 - [&#39;P_2&#39;, &#39;P_3&#39;, &#39;P_4&#39;]
Variables de balance: 40 - [&#39;B_1&#39;, &#39;B_2&#39;, &#39;B_3&#39;, &#39;B_4&#39;, &#39;B_5&#39;, &#39;B_6&#39;, &#39;B_7&#39;, &#39;B_8&#39;, &#39;B_9&#39;, &#39;B_10&#39;, &#39;B_11&#39;, &#39;B_12&#39;, &#39;B_13&#39;, &#39;B_14&#39;, &#39;B_15&#39;, &#39;B_16&#39;, &#39;B_17&#39;, &#39;B_18&#39;, &#39;B_19&#39;, &#39;B_20&#39;, &#39;B_21&#39;, &#39;B_22&#39;, &#39;B_23&#39;, &#39;B_24&#39;, &#39;B_25&#39;, &#39;B_26&#39;, &#39;B_27&#39;, &#39;B_28&#39;, &#39;B_29&#39;, &#39;B_30&#39;, &#39;B_31&#39;, &#39;B_32&#39;, &#39;B_33&#39;, &#39;B_36&#39;, &#39;B_37&#39;, &#39;B_38&#39;, &#39;B_39&#39;, &#39;B_40&#39;, &#39;B_41&#39;, &#39;B_42&#39;]
Variables de riesgo: 28 - [&#39;R_1&#39;, &#39;R_2&#39;, &#39;R_3&#39;, &#39;R_4&#39;, &#39;R_5&#39;, &#39;R_6&#39;, &#39;R_7&#39;, &#39;R_8&#39;, &#39;R_9&#39;, &#39;R_10&#39;, &#39;R_11&#39;, &#39;R_12&#39;, &#39;R_13&#39;, &#39;R_14&#39;, &#39;R_15&#39;, &#39;R_16&#39;, &#39;R_17&#39;, &#39;R_18&#39;, &#39;R_19&#39;, &#39;R_20&#39;, &#39;R_21&#39;, &#39;R_22&#39;, &#39;R_23&#39;, &#39;R_24&#39;, &#39;R_25&#39;, &#39;R_26&#39;, &#39;R_27&#39;, &#39;R_28&#39;]
</pre></div>
</div>
</div>
</div>
<p>Existen 96 variables asociadas a delincuencia, 22 a gastos, 3 a pagos, 40 a balance y 28 a riesgos.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="analisis-univariado">
<h1>Análisis univariado<a class="headerlink" href="#analisis-univariado" title="Link to this heading">#</a></h1>
<p>Como parte del conjuntos de entrenamiento se proporciona <code class="docutils literal notranslate"><span class="pre">train_labels</span></code> el cual etiqueta la variable objetivo o <code class="docutils literal notranslate"><span class="pre">target</span></code> para cada <code class="docutils literal notranslate"><span class="pre">customer_ID</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_labels</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_labels</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">train_labels</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 458913 entries, 0 to 458912
Data columns (total 2 columns):
 #   Column       Non-Null Count   Dtype 
---  ------       --------------   ----- 
 0   customer_ID  458913 non-null  object
 1   target       458913 non-null  object
dtypes: object(2)
memory usage: 7.0+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_labels</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">train_labels</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>target
0    0.741066
1    0.258934
Name: count, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">train_labels</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribución de la variable objetivo en entrenamiento&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Valores objetivo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c53dc485a44267ba81f6f2856e03d58edb8388672a8af23365c7c853e9f449ee.png" src="_images/c53dc485a44267ba81f6f2856e03d58edb8388672a8af23365c7c853e9f449ee.png" />
</div>
</div>
<p>Se observa un gran desbalance en la cantidad de <code class="docutils literal notranslate"><span class="pre">target</span> <span class="pre">=</span> <span class="pre">1</span></code> (25,9%) o <em>impago</em> a <code class="docutils literal notranslate"><span class="pre">target</span> <span class="pre">=</span> <span class="pre">0</span></code> o <em>pago</em> (74,1%).</p>
<p>Para observar como se distribuyen algunas de las variables independientes de este dataset, se seleccionarán 2 de cada tipo de variable. Para las variables delincuenciales se analizarán <code class="docutils literal notranslate"><span class="pre">D_39</span></code> y <code class="docutils literal notranslate"><span class="pre">D_63</span></code>, una numérica y una categórica respectivamente. Para las de gasto <code class="docutils literal notranslate"><span class="pre">S_2</span></code> y <code class="docutils literal notranslate"><span class="pre">S_22</span></code>, para pagos <code class="docutils literal notranslate"><span class="pre">P_2</span></code> y <code class="docutils literal notranslate"><span class="pre">P_3</span></code>, de balance y riesgo <code class="docutils literal notranslate"><span class="pre">B_30</span></code> (categórica), <code class="docutils literal notranslate"><span class="pre">B_39</span></code> (numérica), <code class="docutils literal notranslate"><span class="pre">R_3</span></code> y <code class="docutils literal notranslate"><span class="pre">R_20</span></code>.</p>
<p><span class="math notranslate nohighlight">\(\Large \textsf{D\_39}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;D_39&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>D_39</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5.531451e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.531172e-01</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.700709e-01</td>
    </tr>
    <tr>
      <th>min</th>
      <td>5.026190e-09</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>4.528464e-03</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>9.056902e-03</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.366407e-01</td>
    </tr>
    <tr>
      <th>max</th>
      <td>5.389619e+00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;D_39&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">vert</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># Usamos dropna() para eliminar los valores nulos</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Boxplot de la columna D_39&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Valores de D_39&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d1913dadef2cca7e4969a2882e130cd94a2d18d9e0698f41b75f8bdb470626fa.png" src="_images/d1913dadef2cca7e4969a2882e130cd94a2d18d9e0698f41b75f8bdb470626fa.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;D_39&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histograma de D_39&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Valores de D_39&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7d6e73772e463a5a595e1a250fda0fa7d45f005165068b103718abef056defc2.png" src="_images/7d6e73772e463a5a595e1a250fda0fa7d45f005165068b103718abef056defc2.png" />
</div>
</div>
<p>Del resumen estadístico se esperaba la asimetría positiva debido a la diferencia entre la mediana y la media (lo cual también sugiere la presencia de datos atípicos altos), asimetría observada en el boxplot. Los valores van desde casi cero hasta 5.39 donde la mitad de los datos se encuentra entre 0.0045 (25%) y 0.2366 (75%), con una mediana de 0.009. Además de euna desviación estándar de 0.270, lo que sugiere una dispersión moderada alrededor de la media.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fa</span><span class="o">.</span><span class="n">missing_per</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;D_39&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(0.0)
</pre></div>
</div>
</div>
</div>
<p>Esta variable no cuenta con datos faltantes.</p>
<p><span class="math notranslate nohighlight">\(\Large \textsf{D\_63}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;D_63&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>D_63</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5531451</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>6</td>
    </tr>
    <tr>
      <th>top</th>
      <td>CO</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>4119621</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;D_63&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;CR&#39;, &#39;CO&#39;, &#39;CL&#39;, &#39;XZ&#39;, &#39;XM&#39;, &#39;XL&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fa</span><span class="o">.</span><span class="n">missing_per</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;D_63&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(0.0)
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">D_63</span></code> es una variable categórica asociada a delincuencia con 6 categorías diferentes: CR, CO, CL, XZ, XM y XL la cual tampoco cuenta con datos faltantes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">bar_plot</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;D_63&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">bar_plot</span><span class="o">.</span><span class="n">containers</span><span class="p">:</span>
    <span class="n">bar_plot</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribución de la columna D_63&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Valores de D_63&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3e80307e59f271c245ecf69b6f8a988d54fef5154b6d48e6c03708e32804c907.png" src="_images/3e80307e59f271c245ecf69b6f8a988d54fef5154b6d48e6c03708e32804c907.png" />
</div>
</div>
<p>La categoría más frecuente fue CO, seguida de CR, CL y XZ, y por último XM y XL con una gran diferencia en la cantidad de registros por categoría.</p>
<p><span class="math notranslate nohighlight">\(\Large \textsf{S\_2}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;S_2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;bound method NDFrame.describe of 0          2017-03-09
1          2017-04-07
2          2017-05-28
3          2017-06-13
4          2017-07-16
              ...    
5531446    2017-11-05
5531447    2017-12-23
5531448    2018-01-06
5531449    2018-02-06
5531450    2018-03-14
Name: S_2, Length: 5531451, dtype: object&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;S_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;S_2&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;S_2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">to_period</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;S_2&#39;&gt;
</pre></div>
</div>
<img alt="_images/adfb81e2e8fe88a4f73ca18aadf2b232737525dee6446cd3d8296e66ed3f5083.png" src="_images/adfb81e2e8fe88a4f73ca18aadf2b232737525dee6446cd3d8296e66ed3f5083.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;S_2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">to_period</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>S_2
2017-03    395630
2017-04    401556
2017-05    400306
2017-06    410384
2017-07    415602
2017-08    421099
2017-09    425455
2017-10    430292
2017-11    434268
2017-12    438910
2018-01    446255
2018-02    452781
2018-03    458913
Freq: M, Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Se observa un crecimiento constante en el conteo a lo largo de los 13 meses de observaciones, con un incremento mensual casi continuo, esto sugiere que hay una tendencia positiva en el número de registros por mes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fa</span><span class="o">.</span><span class="n">missing_per</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;S_2&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(0.0)
</pre></div>
</div>
</div>
</div>
<p>En <code class="docutils literal notranslate"><span class="pre">S_2</span></code> tampoco se encuentran valores faltantes.</p>
<p><span class="math notranslate nohighlight">\(\Large \textsf{S\_22}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fa</span><span class="o">.</span><span class="n">missing_per</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;S_22&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(0.3439242253072476)
</pre></div>
</div>
</div>
</div>
<p>En esta variable de costos está compuesta en un 0.34% (19024 observaciones) de datos faltantes, un porcentaje bastante pequeño.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;S_22&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>S_22</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5.512427e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>7.791037e-01</td>
    </tr>
    <tr>
      <th>std</th>
      <td>7.187471e-01</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-9.199816e+01</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>8.111971e-01</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>9.422135e-01</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>9.647727e-01</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.032727e+00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;S_22&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">vert</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># Usamos dropna() para eliminar los valores nulos</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Boxplot de la variable S_22&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Valores de S_22&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bbad97e8664e348a64f933277d553409fd9f52113bd8d25c24f6c9363a6c0343.png" src="_images/bbad97e8664e348a64f933277d553409fd9f52113bd8d25c24f6c9363a6c0343.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;S_22&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histograma de S_22&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Valores de S_22&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b90d622a0d4792d52220176bb7d981dd08466943ef1e87ba2137b173c2ea4841.png" src="_images/b90d622a0d4792d52220176bb7d981dd08466943ef1e87ba2137b173c2ea4841.png" />
</div>
</div>
<p>Del resumen estadístico y el boxplot, se observa una asimetría negativa con la presencia de valores atípicos bajos que influyen en la distribución. Los datos varían desde un mínimo de -91.999 hasta un máximo de 1.033, indicando una amplia gama de valores. La mitad central de los datos se encuentra entre 0.812 (25%) y 0.965 (75%), lo que revela una concentración en la parte alta de la distribución. La desviación estándar de 0.718 sugiere una dispersión considerable alrededor de la media. Esta variabilidad se refleja en el boxplot, donde se evidencian outliers en la parte baja.</p>
<p><span class="math notranslate nohighlight">\(\Large \textsf{P\_2}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fa</span><span class="o">.</span><span class="n">missing_per</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;P_2&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(0.8313370216964772)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;P_2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.int64(45985)
</pre></div>
</div>
</div>
</div>
<p>Para la variable <code class="docutils literal notranslate"><span class="pre">P_2</span></code> falta el 0.83% de las observaciones, es decir, 45985 registros vacíos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;P_2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>P_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5.485466e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>6.563340e-01</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.446494e-01</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-4.589548e-01</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>4.803307e-01</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>6.942950e-01</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>8.648159e-01</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.010000e+00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;P_2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">vert</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># Usamos dropna() para eliminar los valores nulos</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Boxplot de la variable P_2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Valores de P_2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/127f7e49caef47fb097d549b0e11a35d19fd9e4742b5588a4b06c1a2b9403ca7.png" src="_images/127f7e49caef47fb097d549b0e11a35d19fd9e4742b5588a4b06c1a2b9403ca7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;P_2&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histograma de P_2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Valores de P_2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9015e67a10ed6f85b89c19739745e69a80ad46475bf9aa387fb2cc16aa84a762.png" src="_images/9015e67a10ed6f85b89c19739745e69a80ad46475bf9aa387fb2cc16aa84a762.png" />
</div>
</div>
<p>Del resumen estadístico y el gráfico se llega a la existencia de una asimetría negativa en la variable y con ello la presencia de valores atípicos bajos. Los valores varían desde un mínimo de -0.459 hasta un máximo de 1.010 y el 50% central de los datos se concentra entre 0.480 (25%) y 0.865 (75%), lo que indica que la mayoría de las observaciones están en el rango superior.</p>
<p><span class="math notranslate nohighlight">\(\Large \textsf{P\_3}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fa</span><span class="o">.</span><span class="n">missing_per</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;P_3&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(5.450504759058699)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;P_3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.int64(301492)
</pre></div>
</div>
</div>
</div>
<p>Para la variable <code class="docutils literal notranslate"><span class="pre">P_3</span></code> falta el 5.45% de las observaciones, es decir, 301492 registros vacíos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;P_3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>P_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5.229959e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>6.012886e-01</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.707992e-01</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.519690e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>5.408657e-01</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>6.183025e-01</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>6.838264e-01</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.428051e+00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;P_3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">vert</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># Usamos dropna() para eliminar los valores nulos</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Boxplot de la variable P_3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Valores de P_3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8b031184d260f6231039e064768cadcdec75c7833f09c194357067bb19e04604.png" src="_images/8b031184d260f6231039e064768cadcdec75c7833f09c194357067bb19e04604.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;P_3&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histograma de P_3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Valores de P_3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ec257a4274463834d5ce282eaa8b4a779ed4563a5cfc01e0b913bdeb009fb18d.png" src="_images/ec257a4274463834d5ce282eaa8b4a779ed4563a5cfc01e0b913bdeb009fb18d.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">P_3</span></code> muestra una distribución más equilibrada en comparación a las variables vistas anteriormente, con una media de 0.601 y una mediana de 0.618, indicando que no hay una asimetría significativa. Los valores oscilan desde un mínimo de -1.520 hasta un máximo de 2.428. El 50% de las observaciones se sitúa entre 0.541 (25%) y 0.684 (75%), lo que sugiere que la mayoría de los datos se agrupan en la parte central y un poco superior de la distribución. Con una desviación estándar de 0.171, la dispersión alrededor de la media es moderada, lo que refuerza la idea de que los datos están relativamente concentrados. en el boxplot se observa esa distribución un poco más centrada, sin embargo, existen una gran cantidad de datos atípicos tanto a la izquierda como a la derecha de los bigotes.</p>
<p><span class="math notranslate nohighlight">\(\Large \textsf{B\_30}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;B_30&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B_30</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5529435</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>3</td>
    </tr>
    <tr>
      <th>top</th>
      <td>0.0</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>4710663</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;B_30&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;B_30&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;B_30&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;0.0&#39;, &#39;2.0&#39;, &#39;1.0&#39;, nan], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fa</span><span class="o">.</span><span class="n">missing_per</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;B_30&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(0.0364461332117016)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;B_30&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.int64(2016)
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">B_30</span></code> es una variable categórica asociada a delincuencia con 3 categorías diferentes: 0.0, 2.0 y 1.0 la cual cuenta con un 0.03% (2016) de registros faltantes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">bar_plot</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;B_30&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">bar_plot</span><span class="o">.</span><span class="n">containers</span><span class="p">:</span>
    <span class="n">bar_plot</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribución de la columna B_30&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Valores de B_30&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/04781856f339bc9b64ebfcfdd6efe80811a99bde5d6a49d6443d0a9f882cd9e6.png" src="_images/04781856f339bc9b64ebfcfdd6efe80811a99bde5d6a49d6443d0a9f882cd9e6.png" />
</div>
</div>
<p>La categoría más frecuente fue 0.0, seguida de 1.0 y por último 2.0 con una gran diferencia en la cantidad de registros por categoría.</p>
<p><span class="math notranslate nohighlight">\(\Large \textsf{B\_39}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fa</span><span class="o">.</span><span class="n">missing_per</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;B_39&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(99.39198593642065)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;B_39&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.int64(5497819)
</pre></div>
</div>
</div>
</div>
<p>En esta variable de balance está compuesta en un 99.39% (5497819 observaciones) de datos faltantes, un porcentaje extremadamente alto.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;B_39&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B_39</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>33632.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.255473</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.297895</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-0.979314</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.058394</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.149225</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.291426</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.060899</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;B_39&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">vert</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># Usamos dropna() para eliminar los valores nulos</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Boxplot de la variable B_39&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Valores de B_39&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/29d8ad0cd12e8ebb08c14603e4218d0383f7bf54a1334b48ec75aaac2baea806.png" src="_images/29d8ad0cd12e8ebb08c14603e4218d0383f7bf54a1334b48ec75aaac2baea806.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;B_39&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histograma de B_39&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Valores de B_39&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/83c78285fb0d70b563db1c348cfdadaf74268b6c09955dac32945763699b4379.png" src="_images/83c78285fb0d70b563db1c348cfdadaf74268b6c09955dac32945763699b4379.png" />
</div>
</div>
<p>Se nota una asimetría positiva. Los valores oscilan entre un mínimo de -0.979 y un máximo de 2.061, lo que indica una variabilidad considerable. El 50% central de las observaciones se concentra entre 0.058 (25%) y 0.291 (75%), lo que sugiere que la mayoría de los datos están agrupados en el rango bajo y medio. Con una desviación estándar de 0.298, la dispersión alrededor de la media es notable, observado en el boxplot, donde se aprecian valores atípicos con mayor frecuencia a la derecha de los bigotes, aunque aún así hay varios a la parte izquierda, es decir, a valores más pequeños.</p>
<p><span class="math notranslate nohighlight">\(\Large \textsf{R\_3}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fa</span><span class="o">.</span><span class="n">missing_per</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_3&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(0.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.int64(0)
</pre></div>
</div>
</div>
</div>
<p>En esta variable de riesgo no posee datos faltantes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5.531451e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.208287e-01</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.105157e-01</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2.238322e-09</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>4.700085e-03</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>9.400614e-03</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.003358e-01</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.160260e+01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">vert</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># Usamos dropna() para eliminar los valores nulos</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Boxplot de la variable R_3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Valores de R_3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/de589ad1cfd2d0047ce2cae7d8fe8346af9713add6e6db4986f5a5cadd44b54e.png" src="_images/de589ad1cfd2d0047ce2cae7d8fe8346af9713add6e6db4986f5a5cadd44b54e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_3&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histograma de R_3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Valores de R_3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9d76d6fc20dd7f6bca1f15e06ac81fa947e468ec38a629d860269197bd7392c6.png" src="_images/9d76d6fc20dd7f6bca1f15e06ac81fa947e468ec38a629d860269197bd7392c6.png" />
</div>
</div>
<p>Se puede notar una fuerte asimetría positiva en <code class="docutils literal notranslate"><span class="pre">R_3</span></code>. El valor mínimo es prácticamente cero (2.23e-09). En cuanto a los cuartiles, el 25% de los datos están por debajo de 0.0047, el 50% (la mediana) es de 0.0094, y el 75% no supera 0.20, es decir, la mayoría de los valores están concentrados cerca de los mínimos, mientras que existen algunos valores mucho más altos que empujan la cola hacia la derecha, con un valor máximo de 11.60, indicando la presencia de outliers en la parte derecha de los bigotes, confirmado por el boxplot.</p>
<p><span class="math notranslate nohighlight">\(\Large \textsf{R\_20}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fa</span><span class="o">.</span><span class="n">missing_per</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_20&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(0.0013558829319829462)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_20&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.int64(75)
</pre></div>
</div>
</div>
</div>
<p>En esta variable de riesgo está compuesta en un 0.001% (75 observaciones) de datos faltantes, un valor bastante pequeño.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_20&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R_20</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5.531376e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.694556e-02</td>
    </tr>
    <tr>
      <th>std</th>
      <td>3.780643e-01</td>
    </tr>
    <tr>
      <th>min</th>
      <td>4.972086e-09</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.537703e-03</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>5.075567e-03</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>7.614203e-03</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.500603e+01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_20&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">vert</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># Usamos dropna() para eliminar los valores nulos</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Boxplot de la variable R_20&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Valores de R_20&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0978b57fdbb32ce8f673027f3afe5c7732584a43e2d01529f5a630beb3670b66.png" src="_images/0978b57fdbb32ce8f673027f3afe5c7732584a43e2d01529f5a630beb3670b66.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_20&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histograma de R_20&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Valores de R_20&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f62405ddcdf6fb886114b4187f31a9acd33cc8069fbab964ccd7fed9daa9c7ea.png" src="_images/f62405ddcdf6fb886114b4187f31a9acd33cc8069fbab964ccd7fed9daa9c7ea.png" />
</div>
</div>
<p>Para la variable <code class="docutils literal notranslate"><span class="pre">R_20</span></code>, la media es de 0.0369 con una desviación estándar considerablemente alta (0.378), lo que indica una gran dispersión en los datos. Los cuartiles muestran que el 25% de los datos son menores a 0.0025, el 50% (la mediana) es de 0.0051, y el 75% no supera 0.0076, lo que indica una fuerte asimetría positiva. Aunque la mayoría de los datos están muy cerca de cero, el valor máximo de 45.006 sugiere la presencia de valores extremadamente altos (outliers), lo que contribuye a la larga cola derecha en la distribución de los datos.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="analisis-bivariado">
<h1>Análisis bivariado<a class="headerlink" href="#analisis-bivariado" title="Link to this heading">#</a></h1>
<p>cat: 	customer_ID	S_2	D_63	D_64	D_66	D_68	B_30	B_38	D_114	D_116	D_117	D_120	D_126
Consideramos pertinente revisar</p>
<section id="target-y-d-63">
<h2><code class="docutils literal notranslate"><span class="pre">target</span></code> y <code class="docutils literal notranslate"><span class="pre">D_63</span></code><a class="headerlink" href="#target-y-d-63" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">train_data</span><span class="p">[[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span><span class="s1">&#39;D_63&#39;</span><span class="p">]],</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">counts</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="s1">&#39;D_63&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">counts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribución de D_63 por Target&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Target&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cantidad&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;D_63&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fb9014e1f294bf90db9b03bb7c1fc128001a5a84c7284399e057607bf0452118.png" src="_images/fb9014e1f294bf90db9b03bb7c1fc128001a5a84c7284399e057607bf0452118.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>D_63</th>
      <th>CL</th>
      <th>CO</th>
      <th>CR</th>
      <th>XL</th>
      <th>XM</th>
      <th>XZ</th>
    </tr>
    <tr>
      <th>target</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>310865</td>
      <td>3036914</td>
      <td>772136</td>
      <td>4754</td>
      <td>8050</td>
      <td>20863</td>
    </tr>
    <tr>
      <th>1</th>
      <td>127525</td>
      <td>1082707</td>
      <td>157997</td>
      <td>2211</td>
      <td>2506</td>
      <td>4923</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Existe una gran diferencia entre la proporcion de cada categoría de <code class="docutils literal notranslate"><span class="pre">D_63</span></code> tanto en 0 y 1, sin embargo parece mantenerse proprcional entre ambas categorías de <code class="docutils literal notranslate"><span class="pre">target</span></code>. En ambas categorías, <strong>CO</strong> cuenta con una mayor frecuencia, seguida por <strong>CR</strong> y <strong>CL</strong>, siendo <strong>XL</strong> la categoría con menos registros en ambas.</p>
</section>
<section id="target-y-b-38">
<h2><code class="docutils literal notranslate"><span class="pre">target</span></code> y <code class="docutils literal notranslate"><span class="pre">B_38</span></code><a class="headerlink" href="#target-y-b-38" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">train_data</span><span class="p">[[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span><span class="s1">&#39;B_38&#39;</span><span class="p">]],</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">counts</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="s1">&#39;B_38&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">counts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribución de B_38 por Target&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Target&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cantidad&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;B_38&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8ce96074a05a0386812d92e65ec40115afdf8f700c73c7318536f5398d1ef1c8.png" src="_images/8ce96074a05a0386812d92e65ec40115afdf8f700c73c7318536f5398d1ef1c8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>B_38</th>
      <th>1.0</th>
      <th>2.0</th>
      <th>3.0</th>
      <th>4.0</th>
      <th>5.0</th>
      <th>6.0</th>
      <th>7.0</th>
    </tr>
    <tr>
      <th>target</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1003134</td>
      <td>1829580</td>
      <td>842814</td>
      <td>88559</td>
      <td>195990</td>
      <td>62399</td>
      <td>129808</td>
    </tr>
    <tr>
      <th>1</th>
      <td>156913</td>
      <td>123652</td>
      <td>412501</td>
      <td>206358</td>
      <td>248866</td>
      <td>99641</td>
      <td>129220</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A diferencia del análisis anterior, aquí las proprciones no parecen mantenerse entre ambas categorías de la variable <code class="docutils literal notranslate"><span class="pre">target</span></code>. En 0, la categoría de <code class="docutils literal notranslate"><span class="pre">B_38</span></code> 2.0 fue la más frecuente, sin embargo, en 1 fue 3.0. En ambas coincide que 6.0 es la categoría de <code class="docutils literal notranslate"><span class="pre">B_38</span></code> menos frecuente.</p>
</section>
<section id="target-y-d-92">
<h2><code class="docutils literal notranslate"><span class="pre">target</span></code> y <code class="docutils literal notranslate"><span class="pre">D_92</span></code><a class="headerlink" href="#target-y-d-92" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">train_data</span><span class="p">[[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span><span class="s1">&#39;D_92&#39;</span><span class="p">]],</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;D_92&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">temp</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribución de D_92 según el target&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Target&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;D_92&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5c5b3d580a71bf57d4c85d968c791b12ccec199e6aa6e4c090ef004793b1562c.png" src="_images/5c5b3d580a71bf57d4c85d968c791b12ccec199e6aa6e4c090ef004793b1562c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">)[</span><span class="s1">&#39;D_92&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>target</th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4.153582e+06</td>
      <td>1.377869e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.159931e-01</td>
      <td>1.573589e-02</td>
    </tr>
    <tr>
      <th>std</th>
      <td>3.289231e-01</td>
      <td>1.114235e-01</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2.088378e-09</td>
      <td>1.973984e-08</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.794622e-03</td>
      <td>2.525871e-03</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>5.592227e-03</td>
      <td>5.052954e-03</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>8.390171e-03</td>
      <td>7.576226e-03</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.010000e+00</td>
      <td>2.009996e+00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mf">2.009996</span> <span class="o">-</span> <span class="mf">2.010000</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-3.9999999996709334e-06
</pre></div>
</div>
</div>
</div>
<p>Del <code class="docutils literal notranslate"><span class="pre">describe()</span></code> y gráfica de ambos conjuntos de datos se puede observar una diferencia entre la proporción de clases, la clase 0 tiene más de cuatro millones de observaciones mientras que la clase 0 solo cuenta con menos de millón y medio de observaciones, esto refuerza la idea de que estamos tratando con un problema desbalanceado. La media de aquellos clientes de la clase 0, es decir, los que no incurrieron en impago es mayor para aquellos que sí incurrieron en impagos, es decir, para esta variable asociada a delincuencia parece que los usuarios cque sí pagaron tienen un valor mayor en ella. La desviación estándar en el grupo de pagos es mayor, es decir, esta variable oresenta una mayor dispersión, en cambio la de impago (1) tiene sus valores más concentrados alrededor de la media. En cuanto a los percentiles, realmente se distribuyen de manera muy similar, en rangos inferiores, lo mismo sucede con los valores mínimos y máximos, teniendo incluso practicamente el mismo valor máximo en ambas clases con una diferencia inferior a 0.000004.</p>
</section>
<section id="seleccion-de-variables-numericas-para-correlacion">
<h2>Selección de variables numéricas para correlación<a class="headerlink" href="#seleccion-de-variables-numericas-para-correlacion" title="Link to this heading">#</a></h2>
<p>Debido a la gran cantidad de variables numéricas presentes en el dataset, se realizó una selección aleatoria de variables numéricas para revisar la correlación entre ellas, estas corresponden a las siguientes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Resultado obtenido más adelante</span>

<span class="n">numeric_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;P_2&#39;</span><span class="p">,</span> <span class="s1">&#39;D_39&#39;</span><span class="p">,</span> <span class="s1">&#39;B_1&#39;</span><span class="p">,</span> <span class="s1">&#39;B_2&#39;</span><span class="p">,</span> <span class="s1">&#39;R_1&#39;</span><span class="p">,</span> <span class="s1">&#39;S_3&#39;</span><span class="p">,</span> <span class="s1">&#39;D_41&#39;</span><span class="p">,</span> <span class="s1">&#39;B_3&#39;</span><span class="p">,</span> <span class="s1">&#39;D_43&#39;</span><span class="p">,</span> <span class="s1">&#39;D_44&#39;</span><span class="p">,</span> <span class="s1">&#39;B_4&#39;</span><span class="p">,</span> <span class="s1">&#39;D_45&#39;</span><span class="p">,</span> <span class="s1">&#39;B_5&#39;</span><span class="p">,</span> <span class="s1">&#39;R_2&#39;</span><span class="p">,</span> <span class="s1">&#39;D_46&#39;</span><span class="p">,</span> <span class="s1">&#39;D_47&#39;</span><span class="p">,</span> <span class="s1">&#39;D_48&#39;</span><span class="p">,</span> <span class="s1">&#39;B_6&#39;</span><span class="p">,</span> <span class="s1">&#39;B_7&#39;</span><span class="p">,</span> <span class="s1">&#39;B_8&#39;</span><span class="p">,</span> <span class="s1">&#39;D_51&#39;</span><span class="p">,</span> <span class="s1">&#39;B_9&#39;</span><span class="p">,</span> <span class="s1">&#39;R_3&#39;</span><span class="p">,</span> <span class="s1">&#39;D_52&#39;</span><span class="p">,</span> <span class="s1">&#39;P_3&#39;</span><span class="p">,</span> <span class="s1">&#39;B_10&#39;</span><span class="p">,</span> <span class="s1">&#39;S_5&#39;</span><span class="p">,</span> <span class="s1">&#39;B_11&#39;</span><span class="p">,</span> <span class="s1">&#39;S_6&#39;</span><span class="p">,</span> <span class="s1">&#39;D_54&#39;</span><span class="p">,</span> <span class="s1">&#39;R_4&#39;</span><span class="p">,</span> <span class="s1">&#39;S_7&#39;</span><span class="p">,</span> <span class="s1">&#39;B_12&#39;</span><span class="p">,</span> <span class="s1">&#39;S_8&#39;</span><span class="p">,</span> <span class="s1">&#39;D_55&#39;</span><span class="p">,</span> <span class="s1">&#39;B_13&#39;</span><span class="p">,</span> <span class="s1">&#39;R_5&#39;</span><span class="p">,</span> <span class="s1">&#39;D_58&#39;</span><span class="p">,</span> <span class="s1">&#39;B_14&#39;</span><span class="p">,</span> <span class="s1">&#39;D_59&#39;</span><span class="p">,</span> <span class="s1">&#39;D_60&#39;</span><span class="p">,</span> <span class="s1">&#39;D_61&#39;</span><span class="p">,</span> <span class="s1">&#39;B_15&#39;</span><span class="p">,</span> <span class="s1">&#39;S_11&#39;</span><span class="p">,</span> <span class="s1">&#39;D_62&#39;</span><span class="p">,</span> <span class="s1">&#39;D_65&#39;</span><span class="p">,</span> <span class="s1">&#39;B_16&#39;</span><span class="p">,</span> <span class="s1">&#39;B_18&#39;</span><span class="p">,</span> <span class="s1">&#39;B_19&#39;</span><span class="p">,</span> <span class="s1">&#39;B_20&#39;</span><span class="p">,</span> <span class="s1">&#39;S_12&#39;</span><span class="p">,</span> <span class="s1">&#39;R_6&#39;</span><span class="p">,</span> <span class="s1">&#39;S_13&#39;</span><span class="p">,</span> <span class="s1">&#39;B_21&#39;</span><span class="p">,</span> <span class="s1">&#39;D_69&#39;</span><span class="p">,</span> <span class="s1">&#39;B_22&#39;</span><span class="p">,</span> <span class="s1">&#39;D_70&#39;</span><span class="p">,</span> <span class="s1">&#39;D_71&#39;</span><span class="p">,</span> <span class="s1">&#39;D_72&#39;</span><span class="p">,</span> <span class="s1">&#39;S_15&#39;</span><span class="p">,</span> <span class="s1">&#39;B_23&#39;</span><span class="p">,</span> <span class="s1">&#39;P_4&#39;</span><span class="p">,</span> <span class="s1">&#39;D_74&#39;</span><span class="p">,</span> <span class="s1">&#39;D_75&#39;</span><span class="p">,</span> <span class="s1">&#39;B_24&#39;</span><span class="p">,</span> <span class="s1">&#39;R_7&#39;</span><span class="p">,</span> <span class="s1">&#39;D_77&#39;</span><span class="p">,</span> <span class="s1">&#39;B_25&#39;</span><span class="p">,</span> <span class="s1">&#39;B_26&#39;</span><span class="p">,</span> <span class="s1">&#39;D_78&#39;</span><span class="p">,</span> <span class="s1">&#39;D_79&#39;</span><span class="p">,</span> <span class="s1">&#39;R_8&#39;</span><span class="p">,</span> <span class="s1">&#39;S_16&#39;</span><span class="p">,</span> <span class="s1">&#39;D_80&#39;</span><span class="p">,</span> <span class="s1">&#39;R_10&#39;</span><span class="p">,</span> <span class="s1">&#39;R_11&#39;</span><span class="p">,</span> <span class="s1">&#39;B_27&#39;</span><span class="p">,</span> <span class="s1">&#39;D_81&#39;</span><span class="p">,</span> <span class="s1">&#39;S_17&#39;</span><span class="p">,</span> <span class="s1">&#39;R_12&#39;</span><span class="p">,</span> <span class="s1">&#39;B_28&#39;</span><span class="p">,</span> <span class="s1">&#39;R_13&#39;</span><span class="p">,</span> <span class="s1">&#39;D_83&#39;</span><span class="p">,</span> <span class="s1">&#39;R_14&#39;</span><span class="p">,</span> <span class="s1">&#39;R_15&#39;</span><span class="p">,</span> <span class="s1">&#39;D_84&#39;</span><span class="p">,</span> <span class="s1">&#39;R_16&#39;</span><span class="p">,</span> <span class="s1">&#39;S_18&#39;</span><span class="p">,</span> <span class="s1">&#39;D_86&#39;</span><span class="p">,</span> <span class="s1">&#39;R_17&#39;</span><span class="p">,</span> <span class="s1">&#39;R_18&#39;</span><span class="p">,</span> <span class="s1">&#39;B_31&#39;</span><span class="p">,</span> <span class="s1">&#39;S_19&#39;</span><span class="p">,</span> <span class="s1">&#39;R_19&#39;</span><span class="p">,</span> <span class="s1">&#39;B_32&#39;</span><span class="p">,</span> <span class="s1">&#39;S_20&#39;</span><span class="p">,</span> <span class="s1">&#39;R_20&#39;</span><span class="p">,</span> <span class="s1">&#39;R_21&#39;</span><span class="p">,</span> <span class="s1">&#39;B_33&#39;</span><span class="p">,</span> <span class="s1">&#39;D_89&#39;</span><span class="p">,</span> <span class="s1">&#39;R_22&#39;</span><span class="p">,</span> <span class="s1">&#39;R_23&#39;</span><span class="p">,</span> <span class="s1">&#39;D_91&#39;</span><span class="p">,</span> <span class="s1">&#39;D_92&#39;</span><span class="p">,</span> <span class="s1">&#39;D_93&#39;</span><span class="p">,</span> <span class="s1">&#39;D_94&#39;</span><span class="p">,</span> <span class="s1">&#39;R_24&#39;</span><span class="p">,</span> <span class="s1">&#39;R_25&#39;</span><span class="p">,</span> <span class="s1">&#39;D_96&#39;</span><span class="p">,</span> <span class="s1">&#39;S_22&#39;</span><span class="p">,</span> <span class="s1">&#39;S_23&#39;</span><span class="p">,</span> <span class="s1">&#39;S_24&#39;</span><span class="p">,</span> <span class="s1">&#39;S_25&#39;</span><span class="p">,</span> <span class="s1">&#39;S_26&#39;</span><span class="p">,</span> <span class="s1">&#39;D_102&#39;</span><span class="p">,</span> <span class="s1">&#39;D_103&#39;</span><span class="p">,</span> <span class="s1">&#39;D_104&#39;</span><span class="p">,</span> <span class="s1">&#39;D_107&#39;</span><span class="p">,</span> <span class="s1">&#39;B_36&#39;</span><span class="p">,</span> <span class="s1">&#39;B_37&#39;</span><span class="p">,</span> <span class="s1">&#39;R_27&#39;</span><span class="p">,</span> <span class="s1">&#39;D_109&#39;</span><span class="p">,</span> <span class="s1">&#39;D_112&#39;</span><span class="p">,</span> <span class="s1">&#39;B_40&#39;</span><span class="p">,</span> <span class="s1">&#39;S_27&#39;</span><span class="p">,</span> <span class="s1">&#39;D_113&#39;</span><span class="p">,</span> <span class="s1">&#39;D_115&#39;</span><span class="p">,</span> <span class="s1">&#39;D_118&#39;</span><span class="p">,</span> <span class="s1">&#39;D_119&#39;</span><span class="p">,</span> <span class="s1">&#39;D_121&#39;</span><span class="p">,</span> <span class="s1">&#39;D_122&#39;</span><span class="p">,</span> <span class="s1">&#39;D_123&#39;</span><span class="p">,</span> <span class="s1">&#39;D_124&#39;</span><span class="p">,</span> <span class="s1">&#39;D_125&#39;</span><span class="p">,</span> <span class="s1">&#39;D_127&#39;</span><span class="p">,</span> <span class="s1">&#39;D_128&#39;</span><span class="p">,</span> <span class="s1">&#39;D_129&#39;</span><span class="p">,</span> <span class="s1">&#39;B_41&#39;</span><span class="p">,</span> <span class="s1">&#39;D_130&#39;</span><span class="p">,</span> <span class="s1">&#39;D_131&#39;</span><span class="p">,</span> <span class="s1">&#39;D_133&#39;</span><span class="p">,</span> <span class="s1">&#39;R_28&#39;</span><span class="p">,</span> <span class="s1">&#39;D_139&#39;</span><span class="p">,</span> <span class="s1">&#39;D_140&#39;</span><span class="p">,</span> <span class="s1">&#39;D_141&#39;</span><span class="p">,</span> <span class="s1">&#39;D_143&#39;</span><span class="p">,</span> <span class="s1">&#39;D_144&#39;</span><span class="p">,</span> <span class="s1">&#39;D_145&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rnc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">numeric_cols</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">rnc</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rnc</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;D_43&#39;</span><span class="p">,</span> <span class="s1">&#39;D_55&#39;</span><span class="p">,</span> <span class="s1">&#39;R_19&#39;</span><span class="p">,</span> <span class="s1">&#39;R_6&#39;</span><span class="p">,</span> <span class="s1">&#39;R_3&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="n">rnc</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/eb4750be33147ee55cfe5a028e3b21cc9d870e717501a9559554f9352fdd0a57.png" src="_images/eb4750be33147ee55cfe5a028e3b21cc9d870e717501a9559554f9352fdd0a57.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cm</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="n">rnc</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Correlación&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Matriz de Correlación&#39;)
</pre></div>
</div>
<img alt="_images/ca20a861afc501fcd63edbf46951039bf2fb3c83436db0fb6bcb5f81a0520f2b.png" src="_images/ca20a861afc501fcd63edbf46951039bf2fb3c83436db0fb6bcb5f81a0520f2b.png" />
</div>
</div>
<p>Realmente no se aprecia ningún tipo de correlación entre la gran mayoría de variables expuestas en la matriz de scatterplot, las únicas variables en  las que se observa la existencia de cierta correlación son las variables de <code class="docutils literal notranslate"><span class="pre">D_43</span></code> y <code class="docutils literal notranslate"><span class="pre">R_3</span></code>, que confirmado con la matriz de correlación asociada a las mismas variables se encuentra un coeficiente de correlación de 0.69, más levemente con un coeficiente de correlación de 0.26 se encuentran las variables <code class="docutils literal notranslate"><span class="pre">D_55</span></code> y <code class="docutils literal notranslate"><span class="pre">R_19</span></code>. Respecto al resto, realmente no superan siquiera el 0.2.</p>
</section>
<section id="d-43-y-r-3">
<h2><code class="docutils literal notranslate"><span class="pre">D_43</span></code> y <code class="docutils literal notranslate"><span class="pre">R_3</span></code><a class="headerlink" href="#d-43-y-r-3" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;D_43&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;D_43&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_3&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;R_3&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histogramas de D_43 y R_3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Valor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/67b7bd406d006e7186e874ed7468f0ccf3f5b5bdd7d65850408998241fe33142.png" src="_images/67b7bd406d006e7186e874ed7468f0ccf3f5b5bdd7d65850408998241fe33142.png" />
</div>
</div>
<p>En el histograma superpuesto se puede ver como todos los datos de <code class="docutils literal notranslate"><span class="pre">D_43</span></code> se ven asolapados con los datos de <code class="docutils literal notranslate"><span class="pre">R_3</span></code>, ambas variables parecen tener distribuciones muy similares.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;D_43&#39;</span><span class="p">],</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_3&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scatterplot de D_43 vs R_3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;D_43&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;R_3&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;R_3&#39;)
</pre></div>
</div>
<img alt="_images/e5cfa85e1c9436889ba03a5b069057fc178bdcfbcfb510ed9f6b2bd4514e31df.png" src="_images/e5cfa85e1c9436889ba03a5b069057fc178bdcfbcfb510ed9f6b2bd4514e31df.png" />
</div>
</div>
<p>Este diagrama de dispersión ya visto anteriormente en la matriz, demuestra esa considerable correlación positiva entre ambas variables.</p>
</section>
<section id="d-55-y-r-19">
<h2><code class="docutils literal notranslate"><span class="pre">D_55</span></code> y <code class="docutils literal notranslate"><span class="pre">R_19</span></code><a class="headerlink" href="#d-55-y-r-19" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;D_55&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;D_55&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_19&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;R_19&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histogramas de D_55 y R_19&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Valor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0d568983d5349ea35744162e920cf234656e1f7420a815debccc721972328403.png" src="_images/0d568983d5349ea35744162e920cf234656e1f7420a815debccc721972328403.png" />
</div>
</div>
<p>A diferencia de lo visto con las dos variables anteriores, acá no se aprecia ese asolapamiento ebntre ambas variables, no se puede decir nada del comportamiento de ambas conjuntamente, claramente no tienen la misma distribución más que hay un decrecimiento en ambas a medida que aumenta el valor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;D_55&#39;</span><span class="p">],</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_19&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scatterplot de D_55 vs R_19&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;D_55&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;R_19&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;R_19&#39;)
</pre></div>
</div>
<img alt="_images/9cbb5f8f2d29f586cfd91d0ef6c8d4f82521440d18d4573189205dd57408d851.png" src="_images/9cbb5f8f2d29f586cfd91d0ef6c8d4f82521440d18d4573189205dd57408d851.png" />
</div>
</div>
<p>La interpretación al diagrama de dispersión debido al tipo de variable de <code class="docutils literal notranslate"><span class="pre">R_19</span></code>, al tener solamente dos valores, podría ser un poco complicado. Se observa que cuando <code class="docutils literal notranslate"><span class="pre">R_19</span></code> es 0, el rango de valores de <code class="docutils literal notranslate"><span class="pre">D_55</span></code> aumenta, y cuando es 1,  el rango de valores de <code class="docutils literal notranslate"><span class="pre">D_55</span></code> disminuye levemente.</p>
</section>
<section id="p-2-p-3-y-p-4">
<h2><code class="docutils literal notranslate"><span class="pre">P_2</span></code>, <code class="docutils literal notranslate"><span class="pre">P_3</span></code> y <code class="docutils literal notranslate"><span class="pre">P_4</span></code><a class="headerlink" href="#p-2-p-3-y-p-4" title="Link to this heading">#</a></h2>
<p>Estas variables son las asociadas a pagos. Se verá si existe una correlación entre ellas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">train_data</span><span class="p">[[</span><span class="s1">&#39;P_2&#39;</span><span class="p">,</span> <span class="s1">&#39;P_3&#39;</span><span class="p">,</span> <span class="s1">&#39;P_4&#39;</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c0c54e35356bcd920ee2475204f3a7ea365cb49a2e095ae28ebca910063cbb9c.png" src="_images/c0c54e35356bcd920ee2475204f3a7ea365cb49a2e095ae28ebca910063cbb9c.png" />
</div>
</div>
<p>La distribución de valores tanto de <code class="docutils literal notranslate"><span class="pre">P_2</span></code> y <code class="docutils literal notranslate"><span class="pre">P_3</span></code> respecto a <code class="docutils literal notranslate"><span class="pre">P_4</span></code> es muy similar y bastante extraña. La distribución entre <code class="docutils literal notranslate"><span class="pre">P_2</span></code> y <code class="docutils literal notranslate"><span class="pre">P_3</span></code> demuestra cierta correlación positiva entrE ellas, que si bien podría no ser muy alta, existe. Esto se comprobará al realizar la matriz de correlación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cm</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[[</span><span class="s1">&#39;P_2&#39;</span><span class="p">,</span> <span class="s1">&#39;P_3&#39;</span><span class="p">,</span> <span class="s1">&#39;P_4&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Correlación&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Matriz de Correlación&#39;)
</pre></div>
</div>
<img alt="_images/b6ce18bfa37981631c6efd222f31ef3aec997d71b012bbfeb41d550e4b4079a1.png" src="_images/b6ce18bfa37981631c6efd222f31ef3aec997d71b012bbfeb41d550e4b4079a1.png" />
</div>
</div>
<p>Como era esperado, existe una correlación positiva, no muy alta, entre <code class="docutils literal notranslate"><span class="pre">P_2</span></code> y <code class="docutils literal notranslate"><span class="pre">P_3</span></code> de 0.4. Entre las otras variables realmente se encuentra una correlación bastante baja, esperada también por esa falta de linealñidad observada en la matriz de diagramas de dispersión.</p>
<section id="p-2-y-p-3">
<h3><code class="docutils literal notranslate"><span class="pre">P_2</span></code> y <code class="docutils literal notranslate"><span class="pre">P_3</span></code><a class="headerlink" href="#p-2-y-p-3" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;P_2&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;P_2&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;P_3&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;P_3&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histogramas de P_2 y P_3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Valor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e34e8de225b6d7eea0ecac6434c70540d51423cb10465b50131c9d6b1bab5f2e.png" src="_images/e34e8de225b6d7eea0ecac6434c70540d51423cb10465b50131c9d6b1bab5f2e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;P_2&#39;</span><span class="p">],</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;P_3&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scatterplot de P_2 vs P_3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;P_2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;P_3&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;P_3&#39;)
</pre></div>
</div>
<img alt="_images/2093a81ed0f4a56b31da1313655001763a13e1b189a7579e9ec8e9ba4f832481.png" src="_images/2093a81ed0f4a56b31da1313655001763a13e1b189a7579e9ec8e9ba4f832481.png" />
</div>
</div>
<p>En el diagrama superpuesto, se aprecia que ambas distribuciones no son parecidas, también si se observa en el diagrama de dispersión, ambas oscilan entre valores diferentes: <code class="docutils literal notranslate"><span class="pre">P_2</span></code> entre -0.4 y 1 y <code class="docutils literal notranslate"><span class="pre">P_3</span></code> entre -1.5 a 2.5.</p>
</section>
</section>
<section id="variables-de-riesgo">
<h2>Variables de riesgo<a class="headerlink" href="#variables-de-riesgo" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cm</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[[</span><span class="s1">&#39;R_1&#39;</span><span class="p">,</span> <span class="s1">&#39;R_2&#39;</span><span class="p">,</span> <span class="s1">&#39;R_3&#39;</span><span class="p">,</span> <span class="s1">&#39;R_4&#39;</span><span class="p">,</span> <span class="s1">&#39;R_5&#39;</span><span class="p">,</span> <span class="s1">&#39;R_6&#39;</span><span class="p">,</span> <span class="s1">&#39;R_7&#39;</span><span class="p">,</span> <span class="s1">&#39;R_8&#39;</span><span class="p">,</span> <span class="s1">&#39;R_9&#39;</span><span class="p">,</span> <span class="s1">&#39;R_10&#39;</span><span class="p">,</span> <span class="s1">&#39;R_11&#39;</span><span class="p">,</span> <span class="s1">&#39;R_12&#39;</span><span class="p">,</span> <span class="s1">&#39;R_13&#39;</span><span class="p">,</span> <span class="s1">&#39;R_14&#39;</span><span class="p">,</span> <span class="s1">&#39;R_15&#39;</span><span class="p">,</span> <span class="s1">&#39;R_16&#39;</span><span class="p">,</span> <span class="s1">&#39;R_17&#39;</span><span class="p">,</span> <span class="s1">&#39;R_18&#39;</span><span class="p">,</span> <span class="s1">&#39;R_19&#39;</span><span class="p">,</span> <span class="s1">&#39;R_20&#39;</span><span class="p">,</span> <span class="s1">&#39;R_21&#39;</span><span class="p">,</span> <span class="s1">&#39;R_22&#39;</span><span class="p">,</span> <span class="s1">&#39;R_23&#39;</span><span class="p">,</span> <span class="s1">&#39;R_24&#39;</span><span class="p">,</span> <span class="s1">&#39;R_25&#39;</span><span class="p">,</span> <span class="s1">&#39;R_26&#39;</span><span class="p">,</span> <span class="s1">&#39;R_27&#39;</span><span class="p">,</span> <span class="s1">&#39;R_28&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Correlación&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Matriz de Correlación&#39;)
</pre></div>
</div>
<img alt="_images/9f4f03b8db4c97d83ec48bab88d914c82a6e22eb52a28f59f44856688e5d760d.png" src="_images/9f4f03b8db4c97d83ec48bab88d914c82a6e22eb52a28f59f44856688e5d760d.png" />
</div>
</div>
<p>Se observan correlaciones más fuertes en las primeras variables de riesgo, por lo que para un mejor análisis se limitarán a las primeras 10 variables de riesgo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cm</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="n">temp</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Correlación&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Matriz de Correlación&#39;)
</pre></div>
</div>
<img alt="_images/e5398e8c076315c0d0ef380ecc559263c6690d26b3d421725032da7e4213ae35.png" src="_images/e5398e8c076315c0d0ef380ecc559263c6690d26b3d421725032da7e4213ae35.png" />
</div>
</div>
<p>Aquellas variables que presentan mayor correlación son <code class="docutils literal notranslate"><span class="pre">R_8</span></code> - <code class="docutils literal notranslate"><span class="pre">R_5</span></code> (0.79), <code class="docutils literal notranslate"><span class="pre">R_4</span></code> - <code class="docutils literal notranslate"><span class="pre">R_2</span></code> (0.78) y  <code class="docutils literal notranslate"><span class="pre">R_5</span></code> y <code class="docutils literal notranslate"><span class="pre">R_4</span></code> (0.67), lo que llevaría a esperar que <code class="docutils literal notranslate"><span class="pre">R_2</span></code> y <code class="docutils literal notranslate"><span class="pre">R_5</span></code> estén también significativamente correlacionadas. Dentro de este conjunto de variables también hay otras que se encuentran correlacionadas pero ya entre 0.52 y 0.64. Del resto de variables, no se puede decir que existan correlaciones altas entre ellas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;R_2&#39;</span><span class="p">,</span> <span class="s1">&#39;R_4&#39;</span><span class="p">,</span> <span class="s1">&#39;R_5&#39;</span><span class="p">,</span> <span class="s1">&#39;R_8&#39;</span><span class="p">]</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="n">temp</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1ffab9ed5e6dd899412b585701794f76104cdcf58113a27d19edd9b0e9d3a527.png" src="_images/1ffab9ed5e6dd899412b585701794f76104cdcf58113a27d19edd9b0e9d3a527.png" />
</div>
</div>
<p>Más adelante se interpretará el elemento de la matriz que sea necesario individualmente según elr esultado de la matriz de correlación.</p>
<section id="r-8-y-r-5">
<h3><code class="docutils literal notranslate"><span class="pre">R_8</span></code> y <code class="docutils literal notranslate"><span class="pre">R_5</span></code><a class="headerlink" href="#r-8-y-r-5" title="Link to this heading">#</a></h3>
<p>Estas dos variables cuentan con un coeficiende de correlaciónde 0.79, el más alto entre las variables de riesgo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="p">[[</span><span class="s1">&#39;R_8&#39;</span><span class="p">,</span> <span class="s1">&#39;R_5&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R_8</th>
      <th>R_5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5.531451e+06</td>
      <td>5.531451e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.812034e-02</td>
      <td>3.459403e-02</td>
    </tr>
    <tr>
      <th>std</th>
      <td>3.036416e-01</td>
      <td>2.568067e-01</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.738091e-09</td>
      <td>1.154589e-09</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.553690e-03</td>
      <td>2.575087e-03</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>5.105827e-03</td>
      <td>5.149018e-03</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>7.657797e-03</td>
      <td>7.721870e-03</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.800808e+01</td>
      <td>3.500452e+01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Al revisar el resumen estadísitoc, se observa que ambas variables son bastante similares. Sus medias son cercanas, de 0.0381 para <code class="docutils literal notranslate"><span class="pre">R_8</span></code> y 0.0346 para <code class="docutils literal notranslate"><span class="pre">R_5</span></code>. De igual manera, los cuartiles muestran que ambos conjuntos de datos tienen una distribución relativamente similar, aunque <code class="docutils literal notranslate"><span class="pre">R_8</span></code> tiende a ser ligeramente más alto en cada cuartil. Los valoers mínimos, máximos y desviación estándar tampoco difieren mucho. Se esperaría una distribución similar en el histograma superpuesto. Hay una grand iferencia entre el percentil 75 y el valor máximo, lo que sugiere un gran porcentaje de datos atípicos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_8&#39;</span><span class="p">],</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_5&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Scatterplot de R_8 vs R_5&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;R_8&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;R_5&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_8&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;R_8&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_5&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;R_5&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Histogramas de R_8 y R_5&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Valor&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0b24d00adeec52786c6af2e40c94c3322d703e7b53d5e07c40f47aa8172fcc10.png" src="_images/0b24d00adeec52786c6af2e40c94c3322d703e7b53d5e07c40f47aa8172fcc10.png" />
</div>
</div>
<p>Se puede notar esa correlación de casi 0.8, incluso hay una línea bastante clara sobre la que reposan los valores de <code class="docutils literal notranslate"><span class="pre">R_5</span></code> según <code class="docutils literal notranslate"><span class="pre">R_8</span></code>, a mayor valor de <code class="docutils literal notranslate"><span class="pre">R_8</span></code>, más alto es el rango de valores para <code class="docutils literal notranslate"><span class="pre">R_5</span></code>. Tal como se esperaba del resumen estadístico, ambas  variables tienen una distribución bastante similar, donde casi que sus histogramas se superponen completamente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_8&#39;</span><span class="p">],</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_5&#39;</span><span class="p">]],</span> <span class="n">tick_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;R_8&#39;</span><span class="p">,</span> <span class="s1">&#39;R_5&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Boxplot bivariado de R_8 y R_5&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Variable&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Valor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1bdd3ab0e0539679f8bdaaa8c0676866ade5927f9aadd675bf5eb1a9bf04a58b.png" src="_images/1bdd3ab0e0539679f8bdaaa8c0676866ade5927f9aadd675bf5eb1a9bf04a58b.png" />
</div>
</div>
<p>Se nota la presencia de muchos datos atípicos, tal como se esperaba debido al resumen estadístico.</p>
</section>
<section id="r-4-y-r-2">
<h3><code class="docutils literal notranslate"><span class="pre">R_4</span></code> y <code class="docutils literal notranslate"><span class="pre">R_2</span></code><a class="headerlink" href="#r-4-y-r-2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="p">[[</span><span class="s1">&#39;R_4&#39;</span><span class="p">,</span> <span class="s1">&#39;R_2&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R_4</th>
      <th>R_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5.531451e+06</td>
      <td>5.531451e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.120413e-02</td>
      <td>4.751791e-02</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.597703e-01</td>
      <td>2.017843e-01</td>
    </tr>
    <tr>
      <th>min</th>
      <td>4.024685e-10</td>
      <td>8.265748e-10</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.565921e-03</td>
      <td>2.613008e-03</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>5.132659e-03</td>
      <td>5.223076e-03</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>7.700315e-03</td>
      <td>7.837339e-03</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.010000e+00</td>
      <td>1.010000e+00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Al analizar el resumen estadístico de las variables <code class="docutils literal notranslate"><span class="pre">R_4</span></code> y <code class="docutils literal notranslate"><span class="pre">R_2</span></code>, se observa que <code class="docutils literal notranslate"><span class="pre">R_2</span></code> tiende a tener valores más altos en promedio: la media de <code class="docutils literal notranslate"><span class="pre">R_4</span></code> (0.0312) es significativamente menor que la de <code class="docutils literal notranslate"><span class="pre">R_2</span></code> (0.0475). Ambas variables tienen valores mínimos muy bajos, casi ceros, y un máximo de 1.01. Los cuartiles muestran que R_2 tiende a ser ligeramente más alto en cada punto, reforzando la observación de sus valores generalmente más altos. La notable diferencia entre el percentil 75 y el valor máximo sugiere la presencia de un porcentaje significativo de datos atípicos en ambas variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_4&#39;</span><span class="p">],</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_2&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Scatterplot de R_4 vs R_2&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;R_4&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;R_2&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_4&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;R_4&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_2&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;R_2&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Histogramas de R_4 y R_2&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Valor&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d2c7e03d69e3f7ab48c25f3f58f0a43848073f24737f5fb7d51b56e02f057ed5.png" src="_images/d2c7e03d69e3f7ab48c25f3f58f0a43848073f24737f5fb7d51b56e02f057ed5.png" />
</div>
</div>
<p>La distribución del scatter plot llama bastante la atención, revelando que los registros se encuentran como <code class="docutils literal notranslate"><span class="pre">R_2</span></code> y <code class="docutils literal notranslate"><span class="pre">R_4</span></code> llegando a ser casi 0, o con <code class="docutils literal notranslate"><span class="pre">R_4</span></code> siendo casi 0 y <code class="docutils literal notranslate"><span class="pre">R_2</span></code> 1 aproximadamente o ambos siendo aproximadamente 1, se encuentran bastante concentrados en las esquinas del gráfico con muy poca variación entre los grupos. En el histograma ambas variables siguen la misma distribución, habiendo más registros con <code class="docutils literal notranslate"><span class="pre">R_4</span></code> cerca de 0 (esperado debido a las dos aglomeraciones de puntos observada en el scatter plot) y <code class="docutils literal notranslate"><span class="pre">R_2</span></code> son más datos cercanos a 1 que <code class="docutils literal notranslate"><span class="pre">R_4</span></code> también esperado debido a los dos conjuntos de puntos observados en la parte superior del diagrama de dispersión.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_2&#39;</span><span class="p">],</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_4&#39;</span><span class="p">]],</span> <span class="n">tick_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;R_2&#39;</span><span class="p">,</span> <span class="s1">&#39;R_4&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Boxplot bivariado de R_2 y R_4&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Variable&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Valor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1a5b1e48b1b64df569913033ae334ff8c60bd389331606535cdd25f3c9ffe406.png" src="_images/1a5b1e48b1b64df569913033ae334ff8c60bd389331606535cdd25f3c9ffe406.png" />
</div>
</div>
<p>Esta distribución en el boxplot también era esperada debido a la ausencia de valores intermedios en las gráficas superiores.</p>
</section>
<section id="r-5-y-r-4">
<h3><code class="docutils literal notranslate"><span class="pre">R_5</span></code> y <code class="docutils literal notranslate"><span class="pre">R_4</span></code><a class="headerlink" href="#r-5-y-r-4" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="p">[[</span><span class="s1">&#39;R_5&#39;</span><span class="p">,</span> <span class="s1">&#39;R_4&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R_5</th>
      <th>R_4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5.531451e+06</td>
      <td>5.531451e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.459403e-02</td>
      <td>3.120413e-02</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.568067e-01</td>
      <td>1.597703e-01</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.154589e-09</td>
      <td>4.024685e-10</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.575087e-03</td>
      <td>2.565921e-03</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>5.149018e-03</td>
      <td>5.132659e-03</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>7.721870e-03</td>
      <td>7.700315e-03</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.500452e+01</td>
      <td>1.010000e+00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>La media de <code class="docutils literal notranslate"><span class="pre">R_5</span></code> es 0.0346, mientras que la de <code class="docutils literal notranslate"><span class="pre">R_4</span></code> es ligeramente inferior, de 0.0312. Las desviaciones estándar muestran que <code class="docutils literal notranslate"><span class="pre">R_5</span></code> tiene mayor dispersión (0.2568) en comparación con <code class="docutils literal notranslate"><span class="pre">R_4</span></code> (0.1598), lo que indica que los valores de <code class="docutils literal notranslate"><span class="pre">R_5</span></code> están más dispersos alrededor de su media. Los valores mínimos de ambas variables son extremadamente bajos, cercanos a cero, pero el valor máximo de <code class="docutils literal notranslate"><span class="pre">R_5</span></code> es extremadamente alto (35) comparado al 1.01 de <code class="docutils literal notranslate"><span class="pre">R_4</span></code>. En cuanto a los percentiles, el 25% de los datos se encuentra por debajo de 0.0026 en ambas columnas, el 50% (mediana) es de aproximadamente 0.0051, y el 75% se encuentra en torno a 0.0077, sugiriendo que la mayoría de los datos se agrupan en valores pequeños, salvo valores atípicos que se podrían encontrar en <code class="docutils literal notranslate"><span class="pre">R_5</span></code> debido a la diferencia entre el valor máximo y el percentil 75.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_4&#39;</span><span class="p">],</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_5&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Scatterplot de R_4 vs R_5&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;R_4&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;R_5&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_4&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;R_4&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_5&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;R_5&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Histogramas de R_4 y R_5&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Valor&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c97f1015180ea48d0c502fdcefb85a4b719aa6c9d10d227f87b397eb2720d57a.png" src="_images/c97f1015180ea48d0c502fdcefb85a4b719aa6c9d10d227f87b397eb2720d57a.png" />
</div>
</div>
<p>Realizar un histograma acá no es de mucha utilidad debido a la gran diferencia entre los rangos de las variables, mientras <code class="docutils literal notranslate"><span class="pre">R_4</span></code> va de 0 a 1, <code class="docutils literal notranslate"><span class="pre">R_5</span></code> va de 0 a 35, por tanto no se puede apreciar nada. Lo mismo sucede en el boxplot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_5&#39;</span><span class="p">],</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;R_4&#39;</span><span class="p">]],</span> <span class="n">tick_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;R_5&#39;</span><span class="p">,</span> <span class="s1">&#39;R_4&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Boxplot bivariado de R_5 y R_4&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Variable&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Valor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/997724bb3ac5392f25e1f8bcb24478a3b29d056042a5936939482c9b597c8939.png" src="_images/997724bb3ac5392f25e1f8bcb24478a3b29d056042a5936939482c9b597c8939.png" />
</div>
</div>
<p>Como s emencionaba, el análisis bivariado por boxplot no es un buen abordamiento debido a la presencia de valores extremos en una de las variables, <code class="docutils literal notranslate"><span class="pre">R_5</span></code>, los valores atípicos en <code class="docutils literal notranslate"><span class="pre">R_4</span></code> corresponden a aquellos cercanos a 1 que toma como atípicos.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="tratamientos-de-datos-faltantes-y-multicolinealidad">
<h1>Tratamientos de datos faltantes y multicolinealidad<a class="headerlink" href="#tratamientos-de-datos-faltantes-y-multicolinealidad" title="Link to this heading">#</a></h1>
<p>Variables delincuenciales: 96 - [‘D_39’, ‘D_41’, ‘D_42’, ‘D_43’, ‘D_44’, ‘D_45’, ‘D_46’, ‘D_47’, ‘D_48’, ‘D_49’, ‘D_50’, ‘D_51’, ‘D_52’, ‘D_53’, ‘D_54’, ‘D_55’, ‘D_56’, ‘D_58’, ‘D_59’, ‘D_60’, ‘D_61’, ‘D_62’, ‘D_63’, ‘D_64’, ‘D_65’, ‘D_66’, ‘D_68’, ‘D_69’, ‘D_70’, ‘D_71’, ‘D_72’, ‘D_73’, ‘D_74’, ‘D_75’, ‘D_76’, ‘D_77’, ‘D_78’, ‘D_79’, ‘D_80’, ‘D_81’, ‘D_82’, ‘D_83’, ‘D_84’, ‘D_86’, ‘D_87’, ‘D_88’, ‘D_89’, ‘D_91’, ‘D_92’, ‘D_93’, ‘D_94’, ‘D_96’, ‘D_102’, ‘D_103’, ‘D_104’, ‘D_105’, ‘D_106’, ‘D_107’, ‘D_108’, ‘D_109’, ‘D_110’, ‘D_111’, ‘D_112’, ‘D_113’, ‘D_114’, ‘D_115’, ‘D_116’, ‘D_117’, ‘D_118’, ‘D_119’, ‘D_120’, ‘D_121’, ‘D_122’, ‘D_123’, ‘D_124’, ‘D_125’, ‘D_126’, ‘D_127’, ‘D_128’, ‘D_129’, ‘D_130’, ‘D_131’, ‘D_132’, ‘D_133’, ‘D_134’, ‘D_135’, ‘D_136’, ‘D_137’, ‘D_138’, ‘D_139’, ‘D_140’, ‘D_141’, ‘D_142’, ‘D_143’, ‘D_144’, ‘D_145’]
Variables de gastos: 22 - [‘S_2’, ‘S_3’, ‘S_5’, ‘S_6’, ‘S_7’, ‘S_8’, ‘S_9’, ‘S_11’, ‘S_12’, ‘S_13’, ‘S_15’, ‘S_16’, ‘S_17’, ‘S_18’, ‘S_19’, ‘S_20’, ‘S_22’, ‘S_23’, ‘S_24’, ‘S_25’, ‘S_26’, ‘S_27’]
Variables de pagos: 3 - [‘P_2’, ‘P_3’, ‘P_4’]
Variables de balance: 40 - [‘B_1’, ‘B_2’, ‘B_3’, ‘B_4’, ‘B_5’, ‘B_6’, ‘B_7’, ‘B_8’, ‘B_9’, ‘B_10’, ‘B_11’, ‘B_12’, ‘B_13’, ‘B_14’, ‘B_15’, ‘B_16’, ‘B_17’, ‘B_18’, ‘B_19’, ‘B_20’, ‘B_21’, ‘B_22’, ‘B_23’, ‘B_24’, ‘B_25’, ‘B_26’, ‘B_27’, ‘B_28’, ‘B_29’, ‘B_30’, ‘B_31’, ‘B_32’, ‘B_33’, ‘B_36’, ‘B_37’, ‘B_38’, ‘B_39’, ‘B_40’, ‘B_41’, ‘B_42’]
Variables de riesgo: 28 - [‘R_1’, ‘R_2’, ‘R_3’, ‘R_4’, ‘R_5’, ‘R_6’, ‘R_7’, ‘R_8’, ‘R_9’, ‘R_10’, ‘R_11’, ‘R_12’, ‘R_13’, ‘R_14’, ‘R_15’, ‘R_16’, ‘R_17’, ‘R_18’, ‘R_19’, ‘R_20’, ‘R_21’, ‘R_22’, ‘R_23’, ‘R_24’, ‘R_25’, ‘R_26’, ‘R_27’, ‘R_28’]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">msno</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">train_data</span><span class="p">[[</span><span class="s1">&#39;S_2&#39;</span><span class="p">,</span> <span class="s1">&#39;S_3&#39;</span><span class="p">,</span> <span class="s1">&#39;S_5&#39;</span><span class="p">,</span> <span class="s1">&#39;S_6&#39;</span><span class="p">,</span> <span class="s1">&#39;S_7&#39;</span><span class="p">,</span> <span class="s1">&#39;S_8&#39;</span><span class="p">,</span> <span class="s1">&#39;S_9&#39;</span><span class="p">,</span> <span class="s1">&#39;S_11&#39;</span><span class="p">,</span> <span class="s1">&#39;S_12&#39;</span><span class="p">,</span> <span class="s1">&#39;S_13&#39;</span><span class="p">,</span> <span class="s1">&#39;S_15&#39;</span><span class="p">,</span> <span class="s1">&#39;S_16&#39;</span><span class="p">,</span> <span class="s1">&#39;S_17&#39;</span><span class="p">,</span> <span class="s1">&#39;S_18&#39;</span><span class="p">,</span> <span class="s1">&#39;S_19&#39;</span><span class="p">,</span> <span class="s1">&#39;S_20&#39;</span><span class="p">,</span> <span class="s1">&#39;S_22&#39;</span><span class="p">,</span> <span class="s1">&#39;S_23&#39;</span><span class="p">,</span> <span class="s1">&#39;S_24&#39;</span><span class="p">,</span> <span class="s1">&#39;S_25&#39;</span><span class="p">,</span> <span class="s1">&#39;S_26&#39;</span><span class="p">,</span> <span class="s1">&#39;S_27&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/b00eb85c106cc38f82aa0703553eea1bd72d7cc56f9d515e9bc7cb9b774d0248.png" src="_images/b00eb85c106cc38f82aa0703553eea1bd72d7cc56f9d515e9bc7cb9b774d0248.png" />
</div>
</div>
<p>En seis variables de gastos hay valores nulos. Parece que los datos faltantes en <code class="docutils literal notranslate"><span class="pre">S_3</span></code> y  <code class="docutils literal notranslate"><span class="pre">S_7</span></code> correspoden a los mismos registros, revisemos esto.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;S_3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">!=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;S_7&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.int64(0)
</pre></div>
</div>
</div>
</div>
<p>En efecto, dado que la suma de registros con valores distintos es 0, ambas variables comparten los mismos datos nulos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">msno</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">train_data</span><span class="p">[[</span><span class="s1">&#39;R_1&#39;</span><span class="p">,</span> <span class="s1">&#39;R_2&#39;</span><span class="p">,</span> <span class="s1">&#39;R_3&#39;</span><span class="p">,</span> <span class="s1">&#39;R_4&#39;</span><span class="p">,</span> <span class="s1">&#39;R_5&#39;</span><span class="p">,</span> <span class="s1">&#39;R_6&#39;</span><span class="p">,</span> <span class="s1">&#39;R_7&#39;</span><span class="p">,</span> <span class="s1">&#39;R_8&#39;</span><span class="p">,</span> <span class="s1">&#39;R_9&#39;</span><span class="p">,</span> <span class="s1">&#39;R_10&#39;</span><span class="p">,</span> <span class="s1">&#39;R_11&#39;</span><span class="p">,</span> <span class="s1">&#39;R_12&#39;</span><span class="p">,</span> <span class="s1">&#39;R_13&#39;</span><span class="p">,</span> <span class="s1">&#39;R_14&#39;</span><span class="p">,</span> <span class="s1">&#39;R_15&#39;</span><span class="p">,</span> <span class="s1">&#39;R_16&#39;</span><span class="p">,</span> <span class="s1">&#39;R_17&#39;</span><span class="p">,</span> <span class="s1">&#39;R_18&#39;</span><span class="p">,</span> <span class="s1">&#39;R_19&#39;</span><span class="p">,</span> <span class="s1">&#39;R_20&#39;</span><span class="p">,</span> <span class="s1">&#39;R_21&#39;</span><span class="p">,</span> <span class="s1">&#39;R_22&#39;</span><span class="p">,</span> <span class="s1">&#39;R_23&#39;</span><span class="p">,</span> <span class="s1">&#39;R_24&#39;</span><span class="p">,</span> <span class="s1">&#39;R_25&#39;</span><span class="p">,</span> <span class="s1">&#39;R_26&#39;</span><span class="p">,</span> <span class="s1">&#39;R_27&#39;</span><span class="p">,</span> <span class="s1">&#39;R_28&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/6abff1a467e0fdfe7fcc6dfa6078499c1466e79574592b87e0909e11879d7ea3.png" src="_images/6abff1a467e0fdfe7fcc6dfa6078499c1466e79574592b87e0909e11879d7ea3.png" />
</div>
</div>
<p>3 valores de riesgo cuentan con valores nulos, no se nota una conexión entre los valores faltantes. LLama la atención como <code class="docutils literal notranslate"><span class="pre">R_9</span></code> y <code class="docutils literal notranslate"><span class="pre">R_26</span></code> poseen en su gran mayoría datos faltantes, teniendo poco registros válidos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">msno</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">train_data</span><span class="p">[[</span><span class="s1">&#39;B_1&#39;</span><span class="p">,</span> <span class="s1">&#39;B_2&#39;</span><span class="p">,</span> <span class="s1">&#39;B_3&#39;</span><span class="p">,</span> <span class="s1">&#39;B_4&#39;</span><span class="p">,</span> <span class="s1">&#39;B_5&#39;</span><span class="p">,</span> <span class="s1">&#39;B_6&#39;</span><span class="p">,</span> <span class="s1">&#39;B_7&#39;</span><span class="p">,</span> <span class="s1">&#39;B_8&#39;</span><span class="p">,</span> <span class="s1">&#39;B_9&#39;</span><span class="p">,</span> <span class="s1">&#39;B_10&#39;</span><span class="p">,</span> <span class="s1">&#39;B_11&#39;</span><span class="p">,</span> <span class="s1">&#39;B_12&#39;</span><span class="p">,</span> <span class="s1">&#39;B_13&#39;</span><span class="p">,</span> <span class="s1">&#39;B_14&#39;</span><span class="p">,</span> <span class="s1">&#39;B_15&#39;</span><span class="p">,</span> <span class="s1">&#39;B_16&#39;</span><span class="p">,</span> <span class="s1">&#39;B_17&#39;</span><span class="p">,</span> <span class="s1">&#39;B_18&#39;</span><span class="p">,</span> <span class="s1">&#39;B_19&#39;</span><span class="p">,</span> <span class="s1">&#39;B_20&#39;</span><span class="p">,</span> <span class="s1">&#39;B_21&#39;</span><span class="p">,</span> <span class="s1">&#39;B_22&#39;</span><span class="p">,</span> <span class="s1">&#39;B_23&#39;</span><span class="p">,</span> <span class="s1">&#39;B_24&#39;</span><span class="p">,</span> <span class="s1">&#39;B_25&#39;</span><span class="p">,</span> <span class="s1">&#39;B_26&#39;</span><span class="p">,</span> <span class="s1">&#39;B_27&#39;</span><span class="p">,</span> <span class="s1">&#39;B_28&#39;</span><span class="p">,</span> <span class="s1">&#39;B_29&#39;</span><span class="p">,</span> <span class="s1">&#39;B_30&#39;</span><span class="p">,</span> <span class="s1">&#39;B_31&#39;</span><span class="p">,</span> <span class="s1">&#39;B_32&#39;</span><span class="p">,</span> <span class="s1">&#39;B_33&#39;</span><span class="p">,</span> <span class="s1">&#39;B_36&#39;</span><span class="p">,</span> <span class="s1">&#39;B_37&#39;</span><span class="p">,</span> <span class="s1">&#39;B_38&#39;</span><span class="p">,</span> <span class="s1">&#39;B_39&#39;</span><span class="p">,</span> <span class="s1">&#39;B_40&#39;</span><span class="p">,</span> <span class="s1">&#39;B_41&#39;</span><span class="p">,</span> <span class="s1">&#39;B_42&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/280f2536df9137272de5eaf1c5915759ce83bfac162f52b4223def2d7895b608.png" src="_images/280f2536df9137272de5eaf1c5915759ce83bfac162f52b4223def2d7895b608.png" />
</div>
</div>
<p>Variables como <code class="docutils literal notranslate"><span class="pre">B_17</span></code>, <code class="docutils literal notranslate"><span class="pre">B_29</span></code>, <code class="docutils literal notranslate"><span class="pre">B_39</span></code> y <code class="docutils literal notranslate"><span class="pre">B_42</span></code> en su mayoría son registros nulos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;B_22&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">!=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;B_16&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span> <span class="o">!=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;B_19&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.int64(2016)
</pre></div>
</div>
</div>
</div>
<p>Parece suceder algo similar que con el grupo anterior de variables y es que <code class="docutils literal notranslate"><span class="pre">B_16</span></code>, <code class="docutils literal notranslate"><span class="pre">B_19</span></code>, <code class="docutils literal notranslate"><span class="pre">B_20</span></code>, <code class="docutils literal notranslate"><span class="pre">B_22</span></code>, <code class="docutils literal notranslate"><span class="pre">B_26</span></code>, <code class="docutils literal notranslate"><span class="pre">B_27</span></code>, <code class="docutils literal notranslate"><span class="pre">B_30</span></code>, <code class="docutils literal notranslate"><span class="pre">B_33</span></code> y <code class="docutils literal notranslate"><span class="pre">B_38</span></code> parecen compartir los mismos datos faltantes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">msno</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">train_data</span><span class="p">[[</span><span class="s1">&#39;D_39&#39;</span><span class="p">,</span> <span class="s1">&#39;D_41&#39;</span><span class="p">,</span> <span class="s1">&#39;D_42&#39;</span><span class="p">,</span> <span class="s1">&#39;D_43&#39;</span><span class="p">,</span> <span class="s1">&#39;D_44&#39;</span><span class="p">,</span> <span class="s1">&#39;D_45&#39;</span><span class="p">,</span> <span class="s1">&#39;D_46&#39;</span><span class="p">,</span> <span class="s1">&#39;D_47&#39;</span><span class="p">,</span> <span class="s1">&#39;D_48&#39;</span><span class="p">,</span> <span class="s1">&#39;D_49&#39;</span><span class="p">,</span> <span class="s1">&#39;D_50&#39;</span><span class="p">,</span> <span class="s1">&#39;D_51&#39;</span><span class="p">,</span> <span class="s1">&#39;D_52&#39;</span><span class="p">,</span> <span class="s1">&#39;D_53&#39;</span><span class="p">,</span> <span class="s1">&#39;D_54&#39;</span><span class="p">,</span> <span class="s1">&#39;D_55&#39;</span><span class="p">,</span> <span class="s1">&#39;D_56&#39;</span><span class="p">,</span> <span class="s1">&#39;D_58&#39;</span><span class="p">,</span> <span class="s1">&#39;D_59&#39;</span><span class="p">,</span> <span class="s1">&#39;D_60&#39;</span><span class="p">,</span> <span class="s1">&#39;D_61&#39;</span><span class="p">,</span> <span class="s1">&#39;D_62&#39;</span><span class="p">,</span> <span class="s1">&#39;D_63&#39;</span><span class="p">,</span> <span class="s1">&#39;D_64&#39;</span><span class="p">,</span> <span class="s1">&#39;D_65&#39;</span><span class="p">,</span> <span class="s1">&#39;D_66&#39;</span><span class="p">,</span> <span class="s1">&#39;D_68&#39;</span><span class="p">,</span> <span class="s1">&#39;D_69&#39;</span><span class="p">,</span> <span class="s1">&#39;D_70&#39;</span><span class="p">,</span> <span class="s1">&#39;D_71&#39;</span><span class="p">,</span> <span class="s1">&#39;D_72&#39;</span><span class="p">,</span> <span class="s1">&#39;D_73&#39;</span><span class="p">,</span> <span class="s1">&#39;D_74&#39;</span><span class="p">,</span> <span class="s1">&#39;D_75&#39;</span><span class="p">,</span> <span class="s1">&#39;D_76&#39;</span><span class="p">,</span> <span class="s1">&#39;D_77&#39;</span><span class="p">,</span> <span class="s1">&#39;D_78&#39;</span><span class="p">,</span> <span class="s1">&#39;D_79&#39;</span><span class="p">,</span> <span class="s1">&#39;D_80&#39;</span><span class="p">,</span> <span class="s1">&#39;D_81&#39;</span><span class="p">,</span> <span class="s1">&#39;D_82&#39;</span><span class="p">,</span> <span class="s1">&#39;D_83&#39;</span><span class="p">,</span> <span class="s1">&#39;D_84&#39;</span><span class="p">,</span> <span class="s1">&#39;D_86&#39;</span><span class="p">,</span> <span class="s1">&#39;D_87&#39;</span><span class="p">,</span> <span class="s1">&#39;D_88&#39;</span><span class="p">,</span> <span class="s1">&#39;D_89&#39;</span><span class="p">,</span> <span class="s1">&#39;D_91&#39;</span><span class="p">,</span> <span class="s1">&#39;D_92&#39;</span><span class="p">,</span> <span class="s1">&#39;D_93&#39;</span><span class="p">,</span> <span class="s1">&#39;D_94&#39;</span><span class="p">,</span> <span class="s1">&#39;D_96&#39;</span><span class="p">,</span> <span class="s1">&#39;D_102&#39;</span><span class="p">,</span> <span class="s1">&#39;D_103&#39;</span><span class="p">,</span> <span class="s1">&#39;D_104&#39;</span><span class="p">,</span> <span class="s1">&#39;D_105&#39;</span><span class="p">,</span> <span class="s1">&#39;D_106&#39;</span><span class="p">,</span> <span class="s1">&#39;D_107&#39;</span><span class="p">,</span> <span class="s1">&#39;D_108&#39;</span><span class="p">,</span> <span class="s1">&#39;D_109&#39;</span><span class="p">,</span> <span class="s1">&#39;D_110&#39;</span><span class="p">,</span> <span class="s1">&#39;D_111&#39;</span><span class="p">,</span> <span class="s1">&#39;D_112&#39;</span><span class="p">,</span> <span class="s1">&#39;D_113&#39;</span><span class="p">,</span> <span class="s1">&#39;D_114&#39;</span><span class="p">,</span> <span class="s1">&#39;D_115&#39;</span><span class="p">,</span> <span class="s1">&#39;D_116&#39;</span><span class="p">,</span> <span class="s1">&#39;D_117&#39;</span><span class="p">,</span> <span class="s1">&#39;D_118&#39;</span><span class="p">,</span> <span class="s1">&#39;D_119&#39;</span><span class="p">,</span> <span class="s1">&#39;D_120&#39;</span><span class="p">,</span> <span class="s1">&#39;D_121&#39;</span><span class="p">,</span> <span class="s1">&#39;D_122&#39;</span><span class="p">,</span> <span class="s1">&#39;D_123&#39;</span><span class="p">,</span> <span class="s1">&#39;D_124&#39;</span><span class="p">,</span> <span class="s1">&#39;D_125&#39;</span><span class="p">,</span> <span class="s1">&#39;D_126&#39;</span><span class="p">,</span> <span class="s1">&#39;D_127&#39;</span><span class="p">,</span> <span class="s1">&#39;D_128&#39;</span><span class="p">,</span> <span class="s1">&#39;D_129&#39;</span><span class="p">,</span> <span class="s1">&#39;D_130&#39;</span><span class="p">,</span> <span class="s1">&#39;D_131&#39;</span><span class="p">,</span> <span class="s1">&#39;D_132&#39;</span><span class="p">,</span> <span class="s1">&#39;D_133&#39;</span><span class="p">,</span> <span class="s1">&#39;D_134&#39;</span><span class="p">,</span> <span class="s1">&#39;D_135&#39;</span><span class="p">,</span> <span class="s1">&#39;D_136&#39;</span><span class="p">,</span> <span class="s1">&#39;D_137&#39;</span><span class="p">,</span> <span class="s1">&#39;D_138&#39;</span><span class="p">,</span> <span class="s1">&#39;D_139&#39;</span><span class="p">,</span> <span class="s1">&#39;D_140&#39;</span><span class="p">,</span> <span class="s1">&#39;D_141&#39;</span><span class="p">,</span> <span class="s1">&#39;D_142&#39;</span><span class="p">,</span> <span class="s1">&#39;D_143&#39;</span><span class="p">,</span> <span class="s1">&#39;D_144&#39;</span><span class="p">,</span> <span class="s1">&#39;D_145&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/46294f171be5749657750bfc9df0368108f56402b77cef307a08613ff0f61e6a.png" src="_images/46294f171be5749657750bfc9df0368108f56402b77cef307a08613ff0f61e6a.png" />
</div>
</div>
<p>Dada la gran cantidad de variables asociadas a delincuencia no se puden apreciar las etiquetas de cada una de ellas, pero sigue sucediendo que en varias variables se encuentran los mismos registros con datos faltantes como en las 13 variables que se encuentran juntas (<em>Bloque 3.</em>) o el conjunto de seis variables separadas por una variable que tienen el mismo comportamiento de datos faltantes (<em>Bloque 4.</em>)</p>
<p><img alt="image.png" src="attachment:image.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">msno</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">train_data</span><span class="p">[[</span><span class="s1">&#39;P_4&#39;</span><span class="p">,</span><span class="s1">&#39;P_2&#39;</span><span class="p">,</span><span class="s1">&#39;P_3&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/202dc2bcc672911ed117fe30a85f99253539569b8ff1688c7f0b065581a3e65f.png" src="_images/202dc2bcc672911ed117fe30a85f99253539569b8ff1688c7f0b065581a3e65f.png" />
</div>
</div>
<p>Aquí la cantidad de datos faltantes por variable no es tan grande y no parece haber una relación entre los datos faltantes de ``P_2<code class="docutils literal notranslate"><span class="pre">y</span></code>P_3`</p>
<p>Debido a la gran cantidad de variables con un alto porcentaje de datos faltantes, de decidió eliminar aquellas con un porcentaje de datos faltantes mayor a 50%</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_per</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fa</span><span class="o">.</span><span class="n">missing_per</span><span class="p">(</span><span class="n">train_data</span><span class="p">))</span>
<span class="n">show</span> <span class="o">=</span> <span class="n">missing_per</span><span class="p">[</span><span class="n">missing_per</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">show</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>D_42</th>
      <td>85.694278</td>
    </tr>
    <tr>
      <th>D_49</th>
      <td>90.137597</td>
    </tr>
    <tr>
      <th>D_50</th>
      <td>56.809723</td>
    </tr>
    <tr>
      <th>D_53</th>
      <td>73.842921</td>
    </tr>
    <tr>
      <th>D_56</th>
      <td>54.071581</td>
    </tr>
    <tr>
      <th>S_9</th>
      <td>53.035686</td>
    </tr>
    <tr>
      <th>B_17</th>
      <td>56.722874</td>
    </tr>
    <tr>
      <th>D_66</th>
      <td>88.730733</td>
    </tr>
    <tr>
      <th>D_73</th>
      <td>98.990211</td>
    </tr>
    <tr>
      <th>D_76</th>
      <td>88.746226</td>
    </tr>
    <tr>
      <th>R_9</th>
      <td>94.349891</td>
    </tr>
    <tr>
      <th>D_82</th>
      <td>73.373406</td>
    </tr>
    <tr>
      <th>B_29</th>
      <td>93.104594</td>
    </tr>
    <tr>
      <th>D_87</th>
      <td>99.930127</td>
    </tr>
    <tr>
      <th>D_88</th>
      <td>99.891457</td>
    </tr>
    <tr>
      <th>D_105</th>
      <td>54.622756</td>
    </tr>
    <tr>
      <th>D_106</th>
      <td>90.213255</td>
    </tr>
    <tr>
      <th>R_26</th>
      <td>88.984717</td>
    </tr>
    <tr>
      <th>D_108</th>
      <td>99.476846</td>
    </tr>
    <tr>
      <th>D_110</th>
      <td>99.433530</td>
    </tr>
    <tr>
      <th>D_111</th>
      <td>99.433530</td>
    </tr>
    <tr>
      <th>B_39</th>
      <td>99.391986</td>
    </tr>
    <tr>
      <th>B_42</th>
      <td>98.707789</td>
    </tr>
    <tr>
      <th>D_132</th>
      <td>90.191055</td>
    </tr>
    <tr>
      <th>D_134</th>
      <td>96.480146</td>
    </tr>
    <tr>
      <th>D_135</th>
      <td>96.480146</td>
    </tr>
    <tr>
      <th>D_136</th>
      <td>96.480146</td>
    </tr>
    <tr>
      <th>D_137</th>
      <td>96.480146</td>
    </tr>
    <tr>
      <th>D_138</th>
      <td>96.480146</td>
    </tr>
    <tr>
      <th>D_142</th>
      <td>82.926577</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">show</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>30
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;D_42&#39;, &#39;D_49&#39;, &#39;D_50&#39;, &#39;D_53&#39;, &#39;D_56&#39;, &#39;S_9&#39;, &#39;B_17&#39;, &#39;D_66&#39;, &#39;D_73&#39;,
       &#39;D_76&#39;, &#39;R_9&#39;, &#39;D_82&#39;, &#39;B_29&#39;, &#39;D_87&#39;, &#39;D_88&#39;, &#39;D_105&#39;, &#39;D_106&#39;, &#39;R_26&#39;,
       &#39;D_108&#39;, &#39;D_110&#39;, &#39;D_111&#39;, &#39;B_39&#39;, &#39;B_42&#39;, &#39;D_132&#39;, &#39;D_134&#39;, &#39;D_135&#39;,
       &#39;D_136&#39;, &#39;D_137&#39;, &#39;D_138&#39;, &#39;D_142&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>En total son 30 variables y en su mayoría corresponden a variables asociadas a delincuencia.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">td</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;D_42&#39;</span><span class="p">,</span> <span class="s1">&#39;D_49&#39;</span><span class="p">,</span> <span class="s1">&#39;D_50&#39;</span><span class="p">,</span> <span class="s1">&#39;D_53&#39;</span><span class="p">,</span> <span class="s1">&#39;D_56&#39;</span><span class="p">,</span> <span class="s1">&#39;S_9&#39;</span><span class="p">,</span> <span class="s1">&#39;B_17&#39;</span><span class="p">,</span> <span class="s1">&#39;D_66&#39;</span><span class="p">,</span> <span class="s1">&#39;D_73&#39;</span><span class="p">,</span>
       <span class="s1">&#39;D_76&#39;</span><span class="p">,</span> <span class="s1">&#39;R_9&#39;</span><span class="p">,</span> <span class="s1">&#39;D_82&#39;</span><span class="p">,</span> <span class="s1">&#39;B_29&#39;</span><span class="p">,</span> <span class="s1">&#39;D_87&#39;</span><span class="p">,</span> <span class="s1">&#39;D_88&#39;</span><span class="p">,</span> <span class="s1">&#39;D_105&#39;</span><span class="p">,</span> <span class="s1">&#39;D_106&#39;</span><span class="p">,</span> <span class="s1">&#39;R_26&#39;</span><span class="p">,</span>
       <span class="s1">&#39;D_108&#39;</span><span class="p">,</span> <span class="s1">&#39;D_110&#39;</span><span class="p">,</span> <span class="s1">&#39;D_111&#39;</span><span class="p">,</span> <span class="s1">&#39;B_39&#39;</span><span class="p">,</span> <span class="s1">&#39;B_42&#39;</span><span class="p">,</span> <span class="s1">&#39;D_132&#39;</span><span class="p">,</span> <span class="s1">&#39;D_134&#39;</span><span class="p">,</span> <span class="s1">&#39;D_135&#39;</span><span class="p">,</span>
       <span class="s1">&#39;D_136&#39;</span><span class="p">,</span> <span class="s1">&#39;D_137&#39;</span><span class="p">,</span> <span class="s1">&#39;D_138&#39;</span><span class="p">,</span> <span class="s1">&#39;D_142&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">td</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_ID</th>
      <th>S_2</th>
      <th>P_2</th>
      <th>D_39</th>
      <th>B_1</th>
      <th>B_2</th>
      <th>R_1</th>
      <th>S_3</th>
      <th>D_41</th>
      <th>B_3</th>
      <th>...</th>
      <th>D_130</th>
      <th>D_131</th>
      <th>D_133</th>
      <th>R_28</th>
      <th>D_139</th>
      <th>D_140</th>
      <th>D_141</th>
      <th>D_143</th>
      <th>D_144</th>
      <th>D_145</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-03-09</td>
      <td>0.938469</td>
      <td>0.001733</td>
      <td>0.008724</td>
      <td>1.006838</td>
      <td>0.009228</td>
      <td>0.124035</td>
      <td>0.008771</td>
      <td>0.004709</td>
      <td>...</td>
      <td>0.002052</td>
      <td>0.005972</td>
      <td>0.004345</td>
      <td>0.001535</td>
      <td>0.002427</td>
      <td>0.003706</td>
      <td>0.003818</td>
      <td>0.000569</td>
      <td>0.000610</td>
      <td>0.002674</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-04-07</td>
      <td>0.936665</td>
      <td>0.005775</td>
      <td>0.004923</td>
      <td>1.000653</td>
      <td>0.006151</td>
      <td>0.126750</td>
      <td>0.000798</td>
      <td>0.002714</td>
      <td>...</td>
      <td>0.001034</td>
      <td>0.004838</td>
      <td>0.007495</td>
      <td>0.004931</td>
      <td>0.003954</td>
      <td>0.003167</td>
      <td>0.005032</td>
      <td>0.009576</td>
      <td>0.005492</td>
      <td>0.009217</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-05-28</td>
      <td>0.954180</td>
      <td>0.091505</td>
      <td>0.021655</td>
      <td>1.009672</td>
      <td>0.006815</td>
      <td>0.123977</td>
      <td>0.007598</td>
      <td>0.009423</td>
      <td>...</td>
      <td>0.005681</td>
      <td>0.005497</td>
      <td>0.009227</td>
      <td>0.009123</td>
      <td>0.003269</td>
      <td>0.007329</td>
      <td>0.000427</td>
      <td>0.003429</td>
      <td>0.006986</td>
      <td>0.002603</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-06-13</td>
      <td>0.960384</td>
      <td>0.002455</td>
      <td>0.013683</td>
      <td>1.002700</td>
      <td>0.001373</td>
      <td>0.117169</td>
      <td>0.000685</td>
      <td>0.005531</td>
      <td>...</td>
      <td>0.007108</td>
      <td>0.008261</td>
      <td>0.007206</td>
      <td>0.002409</td>
      <td>0.006117</td>
      <td>0.004516</td>
      <td>0.003200</td>
      <td>0.008419</td>
      <td>0.006527</td>
      <td>0.009600</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-07-16</td>
      <td>0.947248</td>
      <td>0.002483</td>
      <td>0.015193</td>
      <td>1.000727</td>
      <td>0.007605</td>
      <td>0.117325</td>
      <td>0.004653</td>
      <td>0.009312</td>
      <td>...</td>
      <td>0.009680</td>
      <td>0.004848</td>
      <td>0.006312</td>
      <td>0.004462</td>
      <td>0.003671</td>
      <td>0.004946</td>
      <td>0.008889</td>
      <td>0.001670</td>
      <td>0.008126</td>
      <td>0.009827</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 160 columns</p>
</div></div></div>
</div>
<p>Ahora contamos con 160 variables en las cuales hay valores faltantes en 92 de ellas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_per</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fa</span><span class="o">.</span><span class="n">missing_per</span><span class="p">(</span><span class="n">td</span><span class="p">))</span>
<span class="n">show</span> <span class="o">=</span> <span class="n">missing_per</span><span class="p">[</span><span class="n">missing_per</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">show</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>P_2</th>
      <td>0.831337</td>
    </tr>
    <tr>
      <th>B_2</th>
      <td>0.036446</td>
    </tr>
    <tr>
      <th>S_3</th>
      <td>18.449843</td>
    </tr>
    <tr>
      <th>D_41</th>
      <td>0.036446</td>
    </tr>
    <tr>
      <th>B_3</th>
      <td>0.036446</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>D_140</th>
      <td>0.734563</td>
    </tr>
    <tr>
      <th>D_141</th>
      <td>1.835829</td>
    </tr>
    <tr>
      <th>D_143</th>
      <td>1.835829</td>
    </tr>
    <tr>
      <th>D_144</th>
      <td>0.736281</td>
    </tr>
    <tr>
      <th>D_145</th>
      <td>1.835829</td>
    </tr>
  </tbody>
</table>
<p>92 rows × 1 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numeric_cols</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>En una maquina virtual se realizó el proceso de imputación de datos usando IterativeImputer() para las variables numéricas, guardado en un pickle sobre el cual, debido al bajo procentaje de datos faltantes en variables categóricas se decidió imputar con la mediana y luego se le aplicó la prueba de contingencia de chi cuadrado, para posteriormente realizar la reducción de multicolinealidad con PCA pasando de 160 a 64 variables significativas. Se muestra a continuación el resultado obtenido de este proceso de limpieza al igual que las respectivas salidas en algunos de los procesos.</p>
<p><img alt="Imagen de WhatsApp 2024-10-21 a las 10.28.12_fd966ce3.jpg" src="attachment:Imagen%20de%20WhatsApp%202024-10-21%20a%20las%2010.28.12_fd966ce3.jpg" /></p>
<p>La reducción de multicolinealidad con PCA se realizó basándose en las cargas de las variables, aquellas que sobrepasar un threshold de 0.35 se consideraron significativas.</p>
<p><img alt="Imagen de WhatsApp 2024-10-21 a las 10.18.58_624980a3.jpg" src="attachment:Imagen%20de%20WhatsApp%202024-10-21%20a%20las%2010.18.58_624980a3.jpg" /></p>
<p>Se muestran también los encabezados de la base de datos a medida que se fue avanzando en cada proceso.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Código utilizado para imputar</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.experimental</span> <span class="kn">import</span> <span class="n">enable_iterative_imputer</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">IterativeImputer</span>
<span class="kn">import</span> <span class="nn">dask.dataframe</span> <span class="k">as</span> <span class="nn">dd</span>

<span class="n">td</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s2">&quot;td.pkl&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">td</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">tdp</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">])</span>
<span class="n">tdpd</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">tdp</span><span class="p">,</span> <span class="n">npartitions</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ip</span><span class="p">(</span><span class="n">df_partition</span><span class="p">):</span>
    <span class="n">nnc</span> <span class="o">=</span> <span class="n">df_partition</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">df_partition</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nnc</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df_partition</span>
    <span class="n">imputer</span> <span class="o">=</span> <span class="n">IterativeImputer</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_partition</span><span class="p">[</span><span class="n">nnc</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span><span class="n">nnc</span><span class="p">)</span>

<span class="n">imputed_ddf</span> <span class="o">=</span> <span class="n">tdpd</span><span class="o">.</span><span class="n">map_partitions</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
<span class="n">imputed_ddf</span> <span class="o">=</span> <span class="n">imputed_ddf</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">td</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">imputed_ddf</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tdp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

<span class="n">tnn</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">tdp</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">td_non_numeric</span> <span class="o">=</span> <span class="n">tnn</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">imputed_ddf</span> <span class="o">=</span> <span class="n">imputed_ddf</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">td_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">td_non_numeric</span><span class="p">,</span> <span class="n">imputed_ddf</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">td_final</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">td_final</span><span class="p">)</span>

<span class="n">td_final</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s1">&#39;td_imputed.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imputación</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s2">&quot;imput_head.pkl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_ID</th>
      <th>S_2</th>
      <th>D_63</th>
      <th>D_64</th>
      <th>D_68</th>
      <th>B_30</th>
      <th>B_38</th>
      <th>D_114</th>
      <th>D_116</th>
      <th>D_117</th>
      <th>...</th>
      <th>D_130</th>
      <th>D_131</th>
      <th>D_133</th>
      <th>R_28</th>
      <th>D_139</th>
      <th>D_140</th>
      <th>D_141</th>
      <th>D_143</th>
      <th>D_144</th>
      <th>D_145</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-03-09</td>
      <td>CR</td>
      <td>O</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>0.002052</td>
      <td>0.005972</td>
      <td>0.004345</td>
      <td>0.001535</td>
      <td>0.002427</td>
      <td>0.003706</td>
      <td>0.003818</td>
      <td>0.000569</td>
      <td>0.000610</td>
      <td>0.002674</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-04-07</td>
      <td>CR</td>
      <td>O</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>0.001034</td>
      <td>0.004838</td>
      <td>0.007495</td>
      <td>0.004931</td>
      <td>0.003954</td>
      <td>0.003167</td>
      <td>0.005032</td>
      <td>0.009576</td>
      <td>0.005492</td>
      <td>0.009217</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-05-28</td>
      <td>CR</td>
      <td>O</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>0.005681</td>
      <td>0.005497</td>
      <td>0.009227</td>
      <td>0.009123</td>
      <td>0.003269</td>
      <td>0.007329</td>
      <td>0.000427</td>
      <td>0.003429</td>
      <td>0.006986</td>
      <td>0.002603</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-06-13</td>
      <td>CR</td>
      <td>O</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>0.007108</td>
      <td>0.008261</td>
      <td>0.007206</td>
      <td>0.002409</td>
      <td>0.006117</td>
      <td>0.004516</td>
      <td>0.003200</td>
      <td>0.008419</td>
      <td>0.006527</td>
      <td>0.009600</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0000099d6bd597052cdcda90ffabf56573fe9d7c79be5f...</td>
      <td>2017-07-16</td>
      <td>CR</td>
      <td>O</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>0.009680</td>
      <td>0.004848</td>
      <td>0.006312</td>
      <td>0.004462</td>
      <td>0.003671</td>
      <td>0.004946</td>
      <td>0.008889</td>
      <td>0.001670</td>
      <td>0.008126</td>
      <td>0.009827</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 160 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Código utilizado para imputar categóricas y chi cuadrado</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2_contingency</span>

<span class="n">td</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s2">&quot;td_imputed.pkl&quot;</span><span class="p">)</span>

<span class="n">cvars</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">cvars</span><span class="p">:</span>
    <span class="n">mode_value</span> <span class="o">=</span> <span class="n">td</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> 
    <span class="n">td</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mode_value</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">td</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cvars</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cvars</span><span class="p">)):</span>
        <span class="n">var1</span> <span class="o">=</span> <span class="n">cvars</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">var2</span> <span class="o">=</span> <span class="n">cvars</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        
        <span class="n">contingency_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">td</span><span class="p">[</span><span class="n">var1</span><span class="p">],</span> <span class="n">td</span><span class="p">[</span><span class="n">var2</span><span class="p">])</span>

        <span class="n">chi2</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">expected</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">contingency_table</span><span class="p">)</span>
        
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;Variable 1&#39;</span><span class="p">:</span> <span class="n">var1</span><span class="p">,</span>
            <span class="s1">&#39;Variable 2&#39;</span><span class="p">:</span> <span class="n">var2</span><span class="p">,</span>
            <span class="s1">&#39;Chi2 Statistic&#39;</span><span class="p">:</span> <span class="n">chi2</span><span class="p">,</span>
            <span class="s1">&#39;p-value&#39;</span><span class="p">:</span> <span class="n">p</span>
        <span class="p">})</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resultados del test Chi-cuadrado:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="n">hc</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;p-value&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A eliminar por chi2&#39;</span><span class="p">,</span> <span class="n">hc</span><span class="p">)</span>

<span class="n">vtd</span> <span class="o">=</span> <span class="n">hc</span><span class="p">[</span><span class="s1">&#39;Variable 1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="n">td</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">vtd</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="n">td</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s1">&#39;td_cleanedchi2.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imputación categórica y chi cuadrado</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s2">&quot;chi_head.pkl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>D_126</th>
      <th>P_2</th>
      <th>D_39</th>
      <th>B_1</th>
      <th>B_2</th>
      <th>R_1</th>
      <th>S_3</th>
      <th>D_41</th>
      <th>B_3</th>
      <th>D_43</th>
      <th>...</th>
      <th>D_130</th>
      <th>D_131</th>
      <th>D_133</th>
      <th>R_28</th>
      <th>D_139</th>
      <th>D_140</th>
      <th>D_141</th>
      <th>D_143</th>
      <th>D_144</th>
      <th>D_145</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>0.938469</td>
      <td>0.001733</td>
      <td>0.008724</td>
      <td>1.006838</td>
      <td>0.009228</td>
      <td>0.124035</td>
      <td>0.008771</td>
      <td>0.004709</td>
      <td>0.044116</td>
      <td>...</td>
      <td>0.002052</td>
      <td>0.005972</td>
      <td>0.004345</td>
      <td>0.001535</td>
      <td>0.002427</td>
      <td>0.003706</td>
      <td>0.003818</td>
      <td>0.000569</td>
      <td>0.000610</td>
      <td>0.002674</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>0.936665</td>
      <td>0.005775</td>
      <td>0.004923</td>
      <td>1.000653</td>
      <td>0.006151</td>
      <td>0.126750</td>
      <td>0.000798</td>
      <td>0.002714</td>
      <td>0.045111</td>
      <td>...</td>
      <td>0.001034</td>
      <td>0.004838</td>
      <td>0.007495</td>
      <td>0.004931</td>
      <td>0.003954</td>
      <td>0.003167</td>
      <td>0.005032</td>
      <td>0.009576</td>
      <td>0.005492</td>
      <td>0.009217</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>0.954180</td>
      <td>0.091505</td>
      <td>0.021655</td>
      <td>1.009672</td>
      <td>0.006815</td>
      <td>0.123977</td>
      <td>0.007598</td>
      <td>0.009423</td>
      <td>0.045342</td>
      <td>...</td>
      <td>0.005681</td>
      <td>0.005497</td>
      <td>0.009227</td>
      <td>0.009123</td>
      <td>0.003269</td>
      <td>0.007329</td>
      <td>0.000427</td>
      <td>0.003429</td>
      <td>0.006986</td>
      <td>0.002603</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>0.960384</td>
      <td>0.002455</td>
      <td>0.013683</td>
      <td>1.002700</td>
      <td>0.001373</td>
      <td>0.117169</td>
      <td>0.000685</td>
      <td>0.005531</td>
      <td>0.050301</td>
      <td>...</td>
      <td>0.007108</td>
      <td>0.008261</td>
      <td>0.007206</td>
      <td>0.002409</td>
      <td>0.006117</td>
      <td>0.004516</td>
      <td>0.003200</td>
      <td>0.008419</td>
      <td>0.006527</td>
      <td>0.009600</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>0.947248</td>
      <td>0.002483</td>
      <td>0.015193</td>
      <td>1.000727</td>
      <td>0.007605</td>
      <td>0.117325</td>
      <td>0.004653</td>
      <td>0.009312</td>
      <td>0.036697</td>
      <td>...</td>
      <td>0.009680</td>
      <td>0.004848</td>
      <td>0.006312</td>
      <td>0.004462</td>
      <td>0.003671</td>
      <td>0.004946</td>
      <td>0.008889</td>
      <td>0.001670</td>
      <td>0.008126</td>
      <td>0.009827</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 149 columns</p>
</div></div></div>
</div>
<p>El resultado se encuentra un pickle llamado ‘td_cleanedchi2pca.pkl’</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s2">&quot;td_cleanedchi2.pkl&quot;</span><span class="p">)</span>
<span class="n">dn</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">datosnor</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dn</span><span class="p">)</span>

<span class="n">modelo_pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="n">cp</span> <span class="o">=</span> <span class="n">modelo_pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">datosnor</span><span class="p">)</span>

<span class="n">df_componentes_principales</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cp</span><span class="p">,</span> 
                                           <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Componente_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df_componentes_principales</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="n">cargas_componentes</span> <span class="o">=</span> <span class="n">modelo_pca</span><span class="o">.</span><span class="n">components_</span>
<span class="n">df_cargas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cargas_componentes</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">dn</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> 
                         <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Componente_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cargas_componentes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>

<span class="n">ts</span> <span class="o">=</span> <span class="mf">0.38</span>

<span class="n">variables_significativas</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">df_cargas</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">variables</span> <span class="o">=</span> <span class="n">df_cargas</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">df_cargas</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">ts</span><span class="p">]</span>
    <span class="n">variables_significativas</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>

<span class="n">df_pca</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">variables_significativas</span><span class="p">)]</span>

<span class="n">df_pca</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s2">&quot;td_cleanedchi2pca.pkl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reducción de multicolinealidad por PCA</span>
<span class="n">td</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s2">&quot;td_cleanedchi2pca.pkl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">td</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>D_94</th>
      <th>D_140</th>
      <th>D_92</th>
      <th>D_71</th>
      <th>B_6</th>
      <th>D_83</th>
      <th>B_5</th>
      <th>S_18</th>
      <th>B_26</th>
      <th>B_31</th>
      <th>...</th>
      <th>R_17</th>
      <th>D_96</th>
      <th>S_6</th>
      <th>R_22</th>
      <th>B_24</th>
      <th>R_23</th>
      <th>S_11</th>
      <th>R_12</th>
      <th>D_86</th>
      <th>D_123</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.008871</td>
      <td>0.003706</td>
      <td>1.006133</td>
      <td>0.119403</td>
      <td>0.063902</td>
      <td>0.007043</td>
      <td>0.170600</td>
      <td>0.005720</td>
      <td>0.000272</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.000198</td>
      <td>0.004950</td>
      <td>0.008322</td>
      <td>0.007479</td>
      <td>0.004327</td>
      <td>0.006893</td>
      <td>0.401619</td>
      <td>1.009825</td>
      <td>0.007084</td>
      <td>0.003057</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.000391</td>
      <td>0.003167</td>
      <td>1.005791</td>
      <td>0.140611</td>
      <td>0.065261</td>
      <td>0.007789</td>
      <td>0.113239</td>
      <td>0.007584</td>
      <td>0.000979</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.001142</td>
      <td>0.003180</td>
      <td>0.002482</td>
      <td>0.006827</td>
      <td>0.004203</td>
      <td>0.002837</td>
      <td>0.406326</td>
      <td>1.009461</td>
      <td>0.006677</td>
      <td>0.001306</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.009234</td>
      <td>0.007329</td>
      <td>1.005801</td>
      <td>0.075868</td>
      <td>0.066982</td>
      <td>0.004093</td>
      <td>0.060492</td>
      <td>0.005901</td>
      <td>0.006149</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.008013</td>
      <td>0.005433</td>
      <td>0.000530</td>
      <td>0.009820</td>
      <td>0.001782</td>
      <td>0.005080</td>
      <td>0.406768</td>
      <td>1.004291</td>
      <td>0.001185</td>
      <td>0.003954</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.003200</td>
      <td>0.004516</td>
      <td>1.007036</td>
      <td>0.150209</td>
      <td>0.083720</td>
      <td>0.008817</td>
      <td>0.166782</td>
      <td>0.002520</td>
      <td>0.009193</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.009455</td>
      <td>0.000063</td>
      <td>0.000783</td>
      <td>0.000458</td>
      <td>0.005595</td>
      <td>0.007320</td>
      <td>0.405175</td>
      <td>1.004728</td>
      <td>0.003324</td>
      <td>0.005135</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.003845</td>
      <td>0.004946</td>
      <td>1.002915</td>
      <td>0.096441</td>
      <td>0.075900</td>
      <td>0.001845</td>
      <td>0.143630</td>
      <td>0.000155</td>
      <td>0.005738</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.002019</td>
      <td>0.000535</td>
      <td>0.006698</td>
      <td>0.003341</td>
      <td>0.004933</td>
      <td>0.000264</td>
      <td>0.487460</td>
      <td>1.000904</td>
      <td>0.001504</td>
      <td>0.002849</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 64 columns</p>
</div></div></div>
</div>
<p>Nótese que la variable customer_id fue eliminada, sin embargo, debido a la construcción del modelo será reagregada a los datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">customer_id</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;td.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">td</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">customer_id</span><span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">customer_id</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;train_labels.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">customer_id</span><span class="p">[[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">]],</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">merged</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modelos">
<h1>Modelos<a class="headerlink" href="#modelos" title="Link to this heading">#</a></h1>
<p>Considere el conjunto de datos <strong>Default Probability Prediction</strong>. Implemente la versión de clasificación para cada uno de los modelos estudiados en clases, y prediga la variable respuesta, probabilidad para la variable target (default probability). Construir una tabla de error que contenga las métricas usuales de clasificación: precision, recall, f1-score, AUC. Además, agregue matrices de confusión (ver <code class="docutils literal notranslate"><span class="pre">confusion_matrix</span></code>) y curvas ROC (ver <code class="docutils literal notranslate"><span class="pre">plot_roc</span></code>). Inicialmente realice un balanceo de clases usando <strong>ADASYN</strong> (Adaptive Synthetic Sampling), luego compare los resultados predictivos con o sin balanceo ADASYN. Posteriormente, realice hiperparametrización usando <strong>BayesianOptimization</strong>, <strong>GridSearchCV</strong>, y <strong>Pipeline</strong> para evaluar cada modelo, y compare los resultados en términos de tiempo de computo. Verifique que la validación cruzada seleccionada es la adecuada, y justifíquelo.</p>
<section id="que-es-adasyn">
<h2>¿Qué es ADASYN?<a class="headerlink" href="#que-es-adasyn" title="Link to this heading">#</a></h2>
<p>ADASYN (Adaptive Synthetic Sampling) es una técnica de sobremuestreo utilizada para abordar problemas de desbalanceo en conjuntos de datos, especialmente en problemas de clasificación donde una clase es significativamente menos representada que otra. Se generan instancias sintéticas para las instancias difíciles, donde la cantidad de instancias a generar se determina por el nivel de dificultad. Para cada instancia seleccionada, se eligen aleatoriamente vecinos cercanos de la clase mayoritaria para crear nuevos puntos sintéticos en el espacio de características.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">imblearn.over_sampling</span> <span class="kn">import</span> <span class="n">ADASYN</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pickle</span>
</pre></div>
</div>
</div>
</div>
<p>Todos los modelos, de igual manera fueron ejecutados en una máquina virtual. Se presentan los códigos utilizados y posteriormente la importación de los pickles asociados a los modelos ya entrenados.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Precisión:&quot;</span><span class="p">,</span> <span class="n">precision</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Recall:&quot;</span><span class="p">,</span> <span class="n">recall</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;F1-score:&quot;</span><span class="p">,</span> <span class="n">f1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AUC:&quot;</span><span class="p">,</span> <span class="n">auc</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matriz de confusión:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
    
</pre></div>
</div>
</div>
</div>
<p>Previo a la construcción de los modelos, se modificó la base de datos luego de la limpieza para agregar nuevamente la columna ‘customer_ID’, necesaria para asociar a los clientes y sus registros dentro de los modelos.</p>
</section>
<section id="modelos-sin-adasyn">
<h2>Modelos sin ADASYN<a class="headerlink" href="#modelos-sin-adasyn" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabla</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Precisión&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.76</span><span class="p">,</span> <span class="mf">0.61</span><span class="p">,</span> <span class="mf">0.73</span><span class="p">,</span> <span class="mf">0.73</span><span class="p">],</span>
    <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.71</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.57</span><span class="p">,</span> <span class="mf">0.59</span><span class="p">],</span>
    <span class="s1">&#39;f1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.64</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">],</span>
    <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.91</span><span class="p">,</span> <span class="mf">0.84</span><span class="p">,</span> <span class="mf">0.89</span><span class="p">,</span> <span class="mf">0.89</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">tabla</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;KNN&#39;</span><span class="p">,</span> <span class="s1">&#39;Clasificación bayesiana&#39;</span><span class="p">,</span> <span class="s1">&#39;Penalización L1&#39;</span><span class="p">,</span> <span class="s1">&#39;Penalización L2&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="s1">&#39;customer_ID&#39;</span><span class="p">])</span>
<span class="n">cat_cols</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
<span class="n">X_encoded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cat_cols</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_encoded</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="knn">
<h3>KNN<a class="headerlink" href="#knn" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knn_no_balanceo</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">knn_no_balanceo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;knn_no_balanceo.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">knn_no_balanceo</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knnnb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;modelos/knn_no_balanceo.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">knnnb</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Este modelo fue entrenado con todos los datos del conjunto de entrenamiento y se obtuvieron las siguientes métricas:</p>
<p><img alt="image.png" src="attachment:image.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;KNN&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>f1</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>KNN</th>
      <td>0.76</td>
      <td>0.71</td>
      <td>0.75</td>
      <td>0.91</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">770102</span><span class="p">,</span> <span class="mi">60615</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">79484</span><span class="p">,</span> <span class="mi">196090</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conf_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Clase 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Clase 1&quot;</span><span class="p">],</span> 
            <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Clase 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Clase 1&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/509f98ac6d185f3dcffbf98feb8dcbece4994dfa5711aa52d0c95103c73a33b3.png" src="_images/509f98ac6d185f3dcffbf98feb8dcbece4994dfa5711aa52d0c95103c73a33b3.png" />
</div>
</div>
<p>El modelo predijo correctamente la clase positiva en 770,102 casos y predijo correctamente la clase negativa en 196,090 casos.</p>
</section>
<section id="clasificacion-bayesiana">
<h3>Clasificación bayesiana<a class="headerlink" href="#clasificacion-bayesiana" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nb_no_balanceo</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">nb_no_balanceo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">nb_no_balanceo</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;nb_no_balanceo.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">nb_no_balanceo</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbnb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;modelos/nb_no_balanceo.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">nbnb</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="image.png" src="attachment:image.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Clasificación bayesiana&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>f1</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Clasificación bayesiana</th>
      <td>0.61</td>
      <td>0.5</td>
      <td>0.55</td>
      <td>0.84</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">742455</span><span class="p">,</span> <span class="mi">88262</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">135401</span><span class="p">,</span> <span class="mi">140173</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conf_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Clase 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Clase 1&quot;</span><span class="p">],</span> 
            <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Clase 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Clase 1&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c4aaee6248c6edd34e972d091a7927b9b81f5928ab125f6ea457157c3e49d464.png" src="_images/c4aaee6248c6edd34e972d091a7927b9b81f5928ab125f6ea457157c3e49d464.png" />
</div>
</div>
<p>El modelo predijo correctamente la clase positiva en 742,455 casos y predijo correctamente la clase negativa en 140,173 casos.</p>
</section>
<section id="regresion-logistica-con-penalizacion-l1">
<h3>Regresión logística con penalización L1<a class="headerlink" href="#regresion-logistica-con-penalizacion-l1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_reg_l1_no_balanceo</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l1&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">)</span>
<span class="n">log_reg_l1_no_balanceo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">log_reg_l1_no_balanceo</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;log_reg_l1_no_balanceo.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">log_reg_l1_no_balanceo</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l1nb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;modelos/log_reg_l1_no_balanceo.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">l1nb</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="image.png" src="attachment:image.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Penalización L1&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>f1</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Penalización L1</th>
      <td>0.73</td>
      <td>0.57</td>
      <td>0.64</td>
      <td>0.89</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">772750</span><span class="p">,</span> <span class="mi">57967</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">116324</span><span class="p">,</span> <span class="mi">159250</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conf_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Clase 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Clase 1&quot;</span><span class="p">],</span> 
            <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Clase 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Clase 1&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2ade848dd979a61cd814d06e05b9a76c19f84a7b2b94ae64bb51f5e494836557.png" src="_images/2ade848dd979a61cd814d06e05b9a76c19f84a7b2b94ae64bb51f5e494836557.png" />
</div>
</div>
<p>El modelo predijo correctamente la clase positiva en 772,750 casos y predijo correctamente la clase negativa en 159,250 casos.</p>
</section>
<section id="regresion-logistica-con-penalizacion-l2">
<h3>Regresión logística con penalización L2<a class="headerlink" href="#regresion-logistica-con-penalizacion-l2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_reg_l2_no_balanceo</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">)</span>
<span class="n">log_reg_l2_no_balanceo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">log_reg_l2_no_balanceo</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;log_reg_l2_no_balanceo.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">log_reg_l2_no_balanceo</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l2nb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;modelos/log_reg_l2_no_balanceo.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">l2nb</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="image.png" src="attachment:image.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Penalización L2&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>f1</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Penalización L2</th>
      <td>0.73</td>
      <td>0.59</td>
      <td>0.65</td>
      <td>0.89</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">771628</span><span class="p">,</span> <span class="mi">59089</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">112417</span><span class="p">,</span> <span class="mi">163157</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conf_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Clase 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Clase 1&quot;</span><span class="p">],</span> 
            <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Clase 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Clase 1&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0f45abe1398b942e6e2afa11f7ea47f62cd04242d431054552ad8830444aad05.png" src="_images/0f45abe1398b942e6e2afa11f7ea47f62cd04242d431054552ad8830444aad05.png" />
</div>
</div>
</section>
<section id="comparacion">
<h3>Comparación<a class="headerlink" href="#comparacion" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabla</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>f1</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>KNN</th>
      <td>0.76</td>
      <td>0.71</td>
      <td>0.75</td>
      <td>0.91</td>
    </tr>
    <tr>
      <th>Clasificación bayesiana</th>
      <td>0.61</td>
      <td>0.50</td>
      <td>0.55</td>
      <td>0.84</td>
    </tr>
    <tr>
      <th>Penalización L1</th>
      <td>0.73</td>
      <td>0.57</td>
      <td>0.64</td>
      <td>0.89</td>
    </tr>
    <tr>
      <th>Penalización L2</th>
      <td>0.73</td>
      <td>0.59</td>
      <td>0.65</td>
      <td>0.89</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>KNN se destaca en todas las métricas. Tiene la mejor precisión, recall, F1 Score y AUC, lo que indica que este modelo tiene un buen equilibrio entre identificar correctamente las instancias positivas y evitar falsos positivos. en cuanto a clasificación bayesiana, tiene las métricas más bajas en comparación con los demás. Con una precisión de 0.61 y un recall de 0.50, no está funcionando bien en la identificación de la clase positiva. Los modelos con penalización, si bien funcionan mejor que clasificación bayesiana, no logran superar a KNN.</p>
</section>
</section>
<section id="modelos-con-adasyn">
<h2>Modelos con ADASYN<a class="headerlink" href="#modelos-con-adasyn" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabla2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Precisión&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.61</span><span class="p">,</span> <span class="mf">0.60</span><span class="p">,</span> <span class="mf">0.58</span><span class="p">,</span> <span class="mf">0.58</span><span class="p">],</span>
    <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.90</span><span class="p">,</span> <span class="mf">0.57</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">],</span>
    <span class="s1">&#39;f1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.73</span><span class="p">,</span> <span class="mf">0.58</span><span class="p">,</span> <span class="mf">0.66</span><span class="p">,</span> <span class="mf">0.69</span><span class="p">],</span>
    <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.91</span><span class="p">,</span> <span class="mf">0.84</span><span class="p">,</span> <span class="mf">0.89</span><span class="p">,</span> <span class="mf">0.89</span><span class="p">]</span>
<span class="p">}</span>
 
<span class="n">tabla2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla2</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;KNN&#39;</span><span class="p">,</span> <span class="s1">&#39;Clasificación bayesiana&#39;</span><span class="p">,</span> <span class="s1">&#39;Penalización L1&#39;</span><span class="p">,</span> <span class="s1">&#39;Penalización L2&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adasyn</span> <span class="o">=</span> <span class="n">ADASYN</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">X_train_resampled</span><span class="p">,</span> <span class="n">y_train_resampled</span> <span class="o">=</span> <span class="n">adasyn</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tamaño de clases antes de ADASYN:&quot;</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tamaño de clases después de ADASYN:&quot;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_train_resampled</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h3>KNN<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knn_con_balanceo</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">knn_con_balanceo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_resampled</span><span class="p">,</span> <span class="n">y_train_resampled</span><span class="p">)</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">knn_con_balanceo</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;knn_con_balanceo.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">knn_con_balanceo</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knnb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;knn_con_balanceo.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">knnb</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="image.png" src="attachment:image.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;KNN&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>f1</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>KNN</th>
      <td>0.61</td>
      <td>0.9</td>
      <td>0.73</td>
      <td>0.91</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">673915</span><span class="p">,</span> <span class="mi">156802</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">26274</span><span class="p">,</span> <span class="mi">249300</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conf_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Clase 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Clase 1&quot;</span><span class="p">],</span> 
            <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Clase 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Clase 1&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/53fe33cf566d182b5ee39f38efb1d140107f06d9680af27b7e8e9eba35cef403.png" src="_images/53fe33cf566d182b5ee39f38efb1d140107f06d9680af27b7e8e9eba35cef403.png" />
</div>
</div>
</section>
<section id="id2">
<h3>Clasificación bayesiana<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nb_con_balanceo</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">nb_con_balanceo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_resampled</span><span class="p">,</span> <span class="n">y_train_resampled</span><span class="p">)</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">nb_con_balanceo</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;nb_con_balanceo.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">nb_con_balanceo</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;modelos/nb_con_balanceo.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">nbb</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="image.png" src="attachment:image.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Clasificación bayesiana&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>f1</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Clasificación bayesiana</th>
      <td>0.6</td>
      <td>0.57</td>
      <td>0.58</td>
      <td>0.84</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">725331</span><span class="p">,</span> <span class="mi">105386</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">116804</span><span class="p">,</span> <span class="mi">158770</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conf_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Clase 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Clase 1&quot;</span><span class="p">],</span> 
            <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Clase 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Clase 1&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f5cf2a44b625dba9cfbee3c78125f25030711840c6123003b3c43eb120eb089a.png" src="_images/f5cf2a44b625dba9cfbee3c78125f25030711840c6123003b3c43eb120eb089a.png" />
</div>
</div>
</section>
<section id="id3">
<h3>Regresión logística con penalización L1<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_reg_l1_con_balanceo</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l1&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">)</span>
<span class="n">log_reg_l1_con_balanceo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_resampled</span><span class="p">,</span> <span class="n">y_train_resampled</span><span class="p">)</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">log_reg_l1_con_balanceo</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;log_reg_l1_con_balanceo.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">log_reg_l1_con_balanceo</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l1b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;modelos/log_reg_l1_con_balanceo.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">l1b</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="attachment:image.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Penalización L1&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>f1</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Penalización L1</th>
      <td>0.58</td>
      <td>0.83</td>
      <td>0.66</td>
      <td>0.89</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">665194</span><span class="p">,</span> <span class="mi">165523</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">45660</span><span class="p">,</span> <span class="mi">229914</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conf_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Clase 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Clase 1&quot;</span><span class="p">],</span> 
            <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Clase 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Clase 1&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/40b3355c2ca8d74a7b3183881321c57a6697afb152ad74a795d98fa4e245a53c.png" src="_images/40b3355c2ca8d74a7b3183881321c57a6697afb152ad74a795d98fa4e245a53c.png" />
</div>
</div>
</section>
<section id="id4">
<h3>Regresión logística con penalización L2<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_reg_l2_con_balanceo</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">)</span>
<span class="n">log_reg_l2_con_balanceo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_resampled</span><span class="p">,</span> <span class="n">y_train_resampled</span><span class="p">)</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">log_reg_l2_con_balanceo</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;log_reg_l2_con_balanceo.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">log_reg_l2_con_balanceo</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l2b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;modelos/log_reg_l2_no_balanceo.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">l2b</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="Imagen de WhatsApp 2024-10-21 a las 22.48.17_e5cccf02.jpg" src="attachment:Imagen%20de%20WhatsApp%202024-10-21%20a%20las%2022.48.17_e5cccf02.jpg" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Penalización L2&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>f1</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Penalización L2</th>
      <td>0.58</td>
      <td>0.85</td>
      <td>0.69</td>
      <td>0.89</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">661133</span><span class="p">,</span> <span class="mi">169584</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">39666</span><span class="p">,</span> <span class="mi">235908</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conf_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Clase 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Clase 1&quot;</span><span class="p">],</span> 
            <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Clase 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Clase 1&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/279df28f661f8fa867489d4f8d76cf32e7f1fb0013c16e290c740228e0f7d31e.png" src="_images/279df28f661f8fa867489d4f8d76cf32e7f1fb0013c16e290c740228e0f7d31e.png" />
</div>
</div>
</section>
<section id="id5">
<h3>Comparación<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabla2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>f1</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>KNN</th>
      <td>0.61</td>
      <td>0.90</td>
      <td>0.73</td>
      <td>0.91</td>
    </tr>
    <tr>
      <th>Clasificación bayesiana</th>
      <td>0.60</td>
      <td>0.57</td>
      <td>0.58</td>
      <td>0.84</td>
    </tr>
    <tr>
      <th>Penalización L1</th>
      <td>0.58</td>
      <td>0.83</td>
      <td>0.66</td>
      <td>0.89</td>
    </tr>
    <tr>
      <th>Penalización L2</th>
      <td>0.58</td>
      <td>0.85</td>
      <td>0.69</td>
      <td>0.89</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>KNN tiene la mayor precisión (0.61), lo que significa que de las instancias clasificadas como positivas, el 61% son verdaderamente positivas y además con un recall de 0.9 indica que captura el 90% de las instancias positivas reales, haciendo de este modelo uno muy efectivo para detectar casos positivos. En general, KNN obtuvo las mejores métricas.</p>
</section>
</section>
<section id="comparacion-adasyn-o-sin-adasyn">
<h2>Comparación: ADASYN o sin ADASYN<a class="headerlink" href="#comparacion-adasyn-o-sin-adasyn" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabla</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>f1</th>
      <th>AUC</th>
      <th>Tipo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>KNN</th>
      <td>0.76</td>
      <td>0.71</td>
      <td>0.75</td>
      <td>0.91</td>
      <td>Sin ADASYN</td>
    </tr>
    <tr>
      <th>Clasificación bayesiana</th>
      <td>0.61</td>
      <td>0.50</td>
      <td>0.55</td>
      <td>0.84</td>
      <td>Sin ADASYN</td>
    </tr>
    <tr>
      <th>Penalización L1</th>
      <td>0.73</td>
      <td>0.57</td>
      <td>0.64</td>
      <td>0.89</td>
      <td>Sin ADASYN</td>
    </tr>
    <tr>
      <th>Penalización L2</th>
      <td>0.73</td>
      <td>0.59</td>
      <td>0.65</td>
      <td>0.89</td>
      <td>Sin ADASYN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabla2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>f1</th>
      <th>AUC</th>
      <th>Tipo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>KNN</th>
      <td>0.61</td>
      <td>0.90</td>
      <td>0.73</td>
      <td>0.91</td>
      <td>Con ADASYN</td>
    </tr>
    <tr>
      <th>Clasificación bayesiana</th>
      <td>0.60</td>
      <td>0.57</td>
      <td>0.58</td>
      <td>0.84</td>
      <td>Con ADASYN</td>
    </tr>
    <tr>
      <th>Penalización L1</th>
      <td>0.58</td>
      <td>0.83</td>
      <td>0.66</td>
      <td>0.89</td>
      <td>Con ADASYN</td>
    </tr>
    <tr>
      <th>Penalización L2</th>
      <td>0.58</td>
      <td>0.85</td>
      <td>0.69</td>
      <td>0.89</td>
      <td>Con ADASYN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Debido al ejercicio que se desea realizar, se decidió mantener los modelos con balancel de clases con ADASYN debido a que el recall en todos los modelos aumentó al usar esta técnica, indicando somos capaces de detectar un mayor porcentaje de instancias de impago (default), que es fundamental en la gestión del riesgo de crédito.  Dado que el objetivo principal es capturar instancias positivas (impagos), es aceptable un ligero sacrificio en precisión a cambio de un mejor recall.</p>
</section>
<section id="modelos-adasyn-con-hiperparametrizacion-bayessearchcv-y-gridsearchcv-con-pipelines">
<h2>Modelos ADASYN con hiperparametrización: BayesSearchCV y gridsearchCV con pipelines<a class="headerlink" href="#modelos-adasyn-con-hiperparametrizacion-bayessearchcv-y-gridsearchcv-con-pipelines" title="Link to this heading">#</a></h2>
<p>Para la elección de mejor modelo se hizo uso de la métrica proporcionada en el contexto del parcial</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">imblearn.over_sampling</span> <span class="kn">import</span> <span class="n">ADASYN</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">skopt</span> <span class="kn">import</span> <span class="n">BayesSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">make_scorer</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">pickle</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">defaultprob_metric</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;working...&#39;</span><span class="p">)</span>
    <span class="n">y_true</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;true&#39;</span><span class="p">:</span> <span class="n">y_true</span><span class="p">,</span> <span class="s1">&#39;prediction&#39;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;prediction&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">top_four_percent_captured</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">20</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">four_pct_cutoff</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.04</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;weight_cumsum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
        <span class="n">df_cutoff</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;weight_cumsum&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">four_pct_cutoff</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">df_cutoff</span><span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">weighted_gini</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">20</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;random&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
        <span class="n">total_pos</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cum_pos_found&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;lorentz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cum_pos_found&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">total_pos</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gini&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;lorentz&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;random&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gini&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">normalized_weighted_gini</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">weighted_gini</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">/</span> <span class="n">weighted_gini</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;true&#39;</span><span class="p">:</span> <span class="n">y_true</span><span class="p">,</span> <span class="s1">&#39;prediction&#39;</span><span class="p">:</span> <span class="n">y_true</span><span class="p">}))</span>

    <span class="n">g</span> <span class="o">=</span> <span class="n">normalized_weighted_gini</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">top_four_percent_captured</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">g</span> <span class="o">+</span> <span class="n">d</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">calculate_metrics</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">model_name</span><span class="p">):</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--- </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precision: </span><span class="si">{</span><span class="n">precision</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recall: </span><span class="si">{</span><span class="n">recall</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1-score: </span><span class="si">{</span><span class="n">f1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AUC: </span><span class="si">{</span><span class="n">auc</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">make_scorer</span><span class="p">(</span><span class="n">defaultprob_metric</span><span class="p">,</span> <span class="n">greater_is_better</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Estos modelos también fueron ejecutados en la maquina virtual. Se adjuntan los diferentes códigos utilizados para la obtenición de los hiperparámetros y el resultado obtenido en consola. Para la hiperparametrización se hizo uso de una submuestra estratificada y luego se predijo todo el conjunto de entrenamiento para la evaluación de las métricas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;data.pkl&#39;</span><span class="p">)</span>
<span class="n">data_sampled</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.98</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">data_sampled</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="s1">&#39;customer_ID&#39;</span><span class="p">])</span>
<span class="n">cat_cols</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cat_cols</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data_sampled</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

<span class="n">adasyn</span> <span class="o">=</span> <span class="n">ADASYN</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
<span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span> <span class="o">=</span> <span class="n">adasyn</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="hiperparametrizacion-con-gridsearchcv">
<h3>Hiperparametrización con GridsearchCV<a class="headerlink" href="#hiperparametrizacion-con-gridsearchcv" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabla</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;KNN&#39;</span><span class="p">,</span> <span class="s1">&#39;Clasificación Bayesiana&#39;</span><span class="p">,</span> <span class="s1">&#39;Penalización L2&#39;</span><span class="p">,</span> <span class="s1">&#39;Penalización L1&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Tiempo de Ejecución (s)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">471.03</span><span class="p">,</span> <span class="mf">10.72</span><span class="p">,</span> <span class="mf">88.71</span><span class="p">,</span> <span class="mf">16335.24</span><span class="p">],</span>
    <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.467</span><span class="p">,</span> <span class="mf">0.483</span><span class="p">,</span> <span class="mf">0.467</span><span class="p">,</span> <span class="mf">0.467</span><span class="p">],</span>
    <span class="s1">&#39;Precisión&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.58</span><span class="p">,</span> <span class="mf">0.582</span><span class="p">],</span>
    <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.94</span><span class="p">,</span> <span class="mf">0.59</span><span class="p">,</span> <span class="mf">0.86</span><span class="p">,</span> <span class="mf">0.86</span><span class="p">],</span>
    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.67</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.69</span><span class="p">,</span> <span class="mf">0.69</span><span class="p">],</span>
    <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.73</span><span class="p">,</span> <span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.82</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">tabla</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="id6">
<h4>KNN<a class="headerlink" href="#id6" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
    <span class="p">(</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">())</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_grid</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;knn__n_neighbors&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
    <span class="s1">&#39;knn__weights&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">],</span>
    <span class="s1">&#39;knn__metric&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;euclidean&#39;</span><span class="p">,</span> <span class="s1">&#39;manhattan&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">M</span><span class="p">)</span>
<span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span><span class="p">)</span>
<span class="n">grid_search_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_grid</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores parámetros con GridSearchCV: </span><span class="si">{</span><span class="n">grid_search</span><span class="o">.</span><span class="n">best_params_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor puntuación con GridSearchCV: </span><span class="si">{</span><span class="n">grid_search</span><span class="o">.</span><span class="n">best_score_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tiempo de GridSearchCV: </span><span class="si">{</span><span class="n">grid_search_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> segundos&quot;</span><span class="p">)</span>
<span class="n">y_pred_grid</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">calculate_metrics</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_grid</span><span class="p">,</span> <span class="s2">&quot;GridSearchCV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gs_knn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;hiperparametrizaciones/grid_search_knn.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="Imagen de WhatsApp 2024-10-21 a las 23.26.44_d1c7d3d2.jpg" src="attachment:Imagen%20de%20WhatsApp%202024-10-21%20a%20las%2023.26.44_d1c7d3d2.jpg" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Tiempo de Ejecución (s)</th>
      <th>M</th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>F1 Score</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>KNN</td>
      <td>471.03</td>
      <td>0.467</td>
      <td>0.53</td>
      <td>0.94</td>
      <td>0.67</td>
      <td>0.83</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id7">
<h4>Clasificación bayesiana<a class="headerlink" href="#id7" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>  <span class="c1"># Normalización</span>
    <span class="p">(</span><span class="s1">&#39;nb&#39;</span><span class="p">,</span> <span class="n">GaussianNB</span><span class="p">())</span>  <span class="c1"># Modelo Naive Bayes</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_grid</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;nb__var_smoothing&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e-9</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1e-7</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">M</span><span class="p">)</span>
<span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span><span class="p">)</span>
<span class="n">grid_search_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_grid</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores parámetros con GridSearchCV: </span><span class="si">{</span><span class="n">grid_search</span><span class="o">.</span><span class="n">best_params_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor puntuación con GridSearchCV: </span><span class="si">{</span><span class="n">grid_search</span><span class="o">.</span><span class="n">best_score_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tiempo de GridSearchCV: </span><span class="si">{</span><span class="n">grid_search_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> segundos&quot;</span><span class="p">)</span>
<span class="n">y_pred_grid</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">calculate_metrics</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_grid</span><span class="p">,</span> <span class="s2">&quot;GridSearchCV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gs_nb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;hiperparametrizaciones/grid_search_nb.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="Imagen de WhatsApp 2024-10-21 a las 23.49.44_812801aa.jpg" src="attachment:Imagen%20de%20WhatsApp%202024-10-21%20a%20las%2023.49.44_812801aa.jpg" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Tiempo de Ejecución (s)</th>
      <th>M</th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>F1 Score</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Clasificación Bayesiana</td>
      <td>10.72</td>
      <td>0.483</td>
      <td>0.6</td>
      <td>0.59</td>
      <td>0.6</td>
      <td>0.73</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="regresion-logisitca-con-penalizacion-l1">
<h4>Regresión logísitca con penalización L1<a class="headerlink" href="#regresion-logisitca-con-penalizacion-l1" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
    <span class="p">(</span><span class="s1">&#39;log_reg&#39;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l1&#39;</span><span class="p">))</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_grid</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;log_reg__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">M</span><span class="p">)</span>
<span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span><span class="p">)</span>
<span class="n">grid_search_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_grid</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gs_l1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;hiperparametrizaciones/grid_search_l1.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="Imagen de WhatsApp 2024-10-22 a las 16.39.03_316f5a59.jpg" src="attachment:Imagen%20de%20WhatsApp%202024-10-22%20a%20las%2016.39.03_316f5a59.jpg" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Tiempo de Ejecución (s)</th>
      <th>M</th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>F1 Score</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>Penalización L1</td>
      <td>16335.24</td>
      <td>0.467</td>
      <td>0.582</td>
      <td>0.86</td>
      <td>0.69</td>
      <td>0.82</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id8">
<h4>Regresión logística con penalización L2<a class="headerlink" href="#id8" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
    <span class="p">(</span><span class="s1">&#39;log_reg&#39;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">))</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_grid</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;log_reg__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">M</span><span class="p">)</span>
<span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span><span class="p">)</span>
<span class="n">grid_search_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_grid</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores parámetros con GridSearchCV: </span><span class="si">{</span><span class="n">grid_search</span><span class="o">.</span><span class="n">best_params_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor puntuación con GridSearchCV: </span><span class="si">{</span><span class="n">grid_search</span><span class="o">.</span><span class="n">best_score_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tiempo de GridSearchCV: </span><span class="si">{</span><span class="n">grid_search_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> segundos&quot;</span><span class="p">)</span>
<span class="n">y_pred_grid</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">calculate_metrics</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_grid</span><span class="p">,</span> <span class="s2">&quot;GridSearchCV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gs_l2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;hiperparametrizaciones/grid_search_l2.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="Imagen de WhatsApp 2024-10-22 a las 02.21.17_7f22d932.jpg" src="attachment:Imagen%20de%20WhatsApp%202024-10-22%20a%20las%2002.21.17_7f22d932.jpg" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Tiempo de Ejecución (s)</th>
      <th>M</th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>F1 Score</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Penalización L2</td>
      <td>88.71</td>
      <td>0.467</td>
      <td>0.58</td>
      <td>0.86</td>
      <td>0.69</td>
      <td>0.82</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id9">
<h4>Comparación<a class="headerlink" href="#id9" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Tiempo de Ejecución (s)</th>
      <th>M</th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>F1 Score</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>KNN</td>
      <td>471.03</td>
      <td>0.467</td>
      <td>0.530</td>
      <td>0.94</td>
      <td>0.67</td>
      <td>0.83</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Clasificación Bayesiana</td>
      <td>10.72</td>
      <td>0.483</td>
      <td>0.600</td>
      <td>0.59</td>
      <td>0.60</td>
      <td>0.73</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Penalización L2</td>
      <td>88.71</td>
      <td>0.467</td>
      <td>0.580</td>
      <td>0.86</td>
      <td>0.69</td>
      <td>0.82</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Penalización L1</td>
      <td>16335.24</td>
      <td>0.467</td>
      <td>0.582</td>
      <td>0.86</td>
      <td>0.69</td>
      <td>0.82</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>El modelo con clasificación bayesiana tiene el mejor M, lo que la hace el modelo más efectivo según la métrica prioritaria en este análisis, es decir, es el mejor modelo en términos de la capacidad para capturar defaults en el top 4% de las predicciones, sin emabrgo, regresión logística con penalización L2 ofrece un buen equilibrio entre precisión y recall, con métricas de desempeño mejores en general. Penalización L1 ni siquiera se considera debido al tiempo de ejecución que tomó (más de 13 horas entre GridsearchCV y BayesSearchCV)</p>
<p><img alt="Captura de pantalla 2024-10-22 153203.png" src="attachment:Captura%20de%20pantalla%202024-10-22%20153203.png" /></p>
</section>
</section>
<section id="hiperparametrizacion-con-bayessearchcv">
<h3>Hiperparametrización con BayesSearchCV<a class="headerlink" href="#hiperparametrizacion-con-bayessearchcv" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabla2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;KNN&#39;</span><span class="p">,</span> <span class="s1">&#39;Clasificación Bayesiana&#39;</span><span class="p">,</span> <span class="s1">&#39;Penalización L2&#39;</span><span class="p">,</span> <span class="s1">&#39;Penalización L1&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Tiempo de Ejecución (s)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">699.66</span><span class="p">,</span> <span class="mf">25.63</span><span class="p">,</span> <span class="mf">173.74</span><span class="p">,</span> <span class="mf">34441.27</span><span class="p">],</span>
    <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.468</span><span class="p">,</span> <span class="mf">0.483</span><span class="p">,</span> <span class="mf">0.467</span><span class="p">,</span> <span class="mf">0.467</span><span class="p">],</span>
    <span class="s1">&#39;Precisión&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.52</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.58</span><span class="p">,</span> <span class="mf">0.58</span><span class="p">],</span>
    <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.59</span><span class="p">,</span> <span class="mf">0.86</span><span class="p">,</span> <span class="mf">0.86</span><span class="p">],</span>
    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.67</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.69</span><span class="p">,</span> <span class="mf">0.69</span><span class="p">],</span>
    <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.73</span><span class="p">,</span> <span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.82</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">tabla2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="id10">
<h4>KNN<a class="headerlink" href="#id10" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_bayes</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">bayes_search</span> <span class="o">=</span> <span class="n">BayesSearchCV</span><span class="p">(</span>
    <span class="n">pipeline</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s1">&#39;knn__n_neighbors&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s1">&#39;knn__weights&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">],</span>
        <span class="s1">&#39;knn__metric&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;euclidean&#39;</span><span class="p">,</span> <span class="s1">&#39;manhattan&#39;</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="n">M</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;BAYESIANA&#39;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">bayes_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ocurrió un error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">bayes_search_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_bayes</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores parámetros con BayesSearchCV: </span><span class="si">{</span><span class="n">bayes_search</span><span class="o">.</span><span class="n">best_params_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor puntuación con BayesSearchCV: </span><span class="si">{</span><span class="n">bayes_search</span><span class="o">.</span><span class="n">best_score_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tiempo de BayesSearchCV: </span><span class="si">{</span><span class="n">bayes_search_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> segundos&quot;</span><span class="p">)</span>
<span class="n">y_pred_bayes</span> <span class="o">=</span> <span class="n">bayes_search</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">calculate_metrics</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_bayes</span><span class="p">,</span> <span class="s2">&quot;BayesSearchCV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="Imagen de WhatsApp 2024-10-21 a las 23.34.15_5583f9a4.jpg" src="attachment:Imagen%20de%20WhatsApp%202024-10-21%20a%20las%2023.34.15_5583f9a4.jpg" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>KNN</td>
    </tr>
    <tr>
      <th>Tiempo de Ejecución (s)</th>
      <td>699.66</td>
    </tr>
    <tr>
      <th>M</th>
      <td>0.468</td>
    </tr>
    <tr>
      <th>Precisión</th>
      <td>0.52</td>
    </tr>
    <tr>
      <th>Recall</th>
      <td>0.95</td>
    </tr>
    <tr>
      <th>F1 Score</th>
      <td>0.67</td>
    </tr>
    <tr>
      <th>AUC</th>
      <td>0.83</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id11">
<h4>Clasificación bayesiana<a class="headerlink" href="#id11" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_bayes</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">bayes_search</span> <span class="o">=</span> <span class="n">BayesSearchCV</span><span class="p">(</span>
    <span class="n">pipeline</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s1">&#39;nb__var_smoothing&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e-9</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1e-7</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">)</span>
    <span class="p">},</span>
    <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="n">M</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;BAYESIANA&#39;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">bayes_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ocurrió un error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">bayes_search_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_bayes</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores parámetros con BayesSearchCV: </span><span class="si">{</span><span class="n">bayes_search</span><span class="o">.</span><span class="n">best_params_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor puntuación con BayesSearchCV: </span><span class="si">{</span><span class="n">bayes_search</span><span class="o">.</span><span class="n">best_score_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tiempo de BayesSearchCV: </span><span class="si">{</span><span class="n">bayes_search_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> segundos&quot;</span><span class="p">)</span>
<span class="n">y_pred_bayes</span> <span class="o">=</span> <span class="n">bayes_search</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">calculate_metrics</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_bayes</span><span class="p">,</span> <span class="s2">&quot;BayesSearchCV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="Imagen de WhatsApp 2024-10-21 a las 23.49.32_e906594c.jpg" src="attachment:Imagen%20de%20WhatsApp%202024-10-21%20a%20las%2023.49.32_e906594c.jpg" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Clasificación Bayesiana</td>
    </tr>
    <tr>
      <th>Tiempo de Ejecución (s)</th>
      <td>25.63</td>
    </tr>
    <tr>
      <th>M</th>
      <td>0.483</td>
    </tr>
    <tr>
      <th>Precisión</th>
      <td>0.6</td>
    </tr>
    <tr>
      <th>Recall</th>
      <td>0.59</td>
    </tr>
    <tr>
      <th>F1 Score</th>
      <td>0.6</td>
    </tr>
    <tr>
      <th>AUC</th>
      <td>0.73</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id12">
<h4>Regresión logísitca con penalización L1<a class="headerlink" href="#id12" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_bayes</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">bayes_search</span> <span class="o">=</span> <span class="n">BayesSearchCV</span><span class="p">(</span>
    <span class="n">pipeline</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s1">&#39;log_reg__C&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># Busqueda bayesiana para el parámetro C en escala logarítmica</span>
    <span class="p">},</span>
    <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="n">M</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span>
<span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">bayes_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ocurrió un error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">bayes_search_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_bayes</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="Imagen de WhatsApp 2024-10-22 a las 16.39.18_0687d161.jpg" src="attachment:Imagen%20de%20WhatsApp%202024-10-22%20a%20las%2016.39.18_0687d161.jpg" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Penalización L1</td>
    </tr>
    <tr>
      <th>Tiempo de Ejecución (s)</th>
      <td>34441.27</td>
    </tr>
    <tr>
      <th>M</th>
      <td>0.467</td>
    </tr>
    <tr>
      <th>Precisión</th>
      <td>0.58</td>
    </tr>
    <tr>
      <th>Recall</th>
      <td>0.86</td>
    </tr>
    <tr>
      <th>F1 Score</th>
      <td>0.69</td>
    </tr>
    <tr>
      <th>AUC</th>
      <td>0.82</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="regresion-logisitca-con-penalizacion-l2">
<h4>Regresión logísitca con penalización L2<a class="headerlink" href="#regresion-logisitca-con-penalizacion-l2" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_bayes</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">bayes_search</span> <span class="o">=</span> <span class="n">BayesSearchCV</span><span class="p">(</span>
    <span class="n">pipeline</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s1">&#39;log_reg__C&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># Búsqueda bayesiana para el parámetro C en escala logarítmica</span>
    <span class="p">},</span>
    <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="n">M</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;BAYESIANA&#39;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">bayes_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ocurrió un error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">bayes_search_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_bayes</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores parámetros con BayesSearchCV: </span><span class="si">{</span><span class="n">bayes_search</span><span class="o">.</span><span class="n">best_params_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor puntuación con BayesSearchCV: </span><span class="si">{</span><span class="n">bayes_search</span><span class="o">.</span><span class="n">best_score_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tiempo de BayesSearchCV: </span><span class="si">{</span><span class="n">bayes_search_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> segundos&quot;</span><span class="p">)</span>
<span class="n">y_pred_bayes</span> <span class="o">=</span> <span class="n">bayes_search</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">calculate_metrics</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_bayes</span><span class="p">,</span> <span class="s2">&quot;BayesSearchCV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="Imagen de WhatsApp 2024-10-22 a las 02.21.17_83e91d28.jpg" src="attachment:Imagen%20de%20WhatsApp%202024-10-22%20a%20las%2002.21.17_83e91d28.jpg" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Penalización L2</td>
    </tr>
    <tr>
      <th>Tiempo de Ejecución (s)</th>
      <td>173.74</td>
    </tr>
    <tr>
      <th>M</th>
      <td>0.467</td>
    </tr>
    <tr>
      <th>Precisión</th>
      <td>0.58</td>
    </tr>
    <tr>
      <th>Recall</th>
      <td>0.86</td>
    </tr>
    <tr>
      <th>F1 Score</th>
      <td>0.69</td>
    </tr>
    <tr>
      <th>AUC</th>
      <td>0.82</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="comparacion-entre-gridsearchcv-y-bayessearchcv">
<h3>Comparación entre GridsearchCV y BayesSearchCV<a class="headerlink" href="#comparacion-entre-gridsearchcv-y-bayessearchcv" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabla</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Tiempo de Ejecución (s)</th>
      <th>M</th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>F1 Score</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>KNN</td>
      <td>471.03</td>
      <td>0.467</td>
      <td>0.530</td>
      <td>0.94</td>
      <td>0.67</td>
      <td>0.83</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Clasificación Bayesiana</td>
      <td>10.72</td>
      <td>0.483</td>
      <td>0.600</td>
      <td>0.59</td>
      <td>0.60</td>
      <td>0.73</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Penalización L2</td>
      <td>88.71</td>
      <td>0.467</td>
      <td>0.580</td>
      <td>0.86</td>
      <td>0.69</td>
      <td>0.82</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Penalización L1</td>
      <td>16335.24</td>
      <td>0.467</td>
      <td>0.582</td>
      <td>0.86</td>
      <td>0.69</td>
      <td>0.82</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabla2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Tiempo de Ejecución (s)</th>
      <th>M</th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>F1 Score</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>KNN</td>
      <td>699.66</td>
      <td>0.468</td>
      <td>0.52</td>
      <td>0.95</td>
      <td>0.67</td>
      <td>0.83</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Clasificación Bayesiana</td>
      <td>25.63</td>
      <td>0.483</td>
      <td>0.60</td>
      <td>0.59</td>
      <td>0.60</td>
      <td>0.73</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Penalización L2</td>
      <td>173.74</td>
      <td>0.467</td>
      <td>0.58</td>
      <td>0.86</td>
      <td>0.69</td>
      <td>0.82</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Penalización L1</td>
      <td>34441.27</td>
      <td>0.467</td>
      <td>0.58</td>
      <td>0.86</td>
      <td>0.69</td>
      <td>0.82</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Al comparar los tiempos de ejecución entre GridSearch y BayesSearch, podemos observar  GridSearch ha tenido un mejor desempeño en general, algo que no se esperaba debido a que BayesSearch en teoría es más eficiente. En cuanto al modelo final, se trabajará hiperparámetros ofrecidos por GridSearchCV para clasificación bayesiana, debido a que fue el modelo que obtuvo un mejor score en la métrica deseada M.</p>
</section>
</section>
<section id="modelo-final">
<h2>Modelo final<a class="headerlink" href="#modelo-final" title="Link to this heading">#</a></h2>
<p>Se escogió trabajar con los hiperparámetros de GridSearchCV para clasificación bayesiana, es decir, el parámetro var_smoothing se toma como 1e-09, este modelo será entrenado con todos los datos  de entrenamiento y se utilizará para hacer predicciones en el conjunto de datos de prueba ofrecido. Se notó la presencia de datos faltantes en el conjuntos de test, por lo que será necesario realizar imputación de datos faltantes con IterativeImputer(). Esto se realizó también en la maquina virtual.</p>
<p>Primero se acomodaron los datos para que encajarqan con las variables de la base de datos de entrenamiento luego de la limpieza, además de la codificación de las variables categóricas (D_116) aún presente después de la eliminación. Luego sí se realizó el imputer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;data.pkl&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>

<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="s1">&#39;test_data.ftr&#39;</span><span class="p">)</span>
<span class="n">columns_in_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span>

<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;D_126&#39;</span><span class="p">],</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">columns_in_data</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">columns</span><span class="p">)]</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">columns</span><span class="p">)]</span>

<span class="n">numeric_cols</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">])</span>
<span class="n">tdp_dask</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">numeric_cols</span><span class="p">,</span> <span class="n">npartitions</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">impute_partition</span><span class="p">(</span><span class="n">df_partition</span><span class="p">):</span>
    <span class="n">non_null_columns</span> <span class="o">=</span> <span class="n">df_partition</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">df_partition</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">non_null_columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df_partition</span>
    <span class="n">imputer</span> <span class="o">=</span> <span class="n">IterativeImputer</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_partition</span><span class="p">[</span><span class="n">non_null_columns</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span><span class="n">non_null_columns</span><span class="p">)</span>

<span class="n">imputed_ddf</span> <span class="o">=</span> <span class="n">tdp_dask</span><span class="o">.</span><span class="n">map_partitions</span><span class="p">(</span><span class="n">impute_partition</span><span class="p">)</span>
<span class="n">imputed_ddf</span> <span class="o">=</span> <span class="n">imputed_ddf</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="n">td_non_numeric</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">numeric_cols</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">td_non_numeric</span> <span class="o">=</span> <span class="n">td_non_numeric</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">imputed_ddf</span> <span class="o">=</span> <span class="n">imputed_ddf</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">test_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">td_non_numeric</span><span class="p">,</span> <span class="n">imputed_ddf</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_final</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s1">&#39;test_imputed.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_imput</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;modelofinal/test_imputed.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_imput</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\Valen\AppData\Local\miniconda3\envs\myenv\lib\site-packages\pandas\io\formats\format.py:1458: RuntimeWarning: overflow encountered in cast
  has_large_values = (abs_vals &gt; 1e6).any()
c:\Users\Valen\AppData\Local\miniconda3\envs\myenv\lib\site-packages\pandas\io\formats\format.py:1458: RuntimeWarning: overflow encountered in cast
  has_large_values = (abs_vals &gt; 1e6).any()
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_ID</th>
      <th>D_94</th>
      <th>D_140</th>
      <th>D_92</th>
      <th>D_71</th>
      <th>B_6</th>
      <th>D_83</th>
      <th>B_5</th>
      <th>S_18</th>
      <th>B_26</th>
      <th>...</th>
      <th>R_17</th>
      <th>D_96</th>
      <th>S_6</th>
      <th>R_22</th>
      <th>B_24</th>
      <th>R_23</th>
      <th>S_11</th>
      <th>R_12</th>
      <th>D_86</th>
      <th>D_123</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>00000469ba478561f23a92a868bd366de6f6527a684c9a...</td>
      <td>0.004391</td>
      <td>0.004669</td>
      <td>0.008759</td>
      <td>0.014687</td>
      <td>0.174561</td>
      <td>0.015732</td>
      <td>0.009514</td>
      <td>0.003683</td>
      <td>0.001657</td>
      <td>...</td>
      <td>0.008911</td>
      <td>0.009575</td>
      <td>1.006836</td>
      <td>0.007473</td>
      <td>0.009796</td>
      <td>0.000192</td>
      <td>1.881836</td>
      <td>1.002930</td>
      <td>0.009911</td>
      <td>0.062744</td>
    </tr>
    <tr>
      <th>1</th>
      <td>00000469ba478561f23a92a868bd366de6f6527a684c9a...</td>
      <td>0.007889</td>
      <td>0.004940</td>
      <td>0.004318</td>
      <td>0.011948</td>
      <td>0.177124</td>
      <td>0.014847</td>
      <td>0.026306</td>
      <td>0.006409</td>
      <td>0.005516</td>
      <td>...</td>
      <td>0.000843</td>
      <td>0.006950</td>
      <td>1.005859</td>
      <td>0.001168</td>
      <td>0.004547</td>
      <td>0.006695</td>
      <td>2.042969</td>
      <td>1.003906</td>
      <td>0.007458</td>
      <td>0.062012</td>
    </tr>
    <tr>
      <th>2</th>
      <td>00000469ba478561f23a92a868bd366de6f6527a684c9a...</td>
      <td>0.000699</td>
      <td>0.002113</td>
      <td>0.008537</td>
      <td>0.015594</td>
      <td>1.416992</td>
      <td>0.016312</td>
      <td>0.060028</td>
      <td>0.003727</td>
      <td>0.000776</td>
      <td>...</td>
      <td>0.000337</td>
      <td>0.003944</td>
      <td>0.006409</td>
      <td>0.004841</td>
      <td>0.004055</td>
      <td>0.004162</td>
      <td>1.641602</td>
      <td>1.006836</td>
      <td>0.008301</td>
      <td>0.065308</td>
    </tr>
    <tr>
      <th>3</th>
      <td>00000469ba478561f23a92a868bd366de6f6527a684c9a...</td>
      <td>0.002926</td>
      <td>0.006393</td>
      <td>0.004360</td>
      <td>0.008698</td>
      <td>0.044617</td>
      <td>0.015823</td>
      <td>0.003401</td>
      <td>0.003363</td>
      <td>0.006313</td>
      <td>...</td>
      <td>0.003653</td>
      <td>0.001332</td>
      <td>0.005840</td>
      <td>0.003860</td>
      <td>0.006454</td>
      <td>0.008369</td>
      <td>1.001953</td>
      <td>1.004883</td>
      <td>0.003571</td>
      <td>0.053711</td>
    </tr>
    <tr>
      <th>4</th>
      <td>00000469ba478561f23a92a868bd366de6f6527a684c9a...</td>
      <td>0.008522</td>
      <td>0.004330</td>
      <td>0.003006</td>
      <td>0.009422</td>
      <td>0.039581</td>
      <td>0.001843</td>
      <td>0.141968</td>
      <td>0.006485</td>
      <td>0.005901</td>
      <td>...</td>
      <td>0.003521</td>
      <td>0.009163</td>
      <td>0.002623</td>
      <td>0.005493</td>
      <td>0.000208</td>
      <td>0.009766</td>
      <td>1.082031</td>
      <td>1.005859</td>
      <td>0.008766</td>
      <td>0.003233</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 65 columns</p>
</div></div></div>
</div>
<p>Luego se prosigió al entrenamiento del modelo, esta vez con los datos de entrenamiento completos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;train_labels.csv&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;data.pkl&#39;</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;test_imputed.pkl&#39;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;target_x&#39;</span><span class="p">,</span> <span class="s1">&#39;target_y&#39;</span><span class="p">])</span>

<span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
<span class="n">adasyn</span> <span class="o">=</span> <span class="n">ADASYN</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
<span class="n">X_train_res</span><span class="p">,</span> <span class="n">y_train_res</span> <span class="o">=</span> <span class="n">adasyn</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Balanceado&#39;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">(</span><span class="n">var_smoothing</span><span class="o">=</span><span class="mf">1e-09</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Entrenando modelo...&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_res</span><span class="p">,</span> <span class="n">y_train_res</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Modelo entrenado</span><span class="se">\n</span><span class="s1">Prediciendo...&#39;</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Reporte: &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">calculate_metrics</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Este modelo fue guardado en un archivo llamado ‘modelo_entrenado.pkl’ en el cual posteriormente se predijo el conjunto de test ya imputado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;modelofinal/modelo_entrenado.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">modelo_final</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\Valen\AppData\Local\miniconda3\envs\myenv\lib\site-packages\sklearn\base.py:376: InconsistentVersionWarning: Trying to unpickle estimator GaussianNB from version 1.5.2 when using version 1.5.1. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(
</pre></div>
</div>
</div>
</div>
<p><img alt="Imagen de WhatsApp 2024-10-22 a las 20.43.08_853c316e.jpg" src="attachment:Imagen%20de%20WhatsApp%202024-10-22%20a%20las%2020.43.08_853c316e.jpg" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">58862</span><span class="p">,</span> <span class="mi">9052</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">7414</span><span class="p">,</span> <span class="mi">16455</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conf_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Clase 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Clase 1&quot;</span><span class="p">],</span> 
            <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Clase 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Clase 1&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bfd3bd2427283b2c7f79bba2d575b4f5d650d3a188add9b632323dc167756392.png" src="_images/bfd3bd2427283b2c7f79bba2d575b4f5d650d3a188add9b632323dc167756392.png" />
</div>
</div>
<p>La matriz de confusión muestra que el modelo ha predicho correctamente 58,862 casos como negativos (verdaderos negativos) y 16,455 casos como positivos (verdaderos positivos). Sin embargo, ha cometido errores al predecir 9,052 casos como positivos cuando en realidad eran negativos (falsos positivos) y 7,414 casos como negativos cuando en realidad eran positivos (falsos negativos). Esto refleja un buen rendimiento para la clase negativa, mientras que el rendimiento para la clase positiva es razonable pero podría mejorar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_test</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>

<span class="n">y_test</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s1">&#39;predictions.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Los resultados obtenidos, se encuentran en ‘predictions.pkl’, un dataframe con el valor del target.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;modelofinal/predictions.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>En el mismo orden del dataframe original.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictions</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11363752</th>
      <td>1</td>
    </tr>
    <tr>
      <th>11363753</th>
      <td>1</td>
    </tr>
    <tr>
      <th>11363754</th>
      <td>0</td>
    </tr>
    <tr>
      <th>11363755</th>
      <td>0</td>
    </tr>
    <tr>
      <th>11363756</th>
      <td>0</td>
    </tr>
    <tr>
      <th>11363757</th>
      <td>0</td>
    </tr>
    <tr>
      <th>11363758</th>
      <td>0</td>
    </tr>
    <tr>
      <th>11363759</th>
      <td>0</td>
    </tr>
    <tr>
      <th>11363760</th>
      <td>0</td>
    </tr>
    <tr>
      <th>11363761</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictions</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
0    6845872
1    4517890
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Welcome to your Jupyter Book</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Default Probability Prediction</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias">Librerías</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sobre-los-datos">Sobre los datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sobre-las-variables">Sobre las variables</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#presencia-de-datos-faltantes">Presencia de datos faltantes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diccionario-de-variables">Diccionario de variables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-univariado">Análisis univariado</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-bivariado">Análisis bivariado</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#target-y-d-63"><code class="docutils literal notranslate"><span class="pre">target</span></code> y <code class="docutils literal notranslate"><span class="pre">D_63</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#target-y-b-38"><code class="docutils literal notranslate"><span class="pre">target</span></code> y <code class="docutils literal notranslate"><span class="pre">B_38</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#target-y-d-92"><code class="docutils literal notranslate"><span class="pre">target</span></code> y <code class="docutils literal notranslate"><span class="pre">D_92</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seleccion-de-variables-numericas-para-correlacion">Selección de variables numéricas para correlación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-43-y-r-3"><code class="docutils literal notranslate"><span class="pre">D_43</span></code> y <code class="docutils literal notranslate"><span class="pre">R_3</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-55-y-r-19"><code class="docutils literal notranslate"><span class="pre">D_55</span></code> y <code class="docutils literal notranslate"><span class="pre">R_19</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#p-2-p-3-y-p-4"><code class="docutils literal notranslate"><span class="pre">P_2</span></code>, <code class="docutils literal notranslate"><span class="pre">P_3</span></code> y <code class="docutils literal notranslate"><span class="pre">P_4</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#p-2-y-p-3"><code class="docutils literal notranslate"><span class="pre">P_2</span></code> y <code class="docutils literal notranslate"><span class="pre">P_3</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-de-riesgo">Variables de riesgo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#r-8-y-r-5"><code class="docutils literal notranslate"><span class="pre">R_8</span></code> y <code class="docutils literal notranslate"><span class="pre">R_5</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#r-4-y-r-2"><code class="docutils literal notranslate"><span class="pre">R_4</span></code> y <code class="docutils literal notranslate"><span class="pre">R_2</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#r-5-y-r-4"><code class="docutils literal notranslate"><span class="pre">R_5</span></code> y <code class="docutils literal notranslate"><span class="pre">R_4</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#tratamientos-de-datos-faltantes-y-multicolinealidad">Tratamientos de datos faltantes y multicolinealidad</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos">Modelos</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#que-es-adasyn">¿Qué es ADASYN?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-sin-adasyn">Modelos sin ADASYN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#knn">KNN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificacion-bayesiana">Clasificación bayesiana</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-logistica-con-penalizacion-l1">Regresión logística con penalización L1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-logistica-con-penalizacion-l2">Regresión logística con penalización L2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion">Comparación</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-con-adasyn">Modelos con ADASYN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">KNN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Clasificación bayesiana</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Regresión logística con penalización L1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Regresión logística con penalización L2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Comparación</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-adasyn-o-sin-adasyn">Comparación: ADASYN o sin ADASYN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-adasyn-con-hiperparametrizacion-bayessearchcv-y-gridsearchcv-con-pipelines">Modelos ADASYN con hiperparametrización: BayesSearchCV y gridsearchCV con pipelines</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hiperparametrizacion-con-gridsearchcv">Hiperparametrización con GridsearchCV</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">KNN</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Clasificación bayesiana</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-logisitca-con-penalizacion-l1">Regresión logísitca con penalización L1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Regresión logística con penalización L2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Comparación</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hiperparametrizacion-con-bayessearchcv">Hiperparametrización con BayesSearchCV</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">KNN</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Clasificación bayesiana</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Regresión logísitca con penalización L1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-logisitca-con-penalizacion-l2">Regresión logísitca con penalización L2</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-entre-gridsearchcv-y-bayessearchcv">Comparación entre GridsearchCV y BayesSearchCV</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-final">Modelo final</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>